!(function (e) {
  var t = {};
  function i(n) {
    if (t[n]) return t[n].exports;
    var l = (t[n] = { i: n, l: !1, exports: {} });
    return e[n].call(l.exports, l, l.exports, i), (l.l = !0), l.exports;
  }
  (i.m = e),
    (i.c = t),
    (i.d = function (e, t, n) {
      i.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: n });
    }),
    (i.r = function (e) {
      "undefined" != typeof Symbol &&
        Symbol.toStringTag &&
        Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }),
        Object.defineProperty(e, "__esModule", { value: !0 });
    }),
    (i.t = function (e, t) {
      if ((1 & t && (e = i(e)), 8 & t)) return e;
      if (4 & t && "object" == typeof e && e && e.__esModule) return e;
      var n = Object.create(null);
      if (
        (i.r(n),
        Object.defineProperty(n, "default", { enumerable: !0, value: e }),
        2 & t && "string" != typeof e)
      )
        for (var l in e)
          i.d(
            n,
            l,
            function (t) {
              return e[t];
            }.bind(null, l)
          );
      return n;
    }),
    (i.n = function (e) {
      var t =
        e && e.__esModule
          ? function () {
              return e.default;
            }
          : function () {
              return e;
            };
      return i.d(t, "a", t), t;
    }),
    (i.o = function (e, t) {
      return Object.prototype.hasOwnProperty.call(e, t);
    }),
    (i.p = "./"),
    i((i.s = "83c3"));
})({
  "1kvd": function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          function n(t, i) {
            t &&
              (new e.RegExp("(\\s|^)" + i + "(\\s|$)").test(t.className) ||
                (t.className += (0 < t.className.length ? " " : "") + i));
          }
          function l(t, i) {
            var n;
            t &&
              ((n = new e.RegExp("(\\s|^)" + i + "(\\s|$)")),
              (t.className = t.className.replace(n, " ").trim()),
              t.className.trim() || t.removeAttribute("class"));
          }
          var o = {
            name: "dialog",
            add: function (e) {
              var t = e.context;
              t.dialog = { kind: "", updateModal: !1, _closeSignal: !1 };
              var i = e.util.createElement("DIV");
              i.className = "ke-dialog kothing-editor-common";
              var n = e.util.createElement("DIV");
              (n.className = "ke-dialog-back"), (n.style.display = "none");
              var l = e.util.createElement("DIV");
              (l.className = "ke-dialog-inner"),
                (l.style.display = "none"),
                i.appendChild(n),
                i.appendChild(l),
                (t.dialog.modalArea = i),
                (t.dialog.back = n),
                (t.dialog.modal = l),
                t.dialog.modal.addEventListener(
                  "mousedown",
                  this._onMouseDown_dialog.bind(e)
                ),
                t.dialog.modal.addEventListener(
                  "click",
                  this._onClick_dialog.bind(e)
                ),
                t.element.relative.appendChild(i),
                (l = n = i = null);
            },
            _onMouseDown_dialog: function (e) {
              /ke-dialog-inner/.test(e.target.className)
                ? (this.context.dialog._closeSignal = !0)
                : (this.context.dialog._closeSignal = !1);
            },
            _onClick_dialog: function (e) {
              e.stopPropagation(),
                (/close/.test(e.target.getAttribute("data-command")) ||
                  this.context.dialog._closeSignal) &&
                  this.plugins.dialog.close.call(this);
            },
            open: function (e, t) {
              if (this.modalForm) return !1;
              this.plugins.dialog._bindClose &&
                (this._d.removeEventListener(
                  "keydown",
                  this.plugins.dialog._bindClose
                ),
                (this.plugins.dialog._bindClose = null)),
                (this.plugins.dialog._bindClose = function (e) {
                  /27/.test(e.keyCode) && this.plugins.dialog.close.call(this);
                }.bind(this)),
                this._d.addEventListener(
                  "keydown",
                  this.plugins.dialog._bindClose
                ),
                (this.context.dialog.updateModal = t),
                "full" === this.context.option.popupDisplay
                  ? (this.context.dialog.modalArea.style.position = "fixed")
                  : (this.context.dialog.modalArea.style.position = "absolute"),
                n(this.context.dialog.modalArea, "dialog--open"),
                (this.context.dialog.kind = e),
                (this.modalForm = this.context[e].modal);
              var i = this.context[e].focusElement;
              "function" == typeof this.plugins[e].on &&
                this.plugins[e].on.call(this, t),
                (this.context.dialog.modalArea.style.display = "block"),
                (this.context.dialog.back.style.display = "block"),
                (this.context.dialog.modal.style.display = "block"),
                (this.modalForm.style.display = "block"),
                i && i.focus();
            },
            _bindClose: null,
            close: function () {
              var e = this;
              this.plugins.dialog._bindClose &&
                (this._d.removeEventListener(
                  "keydown",
                  this.plugins.dialog._bindClose
                ),
                (this.plugins.dialog._bindClose = null));
              var t = this.context.dialog.kind;
              l(this.context.dialog.modalArea, "dialog--open"),
                n(this.context.dialog.modalArea, "dialog--close"),
                new Promise(function (t) {
                  setTimeout(function () {
                    l(e.context.dialog.modalArea, "dialog--close"), t();
                  }, 200);
                }).then(function () {
                  (e.modalForm.style.display = "none"),
                    (e.context.dialog.back.style.display = "none"),
                    (e.context.dialog.modalArea.style.display = "none"),
                    (e.context.dialog.updateModal = !1),
                    "function" == typeof e.plugins[t].init &&
                      e.plugins[t].init.call(e),
                    (e.context.dialog.kind = ""),
                    (e.modalForm = null),
                    e.focus();
                });
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Modules ||
                Object.defineProperty(e, "KothingEditor_Modules", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Modules, "dialog", {
                enumerable: !0,
                writable: !1,
                configurable: !1,
                value: o,
              })),
            o
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Modules a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  "83c3": function (e, t, i) {
    "use strict";
    function n(e) {
      return (n =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    i.r(t), i("tIrU"), i("h474");
    var l = {
        name: "colorPicker",
        add: function (e) {
          var t = e.context;
          t.colorPicker = {
            colorListHTML: "",
            _colorInput: "",
            _defaultColor: "#000",
            _styleProperty: "color",
            _currentColor: "",
            _colorList: [],
          };
          var i = this.createColorList(e, this._makeColorList);
          t.colorPicker.colorListHTML = i;
        },
        createColorList: function (e, t) {
          for (
            var i,
              l = e.context.option,
              o = e.lang,
              s =
                l.colorList && 0 !== l.colorList.length
                  ? l.colorList
                  : [
                      "#ff0000",
                      "#ff5e00",
                      "#ffe400",
                      "#abf200",
                      "#00d8ff",
                      "#0055ff",
                      "#6600ff",
                      "#ff00dd",
                      "#000000",
                      "#ffd8d8",
                      "#fae0d4",
                      "#faf4c0",
                      "#e4f7ba",
                      "#d4f4fa",
                      "#d9e5ff",
                      "#e8d9ff",
                      "#ffd9fa",
                      "#f1f1f1",
                      "#ffa7a7",
                      "#ffc19e",
                      "#faed7d",
                      "#cef279",
                      "#b2ebf4",
                      "#b2ccff",
                      "#d1b2ff",
                      "#ffb2f5",
                      "#bdbdbd",
                      "#f15f5f",
                      "#f29661",
                      "#e5d85c",
                      "#bce55c",
                      "#5cd1e5",
                      "#6699ff",
                      "#a366ff",
                      "#f261df",
                      "#8c8c8c",
                      "#980000",
                      "#993800",
                      "#998a00",
                      "#6b9900",
                      "#008299",
                      "#003399",
                      "#3d0099",
                      "#990085",
                      "#353535",
                      "#670000",
                      "#662500",
                      "#665c00",
                      "#476600",
                      "#005766",
                      "#002266",
                      "#290066",
                      "#660058",
                      "#222222",
                    ],
              a = [],
              r = '<div class="ke-list-inner">',
              c = 0,
              d = s.length;
            c < d;
            c++
          )
            (i = s[c]) &&
              (("string" == typeof i && (a.push(i), c < d - 1)) ||
                (0 < a.length &&
                  ((r += '<div class="ke-selector-color">' + t(a) + "</div>"),
                  (a = [])),
                "object" === n(i) &&
                  (r += '<div class="ke-selector-color">' + t(i) + "</div>")));
          return (
            r +
            '<form class="ke-submenu-form-group"><input type="text" maxlength="9" class="_ke_color_picker_input ke-color-input"/><button type="submit" class="ke-btn-primary _ke_color_picker_submit" title="' +
            o.dialogBox.submitButton +
            '">' +
            e.icons.checked +
            '</button><button type="button" class="ke-btn _ke_color_picker_remove" title="' +
            o.toolbar.removeFormat +
            '">' +
            e.icons.erase +
            "</button></form></div>"
          );
        },
        _makeColorList: function (e) {
          var t = "";
          t += '<ul class="ke-color-pallet">';
          for (var i, n = 0, l = e.length; n < l; n++)
            "string" == typeof (i = e[n]) &&
              (t +=
                '<li><button type="button" data-value="' +
                i +
                '" title="' +
                i +
                '" style="background-color:' +
                i +
                ';"></button></li>');
          return t + "</ul>";
        },
        init: function (e, t) {
          var i = this.plugins.colorPicker,
            n =
              t ||
              i.getColorInNode.call(this, e) ||
              this.context.colorPicker._defaultColor,
            l =
              ((n = (!i.isHexColor(n) && i.rgb2hex(n)) || n),
              this.context.colorPicker._colorList);
          if (l)
            for (var o = 0, s = l.length; o < s; o++)
              n.toLowerCase() === l[o].getAttribute("data-value").toLowerCase()
                ? this.util.addClass(l[o], "active")
                : this.util.removeClass(l[o], "active");
          i.setInputText.call(this, i.colorName2hex.call(this, n));
        },
        setCurrentColor: function (e) {
          (this.context.colorPicker._currentColor = e),
            (this.context.colorPicker._colorInput.style.borderColor = e);
        },
        setInputText: function (e) {
          (e = /^#/.test(e) ? e : "#" + e),
            (this.context.colorPicker._colorInput.value = e),
            this.plugins.colorPicker.setCurrentColor.call(this, e);
        },
        getColorInNode: function (e) {
          for (
            var t = "", i = this.context.colorPicker._styleProperty;
            e && !this.util.isWysiwygDiv(e) && 0 === t.length;

          )
            1 === e.nodeType && e.style[i] && (t = e.style[i]),
              (e = e.parentNode);
          return t;
        },
        isHexColor: function (e) {
          return /^#[0-9a-f]{3}(?:[0-9a-f]{3})?$/i.test(e);
        },
        rgb2hex: function (e) {
          var t = e.match(
            /^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i
          );
          return t && 4 === t.length
            ? "#" +
                ("0" + parseInt(t[1], 10).toString(16)).slice(-2) +
                ("0" + parseInt(t[2], 10).toString(16)).slice(-2) +
                ("0" + parseInt(t[3], 10).toString(16)).slice(-2)
            : "";
        },
        colorName2hex: function (e) {
          if (/^#/.test(e)) return e;
          var t = this.util.createElement("div");
          (t.style.display = "none"), (t.style.color = e);
          var i = this._w
            .getComputedStyle(this._d.body.appendChild(t))
            .color.match(/\d+/g)
            .map(function (e) {
              return parseInt(e, 10);
            });
          return (
            this.util.removeItem(t),
            3 <= i.length &&
              "#" +
                ((1 << 24) + (i[0] << 16) + (i[1] << 8) + i[2])
                  .toString(16)
                  .substr(1)
          );
        },
      },
      o = {
        name: "fontColor",
        display: "submenu",
        add: function (e, t) {
          e.addModule([l]);
          var i = e.context;
          i.fontColor = { previewEl: null, colorInput: null, colorList: null };
          var n = this.setSubmenu.call(e);
          (i.fontColor.colorInput = n.querySelector("._ke_color_picker_input")),
            i.fontColor.colorInput.addEventListener(
              "keyup",
              this.onChangeInput.bind(e)
            ),
            n
              .querySelector("._ke_color_picker_submit")
              .addEventListener("click", this.submit.bind(e)),
            n
              .querySelector("._ke_color_picker_remove")
              .addEventListener("click", this.remove.bind(e)),
            n.addEventListener("click", this.pickup.bind(e)),
            (i.fontColor.colorList = n.querySelectorAll("li button")),
            e.initMenuTarget(this.name, t, n),
            (n = null);
        },
        setSubmenu: function () {
          var e = this.context.colorPicker.colorListHTML,
            t = this.util.createElement("DIV");
          return (
            (t.className = "ke-submenu ke-list-layer"), (t.innerHTML = e), t
          );
        },
        on: function () {
          var e = this.context.colorPicker,
            t = this.context.fontColor;
          (e._colorInput = t.colorInput),
            (e._defaultColor = "#333333"),
            (e._styleProperty = "color"),
            (e._colorList = t.colorList),
            this.plugins.colorPicker.init.call(
              this,
              this.getSelectionNode(),
              null
            );
        },
        onChangeInput: function (e) {
          this.plugins.colorPicker.setCurrentColor.call(this, e.target.value);
        },
        submit: function () {
          this.plugins.fontColor.applyColor.call(
            this,
            this.context.colorPicker._currentColor
          );
        },
        pickup: function (e) {
          e.preventDefault(),
            e.stopPropagation(),
            this.plugins.fontColor.applyColor.call(
              this,
              e.target.getAttribute("data-value")
            );
        },
        remove: function () {
          this.nodeChange(null, ["color"], ["span"], !0), this.submenuOff();
        },
        applyColor: function (e) {
          var t;
          e &&
            (((t = this.util.createElement("SPAN")).style.color = e),
            this.nodeChange(t, ["color"], null, null),
            this.submenuOff());
        },
      },
      s = {
        name: "hiliteColor",
        display: "submenu",
        add: function (e, t) {
          e.addModule([l]);
          var i = e.context;
          i.hiliteColor = {
            previewEl: null,
            colorInput: null,
            colorList: null,
          };
          var n = this.setSubmenu.call(e);
          (i.hiliteColor.colorInput = n.querySelector(
            "._ke_color_picker_input"
          )),
            i.hiliteColor.colorInput.addEventListener(
              "keyup",
              this.onChangeInput.bind(e)
            ),
            n
              .querySelector("._ke_color_picker_submit")
              .addEventListener("click", this.submit.bind(e)),
            n
              .querySelector("._ke_color_picker_remove")
              .addEventListener("click", this.remove.bind(e)),
            n.addEventListener("click", this.pickup.bind(e)),
            (i.hiliteColor.colorList = n.querySelectorAll("li button")),
            e.initMenuTarget(this.name, t, n),
            (n = null);
        },
        setSubmenu: function () {
          var e = this.context.colorPicker.colorListHTML,
            t = this.util.createElement("DIV");
          return (
            (t.className = "ke-submenu ke-list-layer"), (t.innerHTML = e), t
          );
        },
        on: function () {
          var e = this.context.colorPicker,
            t = this.context.hiliteColor;
          (e._colorInput = t.colorInput),
            (e._defaultColor = "#FFFFFF"),
            (e._styleProperty = "backgroundColor"),
            (e._colorList = t.colorList),
            this.plugins.colorPicker.init.call(
              this,
              this.getSelectionNode(),
              null
            );
        },
        onChangeInput: function (e) {
          this.plugins.colorPicker.setCurrentColor.call(this, e.target.value);
        },
        submit: function () {
          this.plugins.hiliteColor.applyColor.call(
            this,
            this.context.colorPicker._currentColor
          );
        },
        pickup: function (e) {
          e.preventDefault(),
            e.stopPropagation(),
            this.plugins.hiliteColor.applyColor.call(
              this,
              e.target.getAttribute("data-value")
            );
        },
        remove: function () {
          this.nodeChange(null, ["background-color"], ["span"], !0),
            this.submenuOff();
        },
        applyColor: function (e) {
          var t;
          e &&
            (((t = this.util.createElement("SPAN")).style.backgroundColor = e),
            this.nodeChange(t, ["background-color"], null, null),
            this.submenuOff());
        },
      },
      a = {
        name: "template",
        display: "submenu",
        add: function (e, t) {
          e.context.template = {};
          var i = this.setSubmenu.call(e);
          i.querySelector("ul").addEventListener("click", this.pickup.bind(e)),
            e.initMenuTarget(this.name, t, i),
            (i = null);
        },
        setSubmenu: function () {
          var e = this.context.option.templates;
          if (!e || 0 === e.length)
            throw Error(
              '[KothingEditor.plugins.template.fail] To use the "template" plugin, please define the "templates" option.'
            );
          var t = this.util.createElement("DIV");
          t.className = "ke-list-layer";
          for (
            var i,
              n =
                '<div class="ke-submenu ke-list-inner"><ul class="ke-list-basic">',
              l = 0,
              o = e.length;
            l < o;
            l++
          )
            n +=
              '<li><button type="button" class="ke-btn-list" data-value="' +
              l +
              '" title="' +
              (i = e[l]).name +
              '">' +
              i.name +
              "</button></li>";
          return (n += "</ul></div>"), (t.innerHTML = n), t;
        },
        pickup: function (e) {
          if (!/^BUTTON$/i.test(e.target.tagName)) return !1;
          e.preventDefault(), e.stopPropagation();
          var t = this.context.option.templates[
            e.target.getAttribute("data-value")
          ];
          if (!t.html)
            throw (
              (this.submenuOff(),
              Error(
                '[KothingEditor.template.fail] cause : "templates[i].html not found"'
              ))
            );
          this.setContents(t.html), this.submenuOff();
        },
      },
      r = i("1kvd"),
      c = i.n(r),
      d = {
        name: "link",
        display: "dialog",
        add: function (e) {
          e.addModule([c.a]);
          var t = e.context;
          t.link = {
            focusElement: null,
            linkNewWindowCheck: null,
            linkAnchorText: null,
            _linkAnchor: null,
            _linkValue: "",
          };
          var i = this.setDialog.call(e);
          (t.link.modal = i),
            (t.link.focusElement = i.querySelector("._ke_link_url")),
            (t.link.linkAnchorText = i.querySelector("._ke_link_text")),
            (t.link.linkNewWindowCheck = i.querySelector("._ke_link_check")),
            (t.link.preview = i.querySelector(".ke-link-preview"));
          var n = this.setController_LinkButton.call(e);
          (t.link.linkController = n),
            (t.link._linkAnchor = null),
            n.addEventListener("mousedown", e.eventStop),
            i
              .querySelector(".ke-btn-primary")
              .addEventListener("click", this.submit.bind(e)),
            n.addEventListener("click", this.onClick_linkController.bind(e)),
            t.link.focusElement.addEventListener(
              "input",
              this._onLinkPreview.bind(
                t.link.preview,
                t.link,
                t.options.linkProtocol
              )
            ),
            t.dialog.modal.appendChild(i),
            t.element.relative.appendChild(n),
            (n = i = null);
        },
        setDialog: function () {
          var e = this.lang,
            t = this.util.createElement("DIV");
          return (
            (t.className = "ke-dialog-content"),
            (t.style.display = "none"),
            (t.innerHTML =
              '<form class="editor_link"><div class="ke-dialog-header"><button type="button" data-command="close" class="ke-btn ke-dialog-close" aria-label="Close" title="' +
              e.dialogBox.close +
              '">' +
              this.icons.cancel +
              '</button><span class="ke-modal-title">' +
              e.dialogBox.linkBox.title +
              '</span></div><div class="ke-dialog-body"><div class="ke-dialog-form"><label>' +
              e.dialogBox.linkBox.url +
              '</label><input class="ke-input-form _ke_link_url" type="text" /><pre class="ke-link-preview"></pre></div><div class="ke-dialog-form"><label>' +
              e.dialogBox.linkBox.text +
              '</label><input class="ke-input-form _ke_link_text" type="text" /></div><div class="ke-dialog-form"><label><input type="checkbox" class="ke-dialog-btn-check _ke_link_check" />&nbsp;' +
              e.dialogBox.linkBox.newWindowCheck +
              '</label></div></div><div class="ke-dialog-footer"><button type="submit" class="ke-btn-primary" title="' +
              e.dialogBox.submitButton +
              '"><span>' +
              e.dialogBox.submitButton +
              "</span></button></div></form>"),
            t
          );
        },
        setController_LinkButton: function () {
          var e = this.lang,
            t = this.icons,
            i = this.util.createElement("DIV");
          return (
            (i.className = "ke-controller ke-controller-link"),
            (i.innerHTML =
              '<div class="ke-arrow ke-arrow-up"></div><div class="link-content"><span><a target="_blank" href=""></a>&nbsp;</span><div class="ke-btn-group"><button type="button" data-command="update" tabindex="-1" class="ke-btn ke-tooltip">' +
              t.edit +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.edit +
              '</span></span></button><button type="button" data-command="unlink" tabindex="-1" class="ke-btn ke-tooltip">' +
              t.unlink +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.unlink +
              '</span></span></button><button type="button" data-command="delete" tabindex="-1" class="ke-btn ke-tooltip">' +
              t.delete +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.remove +
              "</span></span></button></div></div>"),
            i
          );
        },
        open: function () {
          this.plugins.dialog.open.call(
            this,
            "link",
            "link" === this.currentControllerName
          );
        },
        _onLinkPreview: function (e, t, i) {
          var n = i.target.value.trim();
          e._linkValue = this.textContent = n
            ? t && -1 === n.indexOf("://") && 0 !== n.indexOf("#")
              ? t + n
              : -1 === n.indexOf("://")
              ? "/" + n
              : n
            : "";
        },
        submit: function (e) {
          this.showLoading(), e.preventDefault(), e.stopPropagation();
          var t = function () {
            var e = this.context.link;
            if (0 === e._linkValue.length) return !1;
            var t = e._linkValue,
              i = e.linkAnchorText,
              n = 0 === i.value.length ? t : i.value;
            if (this.context.dialog.updateModal) {
              (e._linkAnchor.href = t),
                (e._linkAnchor.textContent = n),
                (e._linkAnchor.target = e.linkNewWindowCheck.checked
                  ? "_blank"
                  : "");
              var l = e._linkAnchor.childNodes[0];
              this.setRange(l, 0, l, l.textContent.length);
            } else {
              var o = this.util.createElement("A");
              (o.href = t),
                (o.textContent = n),
                (o.target = e.linkNewWindowCheck.checked ? "_blank" : "");
              var s = this.getSelectedElements();
              if (1 < s.length) {
                var a = this.util.createElement(s[0].nodeName);
                if ((a.appendChild(o), !this.insertNode(a, null, !0))) return;
              } else if (!this.insertNode(o, null, !0)) return;
              this.setRange(
                o.childNodes[0],
                0,
                o.childNodes[0],
                o.textContent.length
              );
            }
            (e._linkValue = ""),
              (e.preview.textContent = ""),
              (e.focusElement.value = ""),
              (e.linkAnchorText.value = "");
          }.bind(this);
          try {
            t();
          } finally {
            this.plugins.dialog.close.call(this),
              this.closeLoading(),
              this.history.push(!1);
          }
          return !1;
        },
        active: function (e) {
          if (e) {
            if (
              this.util.isAnchor(e) &&
              null === e.getAttribute("data-image-link")
            )
              return (
                this.controllerArray.indexOf(this.context.link.linkController) <
                  0 && this.plugins.link.call_controller.call(this, e),
                !0
              );
          } else
            -1 <
              this.controllerArray.indexOf(this.context.link.linkController) &&
              this.controllersOff();
          return !1;
        },
        on: function (e) {
          var t = this.context.link;
          e
            ? t._linkAnchor &&
              ((this.context.dialog.updateModal = !0),
              (t._linkValue = t._linkAnchor.href),
              (t.preview.textContent = t._linkAnchor.href),
              (t.focusElement.value = t._linkAnchor.href),
              (t.linkAnchorText.value = t._linkAnchor.textContent),
              (t.linkNewWindowCheck.checked = !!/_blank/i.test(
                t._linkAnchor.target
              )))
            : (this.plugins.link.init.call(this),
              (t.linkAnchorText.value = this.getSelection().toString()));
        },
        call_controller: function (e) {
          (this.editLink = e), (this.context.link._linkAnchor = e);
          var t = this.context.link.linkController,
            i = t.querySelector("a");
          (i.href = e.href),
            (i.title = e.textContent),
            (i.textContent = e.textContent);
          var n = this.util.getOffset(e, this.context.element.wysiwygFrame);
          (t.style.top = n.top + e.offsetHeight + 10 + "px"),
            (t.style.left =
              n.left - this.context.element.wysiwygFrame.scrollLeft + "px"),
            (t.style.display = "block");
          var l =
            this.context.element.wysiwygFrame.offsetWidth -
            (t.offsetLeft + t.offsetWidth);
          l < 0
            ? ((t.style.left = t.offsetLeft + l + "px"),
              (t.firstElementChild.style.left = 20 - l + "px"))
            : (t.firstElementChild.style.left = "20px"),
            this.controllersOn(t, e, "link");
        },
        onClick_linkController: function (e) {
          e.stopPropagation();
          var t,
            i,
            n,
            l =
              e.target.getAttribute("data-command") ||
              e.target.parentNode.getAttribute("data-command");
          l &&
            (e.preventDefault(),
            /update/.test(l)
              ? (((t = this.context.link)._linkValue = t._linkAnchor.href),
                (t.preview.textContent = t._linkAnchor.href),
                (t.focusElement.value = t._linkAnchor.href),
                (t.linkAnchorText.value = t._linkAnchor.textContent),
                (t.linkNewWindowCheck.checked = !!/_blank/i.test(
                  t._linkAnchor.target
                )),
                this.plugins.dialog.open.call(this, "link", !0))
              : /unlink/.test(l)
              ? ((i = this.util.getChildElement(
                  this.context.link._linkAnchor,
                  function (e) {
                    return 0 === e.childNodes.length || 3 === e.nodeType;
                  },
                  !1
                )),
                (n = this.util.getChildElement(
                  this.context.link._linkAnchor,
                  function (e) {
                    return 0 === e.childNodes.length || 3 === e.nodeType;
                  },
                  !0
                )),
                this.setRange(i, 0, n, n.textContent.length),
                this.nodeChange(null, null, ["A"], !1))
              : (this.util.removeItem(this.context.link._linkAnchor),
                (this.context.link._linkAnchor = null),
                this.focus(),
                this.history.push(!1)),
            this.controllersOff());
        },
        init: function () {
          var e = this.context.link;
          (e.linkController.style.display = "none"),
            (e._linkAnchor = null),
            (e._linkValue = ""),
            (e.preview.textContent = ""),
            (e.focusElement.value = ""),
            (e.linkAnchorText.value = ""),
            (e.linkNewWindowCheck.checked = !1);
        },
      },
      u = i("ZED3"),
      h = i.n(u),
      g = i("ee5k"),
      p = i.n(g),
      m = i("gjS+"),
      f = i.n(m),
      v = {
        name: "image",
        display: "dialog",
        add: function (e) {
          e.addModule([c.a, h.a, p.a, f.a]);
          var t = e.context,
            i = (t.image = {
              _infoList: [],
              _infoIndex: 0,
              _uploadFileLength: 0,
              sizeUnit: t.option._imageSizeUnit,
              _altText: "",
              _linkElement: null,
              _align: "none",
              _floatClassRegExp: "__ke__float\\-[a-z]+",
              _v_link: { _linkValue: "" },
              _v_src: { _linkValue: "" },
              svgDefaultSize: "30%",
              _element: null,
              _cover: null,
              _container: null,
              inputX: null,
              inputY: null,
              _element_w: 1,
              _element_h: 1,
              _element_l: 0,
              _element_t: 0,
              _defaultSizeX: "auto",
              _defaultSizeY: "auto",
              _origin_w:
                "auto" === t.option.imageWidth ? "" : t.option.imageWidth,
              _origin_h:
                "auto" === t.option.imageHeight ? "" : t.option.imageHeight,
              _proportionChecked: !0,
              _resizing: t.option.imageResizing,
              _resizeDotHide: !t.option.imageHeightShow,
              _rotation: t.option.imageRotation,
              _onlyPercentage: t.option.imageSizeOnlyPercentage,
              _ratio: !1,
              _ratioX: 1,
              _ratioY: 1,
              _captionShow: !0,
              _captionChecked: !1,
              _caption: null,
              captionCheckEl: null,
            }),
            n = this.setDialog.call(e);
          (i.modal = n),
            (i.imgInputFile = n.querySelector("._ke_image_file")),
            (i.imgUrlFile = n.querySelector(".ke-input-url")),
            (i.focusElement = i.imgInputFile || i.imgUrlFile),
            (i.altText = n.querySelector("._ke_image_alt")),
            (i.imgLink = n.querySelector("._ke_image_link")),
            (i.imgLinkNewWindowCheck = n.querySelector(
              "._ke_image_link_check"
            )),
            (i.captionCheckEl = n.querySelector("._ke_image_check_caption")),
            (i.previewLink = n.querySelector(
              "._ke_tab_content_url .ke-link-preview"
            )),
            (i.previewSrc = n.querySelector(
              "._ke_tab_content_image .ke-link-preview"
            )),
            n
              .querySelector(".ke-dialog-tabs")
              .addEventListener("click", this.openTab.bind(e)),
            n
              .querySelector(".ke-btn-primary")
              .addEventListener("click", this.submit.bind(e)),
            i.imgInputFile &&
              n
                .querySelector(".ke-file-remove")
                .addEventListener(
                  "click",
                  this._removeSelectedFiles.bind(
                    i.imgInputFile,
                    i.imgUrlFile,
                    i.previewSrc
                  )
                ),
            i.imgInputFile &&
              i.imgUrlFile &&
              i.imgInputFile.addEventListener(
                "change",
                this._fileInputChange.bind(i)
              ),
            i.imgLink.addEventListener(
              "input",
              this._onLinkPreview.bind(
                i.previewLink,
                i._v_link,
                t.options.linkProtocol
              )
            ),
            i.imgUrlFile &&
              i.imgUrlFile.addEventListener(
                "input",
                this._onLinkPreview.bind(
                  i.previewSrc,
                  i._v_src,
                  t.options.linkProtocol
                )
              );
          var l = n.querySelector(".__ke__gallery");
          l && l.addEventListener("click", this._openGallery.bind(e)),
            (i.proportion = {}),
            (i.inputX = {}),
            (i.inputY = {}),
            t.option.imageResizing &&
              ((i.proportion = n.querySelector("._ke_image_check_proportion")),
              (i.inputX = n.querySelector("._ke_image_size_x")),
              (i.inputY = n.querySelector("._ke_image_size_y")),
              (i.inputX.value = t.option.imageWidth),
              (i.inputY.value = t.option.imageHeight),
              i.inputX.addEventListener(
                "keyup",
                this.setInputSize.bind(e, "x")
              ),
              i.inputY.addEventListener(
                "keyup",
                this.setInputSize.bind(e, "y")
              ),
              i.inputX.addEventListener("change", this.setRatio.bind(e)),
              i.inputY.addEventListener("change", this.setRatio.bind(e)),
              i.proportion.addEventListener("change", this.setRatio.bind(e)),
              n
                .querySelector(".ke-dialog-btn-revert")
                .addEventListener("click", this.sizeRevert.bind(e))),
            t.dialog.modal.appendChild(n),
            (n = null);
        },
        setDialog: function () {
          var e = this.context.option,
            t = this.lang,
            i = this.util.createElement("DIV");
          (i.className = "ke-dialog-content"), (i.style.display = "none");
          var n,
            l,
            o,
            s =
              '<div class="ke-dialog-header"><button type="button" data-command="close" class="ke-btn ke-dialog-close" class="close" aria-label="Close" title="' +
              t.dialogBox.close +
              '">' +
              this.icons.cancel +
              '</button><span class="ke-modal-title">' +
              t.dialogBox.imageBox.title +
              '</span></div><div class="ke-dialog-tabs"><button type="button" class="_ke_tab_link active" data-tab-link="image">' +
              t.toolbar.image +
              '</button><button type="button" class="_ke_tab_link" data-tab-link="url">' +
              t.toolbar.link +
              '</button></div><form method="post" enctype="multipart/form-data"><div class="_ke_tab_content _ke_tab_content_image"><div class="ke-dialog-body"><div style="border-bottom: 1px dashed #ccc;">';
          return (
            e.imageFileInput &&
              (s +=
                '<div class="ke-dialog-form"><label>' +
                t.dialogBox.imageBox.file +
                '</label><div class="ke-dialog-form-files"><input class="ke-input-form _ke_image_file" type="file" accept="image/"' +
                e.imageAccept +
                (e.imageMultipleFile ? ' multiple="multiple"' : "") +
                '/><button type="button" class="ke-btn ke-dialog-files-edge-button ke-file-remove" title="' +
                t.controller.remove +
                '">' +
                this.icons.cancel +
                "</button></div></div>"),
            e.imageUrlInput &&
              (s +=
                '<div class="ke-dialog-form"><label>' +
                t.dialogBox.imageBox.url +
                '</label><div class="ke-dialog-form-files"><input class="ke-input-form ke-input-url" type="text" />' +
                (e.imageGalleryUrl && this.plugins.imageGallery
                  ? '<button type="button" class="ke-btn ke-dialog-files-edge-button __ke__gallery" title="' +
                    t.toolbar.imageGallery +
                    '">' +
                    this.icons.image_gallery +
                    "</button>"
                  : "") +
                '</div><pre class="ke-link-preview"></pre></div>'),
            (s +=
              '</div><div class="ke-dialog-form"><label>' +
              t.dialogBox.imageBox.altText +
              '</label><input class="ke-input-form _ke_image_alt" type="text" /></div>'),
            e.imageResizing &&
              ((l = (n = e.imageSizeOnlyPercentage)
                ? ' style="display: none !important;"'
                : ""),
              (o = e.imageHeightShow
                ? ""
                : ' style="display: none !important;"'),
              (s += '<div class="ke-dialog-form">'),
              n || !e.imageHeightShow
                ? (s +=
                    '<div class="ke-dialog-size-text"><label class="size-w">' +
                    t.dialogBox.size +
                    "</label></div>")
                : (s +=
                    '<div class="ke-dialog-size-text"><label class="size-w">' +
                    t.dialogBox.width +
                    '</label><label class="ke-dialog-size-x">&nbsp;</label><label class="size-h">' +
                    t.dialogBox.height +
                    "</label></div>"),
              (s +=
                '<input class="ke-input-control _ke_image_size_x" placeholder="auto"' +
                (n ? ' type="number" min="1"' : 'type="text"') +
                (n ? ' max="100"' : "") +
                ' /><label class="ke-dialog-size-x"' +
                o +
                ">" +
                (n ? "%" : "x") +
                '</label><input type="text" class="ke-input-control _ke_image_size_y" placeholder="auto"' +
                l +
                (n ? ' max="100"' : "") +
                o +
                "/><label" +
                l +
                o +
                '><input type="checkbox" class="ke-dialog-btn-check _ke_image_check_proportion" checked/>&nbsp;' +
                t.dialogBox.proportion +
                '</label><button type="button" title="' +
                t.dialogBox.revertButton +
                '" class="ke-btn ke-dialog-btn-revert" style="float: right;">' +
                this.icons.revert +
                "</button></div>")),
            (s +=
              '<div class="ke-dialog-form ke-dialog-form"><label><input type="checkbox" class="ke-dialog-btn-check _ke_image_check_caption" />&nbsp;' +
              t.dialogBox.caption +
              '</label></div></div></div><div class="_ke_tab_content _ke_tab_content_url" style="display: none"><div class="ke-dialog-body"><div class="ke-dialog-form"><label>' +
              t.dialogBox.linkBox.url +
              '</label><input class="ke-input-form _ke_image_link" type="text" /><pre class="ke-link-preview"></pre></div><label><input type="checkbox" class="_ke_image_link_check"/>&nbsp;' +
              t.dialogBox.linkBox.newWindowCheck +
              '</label></div></div><div class="ke-dialog-footer"><div><label><input type="radio" name="kothing-editor_image_radio" class="ke-dialog-btn-radio" value="none" checked>' +
              t.dialogBox.basic +
              '</label><label><input type="radio" name="kothing-editor_image_radio" class="ke-dialog-btn-radio" value="left">' +
              t.dialogBox.left +
              '</label><label><input type="radio" name="kothing-editor_image_radio" class="ke-dialog-btn-radio" value="center">' +
              t.dialogBox.center +
              '</label><label><input type="radio" name="kothing-editor_image_radio" class="ke-dialog-btn-radio" value="right">' +
              t.dialogBox.right +
              '</label></div><button type="submit" class="ke-btn-primary" title="' +
              t.dialogBox.submitButton +
              '"><span>' +
              t.dialogBox.submitButton +
              "</span></button></div></form>"),
            (i.innerHTML = s),
            i
          );
        },
        _fileInputChange: function () {
          this.imgInputFile.value
            ? (this.imgUrlFile.setAttribute("disabled", !0),
              (this.previewSrc.style.textDecoration = "line-through"))
            : (this.imgUrlFile.removeAttribute("disabled"),
              (this.previewSrc.style.textDecoration = ""));
        },
        _removeSelectedFiles: function (e, t) {
          (this.value = ""),
            e && (e.removeAttribute("disabled"), (t.style.textDecoration = ""));
        },
        _openGallery: function () {
          this.callPlugin(
            "imageGallery",
            this.plugins.imageGallery.open.bind(
              this,
              this.plugins.image._setUrlInput.bind(this.context.image)
            ),
            null
          );
        },
        _setUrlInput: function (e) {
          (this.altText.value = e.alt),
            (this._v_src._linkValue = e.src),
            (this.previewSrc.textContent = e.src),
            (this.imgUrlFile.value = e.src),
            this.imgUrlFile.focus();
        },
        _onLinkPreview: function (e, t, i) {
          var n = i.target.value.trim();
          e._linkValue = this.textContent = n
            ? t && -1 === n.indexOf("://") && 0 !== n.indexOf("#")
              ? t + n
              : -1 === n.indexOf("://")
              ? "/" + n
              : n
            : "";
        },
        fileTags: ["img"],
        select: function (e) {
          this.plugins.image.onModifyMode.call(
            this,
            e,
            this.plugins.resizing.call_controller_resize.call(this, e, "image")
          );
        },
        destroy: function (e) {
          var t = e || this.context.image._element,
            i = this.util.getParentElement(t, this.util.isMediaComponent) || t,
            n = +t.getAttribute("data-index"),
            l = i.previousElementSibling || i.nextElementSibling,
            o = i.parentNode;
          this.util.removeItem(i),
            this.plugins.image.init.call(this),
            this.controllersOff(),
            o !== this.context.element.wysiwyg &&
              this.util.removeItemAllParents(
                o,
                function (e) {
                  return 0 === e.childNodes.length;
                },
                null
              ),
            this.focusEdge(l),
            this.plugins.fileManager.deleteInfo.call(
              this,
              "image",
              n,
              this.functions.onImageUpload
            ),
            this.history.push(!1);
        },
        on: function (e) {
          var t = this.context.image;
          e
            ? t.imgInputFile &&
              this.context.options.imageMultipleFile &&
              t.imgInputFile.removeAttribute("multiple")
            : ((t.inputX.value = t._origin_w =
                this.context.option.imageWidth === t._defaultSizeX
                  ? ""
                  : this.context.option.imageWidth),
              (t.inputY.value = t._origin_h =
                this.context.option.imageHeight === t._defaultSizeY
                  ? ""
                  : this.context.option.imageHeight),
              t.imgInputFile &&
                this.context.options.imageMultipleFile &&
                t.imgInputFile.setAttribute("multiple", "multiple"));
        },
        open: function () {
          this.plugins.dialog.open.call(
            this,
            "image",
            "image" === this.currentControllerName
          );
        },
        openTab: function (e) {
          var t = this.context.image.modal,
            i = "init" === e ? t.querySelector("._ke_tab_link") : e.target;
          if (!/^BUTTON$/i.test(i.tagName)) return !1;
          for (
            var n = i.getAttribute("data-tab-link"),
              l = "_ke_tab_content",
              o = t.getElementsByClassName(l),
              s = 0;
            s < o.length;
            s++
          )
            o[s].style.display = "none";
          var a = t.getElementsByClassName("_ke_tab_link");
          for (s = 0; s < a.length; s++) this.util.removeClass(a[s], "active");
          return (
            (t.querySelector("." + l + "_" + n).style.display = "block"),
            this.util.addClass(i, "active"),
            "image" === n && this.context.image.focusElement
              ? this.context.image.focusElement.focus()
              : "url" === n &&
                this.context.image.imgLink &&
                this.context.image.imgLink.focus(),
            !1
          );
        },
        submit: function (e) {
          var t = this.context.image,
            i = this.plugins.image;
          e.preventDefault(),
            e.stopPropagation(),
            (t._altText = t.altText.value),
            (t._align = t.modal.querySelector(
              'input[name="kothing-editor_image_radio"]:checked'
            ).value),
            (t._captionChecked = t.captionCheckEl.checked),
            t._resizing && (t._proportionChecked = t.proportion.checked);
          try {
            this.context.dialog.updateModal &&
              i.update_image.call(this, !1, !0, !1),
              t.imgInputFile && 0 < t.imgInputFile.files.length
                ? (this.showLoading(),
                  i.submitAction.call(
                    this,
                    this.context.image.imgInputFile.files
                  ))
                : t.imgUrlFile &&
                  0 < t._v_src._linkValue.length &&
                  (this.showLoading(), i.onRender_imgUrl.call(this));
          } catch (e) {
            throw (
              (this.closeLoading(),
              Error(
                '[KothingEditor.image.submit.fail] cause : "' + e.message + '"'
              ))
            );
          } finally {
            this.plugins.dialog.close.call(this);
          }
          return !1;
        },
        submitAction: function (e) {
          if (0 !== e.length) {
            for (var t = 0, i = [], n = 0, l = e.length; n < l; n++)
              /image/i.test(e[n].type) && (i.push(e[n]), (t += e[n].size));
            var o = this.context.option.imageUploadSizeLimit;
            if (0 < o) {
              for (
                var s = 0,
                  a = this.context.image._infoList,
                  r = 0,
                  c = a.length;
                r < c;
                r++
              )
                s += +a[r].size;
              if (o < t + s) {
                this.closeLoading();
                var d =
                  "[KothingEditor.imageUpload.fail] Size of uploadable total images: " +
                  o / 1e3 +
                  "KB";
                return void (
                  ("function" === this.functions.onImageUploadError &&
                    !this.functions.onImageUploadError(
                      d,
                      { limitSize: o, currentSize: s, uploadSize: t },
                      this
                    )) ||
                  this.functions.noticeOpen(d)
                );
              }
            }
            var u = this.context.image;
            u._uploadFileLength = i.length;
            var h = {
              linkValue: u._v_link._linkValue,
              linkNewWindow: u.imgLinkNewWindowCheck.checked,
              inputWidth: u.inputX.value,
              inputHeight: u.inputY.value,
              align: u._align,
              isUpdate: this.context.dialog.updateModal,
              element: u._element,
            };
            if ("function" == typeof this.functions.onImageUploadBefore) {
              var g = this.functions.onImageUploadBefore(
                i,
                h,
                this,
                function (e) {
                  e && this._w.Array.isArray(e.result)
                    ? this.plugins.image.register.call(this, h, e)
                    : this.plugins.image.upload.call(this, h, e);
                }.bind(this)
              );
              if (void 0 === g) return;
              if (!g) return void this.closeLoading();
              this._w.Array.isArray(g) && 0 < g.length && (i = g);
            }
            this.plugins.image.upload.call(this, h, i);
          }
        },
        error: function (e, t) {
          if (
            (this.closeLoading(),
            "function" != typeof this.functions.onImageUploadError ||
              this.functions.onImageUploadError(e, t, this))
          )
            throw (
              (this.functions.noticeOpen(e),
              Error("[KothingEditor.plugin.image.error] response: " + e))
            );
        },
        upload: function (e, t) {
          if (t)
            if ("string" != typeof t) {
              var i = this.context.option.imageUploadUrl,
                n = this.context.dialog.updateModal ? 1 : t.length;
              if ("string" == typeof i && 0 < i.length) {
                for (var l = new FormData(), o = 0; o < n; o++)
                  l.append("file-" + o, t[o]);
                this.plugins.fileManager.upload.call(
                  this,
                  i,
                  this.context.option.imageUploadHeader,
                  l,
                  this.plugins.image.callBack_imgUpload.bind(this, e),
                  this.functions.onImageUploadError
                );
              } else
                this.plugins.image.setup_reader.call(
                  this,
                  t,
                  e.linkValue,
                  e.linkNewWindow,
                  e.inputWidth,
                  e.inputHeight,
                  e.align,
                  n - 1,
                  e.isUpdate
                );
            } else this.plugins.image.error.call(this, t, null);
          else this.closeLoading();
        },
        callBack_imgUpload: function (e, t) {
          var i;
          "function" == typeof this.functions.imageUploadHandler
            ? this.functions.imageUploadHandler(t, e, this)
            : (i = JSON.parse(t.responseText)).errorMessage
            ? this.plugins.image.error.call(this, i.errorMessage, i)
            : this.plugins.image.register.call(this, e, i);
        },
        register: function (e, t) {
          for (var i, n = t.result, l = 0, o = n.length; l < o; l++) {
            if (((i = { name: n[l].name, size: n[l].size }), e.isUpdate)) {
              this.plugins.image.update_src.call(this, n[l].url, e.element, i);
              break;
            }
            this.plugins.image.create_image.call(
              this,
              n[l].url,
              e.linkValue,
              e.linkNewWindow,
              e.inputWidth,
              e.inputHeight,
              e.align,
              i
            );
          }
          this.closeLoading();
        },
        setup_reader: function (e, t, i, n, l, o, s, a) {
          var r = this;
          try {
            for (var c, d, u = this._w.FileReader, h = 0; h <= s; h++)
              !(function (h, g, p) {
                (g = new u()),
                  (p = e[h]),
                  a &&
                    (r.context.image._element.setAttribute(
                      "data-file-name",
                      p.name
                    ),
                    r.context.image._element.setAttribute(
                      "data-file-size",
                      p.size
                    )),
                  (g.onload = function (e, s, a, r) {
                    (this.context.image.inputX.value = n),
                      (this.context.image.inputY.value = l),
                      e
                        ? this.plugins.image.update_src.call(
                            this,
                            g.result,
                            s,
                            a
                          )
                        : this.plugins.image.create_image.call(
                            this,
                            g.result,
                            t,
                            i,
                            n,
                            l,
                            o,
                            a
                          ),
                      r && this.closeLoading();
                  }.bind(r, a, r.context.image._element, p, h === s)),
                  g.readAsDataURL(p),
                  (c = g),
                  (d = p);
              })(h, c, d);
          } catch (h) {
            throw (
              (this.closeLoading(),
              Error(
                '[KothingEditor.image.setup_reader.fail] cause : "' +
                  h.message +
                  '"'
              ))
            );
          }
        },
        onRender_imgUrl: function () {
          var e = this.context.image;
          if (0 === e._v_src._linkValue.length) return !1;
          try {
            var t = { name: e._v_src._linkValue.split("/").pop(), size: 0 };
            this.context.dialog.updateModal
              ? this.plugins.image.update_src.call(
                  this,
                  e._v_src._linkValue,
                  e._element,
                  t
                )
              : this.plugins.image.create_image.call(
                  this,
                  e._v_src._linkValue,
                  e._v_link._linkValue,
                  e.imgLinkNewWindowCheck.checked,
                  e.inputX.value,
                  e.inputY.value,
                  e._align,
                  t
                );
          } catch (e) {
            throw Error(
              '[KothingEditor.image.URLRendering.fail] cause : "' +
                e.message +
                '"'
            );
          } finally {
            this.closeLoading();
          }
        },
        onRender_link: function (e, t, i) {
          if (0 < t.trim().length) {
            var n = this.util.createElement("A");
            return (
              (n.href = /^https?:\/\//.test(t) ? t : "http://" + t),
              (n.target = i ? "_blank" : ""),
              n.setAttribute("data-image-link", "image"),
              e.setAttribute("data-image-link", t),
              n.appendChild(e),
              n
            );
          }
          return e;
        },
        setInputSize: function (e, t) {
          t && 32 === t.keyCode
            ? t.preventDefault()
            : this.plugins.resizing._module_setInputSize.call(
                this,
                this.context.image,
                e
              );
        },
        setRatio: function () {
          this.plugins.resizing._module_setRatio.call(this, this.context.image);
        },
        checkFileInfo: function () {
          var e = this.plugins.image,
            t = function (t) {
              e.onModifyMode.call(this, t, null),
                e.openModify.call(this, !0),
                e.update_image.call(this, !0, !1, !0);
            }.bind(this);
          this.plugins.fileManager.checkInfo.call(
            this,
            "image",
            ["img"],
            this.functions.onImageUpload,
            t,
            !0
          );
        },
        resetFileInfo: function () {
          this.plugins.fileManager.resetInfo.call(
            this,
            "image",
            this.functions.onImageUpload
          );
        },
        create_image: function (e, t, i, n, l, o, s) {
          var a = this.plugins.image,
            r = this.context.image;
          this.context.resizing._resize_plugin = "image";
          var c = this.util.createElement("IMG");
          (c.src = e),
            (c.alt = r._altText),
            (c = a.onRender_link.call(this, c, t, i)).setAttribute(
              "data-rotate",
              "0"
            ),
            r._resizing &&
              c.setAttribute("data-proportion", r._proportionChecked);
          var d = this.plugins.component.set_cover.call(this, c),
            u = this.plugins.component.set_container.call(
              this,
              d,
              "ke-image-container"
            );
          r._captionChecked &&
            ((r._caption = this.plugins.component.create_caption.call(this)),
            r._caption.setAttribute("contenteditable", !1),
            d.appendChild(r._caption)),
            (r._element = c),
            (r._cover = d),
            (r._container = u),
            a.applySize.call(this, n, l),
            a.setAlign.call(this, o, c, d, u),
            (c.onload = a._image_create_onload.bind(this, c, r.svgDefaultSize)),
            this.insertComponent(u, !0, !0, !0) &&
              this.plugins.fileManager.setInfo.call(
                this,
                "image",
                c,
                this.functions.onImageUpload,
                s,
                !0
              ),
            (this.context.resizing._resize_plugin = "");
        },
        _image_create_onload: function (e, t) {
          0 === e.offsetWidth && this.plugins.image.applySize.call(this, t, ""),
            this.selectComponent.call(this, e, "image");
        },
        update_image: function (e, t, i) {
          var n = this.context.image,
            l = n._v_link._linkValue,
            o = n._element,
            s = n._cover,
            a = n._container,
            r = !1;
          null === s &&
            ((r = !0),
            (o = n._element.cloneNode(!0)),
            (s = this.plugins.component.set_cover.call(this, o))),
            null === a
              ? ((o = (s = s.cloneNode(!0)).querySelector("img")),
                (r = !0),
                (a = this.plugins.component.set_container.call(
                  this,
                  s,
                  "ke-image-container"
                )))
              : r &&
                ((a.innerHTML = ""),
                a.appendChild(s),
                (n._cover = s),
                (n._element = o),
                (r = !1));
          var c = this.util.isNumber(n.inputX.value)
              ? n.inputX.value + n.sizeUnit
              : n.inputX.value,
            d = this.util.isNumber(n.inputY.value)
              ? n.inputY.value + n.sizeUnit
              : n.inputY.value,
            u = /%$/.test(o.style.width)
              ? c !== a.style.width || d !== a.style.height
              : c !== o.style.width || d !== o.style.height;
          o.alt = n._altText;
          var h,
            g,
            p,
            m,
            f = !1;
          n._captionChecked
            ? n._caption ||
              ((n._caption = this.plugins.component.create_caption.call(this)),
              s.appendChild(n._caption),
              (f = !0))
            : n._caption &&
              (this.util.removeItem(n._caption), (f = !(n._caption = null))),
            0 < l.trim().length
              ? null !== n._linkElement && s.contains(n._linkElement)
                ? ((n._linkElement.href = l),
                  (n._linkElement.target = n.imgLinkNewWindowCheck.checked
                    ? "_blank"
                    : ""),
                  o.setAttribute("data-image-link", l))
                : ((h = this.plugins.image.onRender_link.call(
                    this,
                    o,
                    l,
                    this.context.image.imgLinkNewWindowCheck.checked
                  )),
                  s.insertBefore(h, n._caption))
              : null !== n._linkElement &&
                ((g = o).setAttribute("data-image-link", ""),
                (p = g.cloneNode(!0)),
                s.removeChild(n._linkElement),
                s.insertBefore(p, n._caption),
                (o = p)),
            r &&
              ((m =
                this.util.isRangeFormatElement(n._element.parentNode) ||
                this.util.isWysiwygDiv(n._element.parentNode)
                  ? n._element
                  : /^A$/i.test(n._element.parentNode.nodeName)
                  ? n._element.parentNode
                  : this.util.getFormatElement(n._element) ||
                    n._element).parentNode.replaceChild(a, m),
              (o = a.querySelector("img")),
              (n._element = o),
              (n._cover = s),
              (n._container = a)),
            (f || (!n._onlyPercentage && u)) &&
              !e &&
              (/\d+/.test(o.style.height) ||
                (this.context.resizing._rotateVertical && n._captionChecked)) &&
              (/%$/.test(n.inputX.value) || /%$/.test(n.inputY.value)
                ? this.plugins.resizing.resetTransform.call(this, o)
                : this.plugins.resizing.setTransformSize.call(
                    this,
                    o,
                    this.util.getNumber(n.inputX.value, 0),
                    this.util.getNumber(n.inputY.value, 0)
                  )),
            n._resizing &&
              (o.setAttribute("data-proportion", n._proportionChecked),
              u && this.plugins.image.applySize.call(this)),
            this.plugins.image.setAlign.call(this, null, o, null, null),
            e &&
              this.plugins.fileManager.setInfo.call(
                this,
                "image",
                o,
                this.functions.onImageUpload,
                null,
                !0
              ),
            t && this.selectComponent(o, "image"),
            i || this.history.push(!1);
        },
        update_src: function (e, t, i) {
          (t.src = e),
            this._w.setTimeout(
              this.plugins.fileManager.setInfo.bind(
                this,
                "image",
                t,
                this.functions.onImageUpload,
                i,
                !0
              )
            ),
            this.selectComponent(t, "image");
        },
        onModifyMode: function (e, t) {
          var i, n;
          e &&
            (((i = this.context.image)._linkElement = /^A$/i.test(
              e.parentNode.nodeName
            )
              ? e.parentNode
              : null),
            (i._element = e),
            (i._cover = this.util.getParentElement(e, "FIGURE")),
            (i._container = this.util.getParentElement(
              e,
              this.util.isMediaComponent
            )),
            (i._caption = this.util.getChildElement(i._cover, "FIGCAPTION")),
            (i._align = e.getAttribute("data-align") || "none"),
            t &&
              ((i._element_w = t.w),
              (i._element_h = t.h),
              (i._element_t = t.t),
              (i._element_l = t.l)),
            (n =
              i._element.getAttribute("data-size") ||
              i._element.getAttribute("data-origin"))
              ? ((n = n.split(",")), (i._origin_w = n[0]), (i._origin_h = n[1]))
              : t && ((i._origin_w = t.w), (i._origin_h = t.h)));
        },
        openModify: function (e) {
          var t = this.context.image;
          t.imgUrlFile &&
            ((t._v_src._linkValue = t._element.src),
            (t.previewSrc.textContent = t._element.src),
            (t.imgUrlFile.value = t._element.src)),
            (t._altText = t._element.alt),
            (t.altText.value = t._element.alt),
            (t._v_link._linkValue =
              null === t._linkElement ? "" : t._linkElement.href),
            (t.previewLink.textContent =
              null === t._linkElement ? "" : t._linkElement.href),
            (t.imgLink.value =
              null === t._linkElement ? "" : t._linkElement.href),
            (t.imgLinkNewWindowCheck.checked =
              t._linkElement && "_blank" === t._linkElement.target),
            (t.modal.querySelector(
              'input[name="kothing-editor_image_radio"][value="' +
                t._align +
                '"]'
            ).checked = !0),
            (t._align = t.modal.querySelector(
              'input[name="kothing-editor_image_radio"]:checked'
            ).value),
            (t._captionChecked = !!t._caption),
            (t.captionCheckEl.checked = !!t._caption),
            t._resizing &&
              this.plugins.resizing._module_setModifyInputSize.call(
                this,
                t,
                this.plugins.image
              ),
            e || this.plugins.dialog.open.call(this, "image", !0);
        },
        sizeRevert: function () {
          this.plugins.resizing._module_sizeRevert.call(
            this,
            this.context.image
          );
        },
        applySize: function (e, t) {
          var i = this.context.image;
          return (
            (e = e || i.inputX.value || this.context.option.imageWidth),
            (t = t || i.inputY.value || this.context.option.imageHeight),
            (i._onlyPercentage && e) || /%$/.test(e)
              ? (this.plugins.image.setPercentSize.call(this, e, t), !0)
              : ((e && "auto" !== e) || (t && "auto" !== t)
                  ? this.plugins.image.setSize.call(this, e, t, !1)
                  : this.plugins.image.setAutoSize.call(this),
                !1)
          );
        },
        setSize: function (e, t, i, n) {
          var l = this.context.image,
            o = /^(rw|lw)$/.test(n),
            s = /^(th|bh)$/.test(n);
          this.plugins.image.cancelPercentAttr.call(this),
            s ||
              (l._element.style.width = this.util.isNumber(e)
                ? e + l.sizeUnit
                : e),
            o ||
              (l._element.style.height = this.util.isNumber(t)
                ? t + l.sizeUnit
                : /%$/.test(t)
                ? ""
                : t),
            "center" === l._align &&
              this.plugins.image.setAlign.call(this, null, null, null, null),
            i || l._element.removeAttribute("data-percentage"),
            this.plugins.resizing._module_saveCurrentSize.call(this, l);
        },
        setAutoSize: function () {
          var e = this.context.image;
          this.plugins.resizing.resetTransform.call(this, e._element),
            this.plugins.image.cancelPercentAttr.call(this),
            (e._element.style.maxWidth = ""),
            (e._element.style.width = ""),
            (e._element.style.height = ""),
            (e._cover.style.width = ""),
            (e._cover.style.height = ""),
            this.plugins.image.setAlign.call(this, null, null, null, null),
            e._element.setAttribute("data-percentage", "auto,auto"),
            this.plugins.resizing._module_saveCurrentSize.call(this, e);
        },
        setOriginSize: function () {
          var e = this.context.image;
          e._element.removeAttribute("data-percentage"),
            this.plugins.resizing.resetTransform.call(this, e._element),
            this.plugins.image.cancelPercentAttr.call(this);
          var t = (e._element.getAttribute("data-origin") || "").split(","),
            i = t[0],
            n = t[1];
          t &&
            (e._onlyPercentage ||
            (/%$/.test(i) && (/%$/.test(n) || !/\d/.test(n)))
              ? this.plugins.image.setPercentSize.call(this, i, n)
              : this.plugins.image.setSize.call(this, i, n),
            this.plugins.resizing._module_saveCurrentSize.call(this, e));
        },
        setPercentSize: function (e, t) {
          var i = this.context.image;
          t =
            !t || /%$/.test(t) || this.util.getNumber(t, 0)
              ? this.util.isNumber(t)
                ? t + i.sizeUnit
                : t || ""
              : this.util.isNumber(t)
              ? t + "%"
              : t;
          var n = /%$/.test(t);
          (i._container.style.width = this.util.isNumber(e) ? e + "%" : e),
            (i._container.style.height = ""),
            (i._cover.style.width = "100%"),
            (i._cover.style.height = n ? t : ""),
            (i._element.style.width = "100%"),
            (i._element.style.height = n ? "" : t),
            (i._element.style.maxWidth = ""),
            "center" === i._align &&
              this.plugins.image.setAlign.call(this, null, null, null, null),
            i._element.setAttribute("data-percentage", e + "," + t),
            this.plugins.resizing.setCaptionPosition.call(this, i._element),
            this.plugins.resizing._module_saveCurrentSize.call(this, i);
        },
        cancelPercentAttr: function () {
          var e = this.context.image;
          (e._cover.style.width = ""),
            (e._cover.style.height = ""),
            (e._container.style.width = ""),
            (e._container.style.height = ""),
            this.util.removeClass(
              e._container,
              this.context.image._floatClassRegExp
            ),
            this.util.addClass(e._container, "__ke__float-" + e._align),
            "center" === e._align &&
              this.plugins.image.setAlign.call(this, null, null, null, null);
        },
        setAlign: function (e, t, i, n) {
          var l = this.context.image;
          (e = e || l._align),
            (t = t || l._element),
            (i = i || l._cover),
            (n = n || l._container),
            (i.style.margin = e && "none" !== e ? "auto" : "0"),
            /%$/.test(t.style.width) && "center" === e
              ? ((n.style.minWidth = "100%"), (i.style.width = n.style.width))
              : ((n.style.minWidth = ""),
                (i.style.width = this.context.resizing._rotateVertical
                  ? t.style.height || t.offsetHeight
                  : t.style.width && "auto" !== t.style.width
                  ? t.style.width || "100%"
                  : "")),
            this.util.hasClass(n, "__ke__float-" + e) ||
              (this.util.removeClass(n, l._floatClassRegExp),
              this.util.addClass(n, "__ke__float-" + e)),
            t.setAttribute("data-align", e);
        },
        resetAlign: function () {
          var e = this.context.image;
          e._element.setAttribute("data-align", ""),
            (e._align = "none"),
            (e._cover.style.margin = "0"),
            this.util.removeClass(e._container, e._floatClassRegExp);
        },
        init: function () {
          var e = this.context.image;
          e.imgInputFile && (e.imgInputFile.value = ""),
            e.imgUrlFile &&
              ((e._v_src._linkValue = ""),
              (e.previewSrc.textContent = ""),
              (e.imgUrlFile.value = "")),
            e.imgInputFile &&
              e.imgUrlFile &&
              (e.imgUrlFile.removeAttribute("disabled"),
              (e.previewSrc.style.textDecoration = "")),
            (e.altText.value = ""),
            (e._v_link._linkValue = ""),
            (e.previewLink.textContent = ""),
            (e.imgLink.value = ""),
            (e.imgLinkNewWindowCheck.checked = !1),
            (e.modal.querySelector(
              'input[name="kothing-editor_image_radio"][value="none"]'
            ).checked = !0),
            (e.captionCheckEl.checked = !1),
            (e._element = null),
            this.plugins.image.openTab.call(this, "init"),
            e._resizing &&
              ((e.inputX.value =
                this.context.option.imageWidth === e._defaultSizeX
                  ? ""
                  : this.context.option.imageWidth),
              (e.inputY.value =
                this.context.option.imageHeight === e._defaultSizeY
                  ? ""
                  : this.context.option.imageHeight),
              (e.proportion.checked = !0),
              (e._ratio = !1),
              (e._ratioX = 1),
              (e._ratioY = 1));
        },
      };
    function _(e) {
      return (_ =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    var b = {
      name: "video",
      display: "dialog",
      add: function (e) {
        e.addModule([c.a, h.a, p.a, f.a]);
        var t = e.context,
          i = (t.video = {
            _infoList: [],
            _infoIndex: 0,
            _uploadFileLength: 0,
            sizeUnit: t.option._videoSizeUnit,
            _align: "none",
            _floatClassRegExp: "__ke__float\\-[a-z]+",
            _youtubeQuery: t.option.youtubeQuery,
            _videoRatio: 100 * t.option.videoRatio + "%",
            _defaultRatio: 100 * t.option.videoRatio + "%",
            _linkValue: "",
            _element: null,
            _cover: null,
            _container: null,
            inputX: null,
            inputY: null,
            _element_w: 1,
            _element_h: 1,
            _element_l: 0,
            _element_t: 0,
            _defaultSizeX: "100%",
            _defaultSizeY: 100 * t.option.videoRatio + "%",
            _origin_w:
              "100%" === t.option.videoWidth ? "" : t.option.videoWidth,
            _origin_h:
              "56.25%" === t.option.videoHeight ? "" : t.option.videoHeight,
            _proportionChecked: !0,
            _resizing: t.option.videoResizing,
            _resizeDotHide: !t.option.videoHeightShow,
            _rotation: t.option.videoRotation,
            _onlyPercentage: t.option.videoSizeOnlyPercentage,
            _ratio: !1,
            _ratioX: 1,
            _ratioY: 1,
            _captionShow: !1,
          }),
          n = this.setDialog.call(e);
        (i.modal = n),
          (i.videoInputFile = n.querySelector("._ke_video_file")),
          (i.videoUrlFile = n.querySelector(".ke-input-url")),
          (i.focusElement = i.videoUrlFile || i.videoInputFile),
          (i.preview = n.querySelector(".ke-link-preview")),
          n
            .querySelector(".ke-btn-primary")
            .addEventListener("click", this.submit.bind(e)),
          i.videoInputFile &&
            n
              .querySelector(".ke-dialog-files-edge-button")
              .addEventListener(
                "click",
                this._removeSelectedFiles.bind(
                  i.videoInputFile,
                  i.videoUrlFile,
                  i.preview
                )
              ),
          i.videoInputFile &&
            i.videoUrlFile &&
            i.videoInputFile.addEventListener(
              "change",
              this._fileInputChange.bind(i)
            ),
          i.videoUrlFile &&
            i.videoUrlFile.addEventListener(
              "input",
              this._onLinkPreview.bind(i.preview, i, t.options.linkProtocol)
            ),
          (i.proportion = {}),
          (i.videoRatioOption = {}),
          (i.inputX = {}),
          (i.inputY = {}),
          t.option.videoResizing &&
            ((i.proportion = n.querySelector("._ke_video_check_proportion")),
            (i.videoRatioOption = n.querySelector(".ke-video-ratio")),
            (i.inputX = n.querySelector("._ke_video_size_x")),
            (i.inputY = n.querySelector("._ke_video_size_y")),
            (i.inputX.value = t.option.videoWidth),
            (i.inputY.value = t.option.videoHeight),
            i.inputX.addEventListener("keyup", this.setInputSize.bind(e, "x")),
            i.inputY.addEventListener("keyup", this.setInputSize.bind(e, "y")),
            i.inputX.addEventListener("change", this.setRatio.bind(e)),
            i.inputY.addEventListener("change", this.setRatio.bind(e)),
            i.proportion.addEventListener("change", this.setRatio.bind(e)),
            i.videoRatioOption.addEventListener(
              "change",
              this.setVideoRatio.bind(e)
            ),
            n
              .querySelector(".ke-dialog-btn-revert")
              .addEventListener("click", this.sizeRevert.bind(e))),
          t.dialog.modal.appendChild(n),
          (n = null);
      },
      setDialog: function () {
        var e = this.context.option,
          t = this.lang,
          i = this.util.createElement("DIV");
        (i.className = "ke-dialog-content"), (i.style.display = "none");
        var n =
          '<form method="post" enctype="multipart/form-data"><div class="ke-dialog-header"><button type="button" data-command="close" class="ke-btn ke-dialog-close" aria-label="Close" title="' +
          t.dialogBox.close +
          '">' +
          this.icons.cancel +
          '</button><span class="ke-modal-title">' +
          t.dialogBox.videoBox.title +
          '</span></div><div class="ke-dialog-body">';
        if (
          (e.videoFileInput &&
            (n +=
              '<div class="ke-dialog-form"><label>' +
              t.dialogBox.videoBox.file +
              '</label><div class="ke-dialog-form-files"><input class="ke-input-form _ke_video_file" type="file" accept="video/"' +
              e.videoAccept +
              (e.videoMultipleFile ? ' multiple="multiple"' : "") +
              '/><button type="button" data-command="filesRemove" class="ke-btn ke-dialog-files-edge-button ke-file-remove" title="' +
              t.controller.remove +
              '">' +
              this.icons.cancel +
              "</button></div></div>"),
          e.videoUrlInput &&
            (n +=
              '<div class="ke-dialog-form"><label>' +
              t.dialogBox.videoBox.url +
              '</label><input class="ke-input-form ke-input-url" type="text" /><pre class="ke-link-preview"></pre></div>'),
          e.videoResizing)
        ) {
          var l = e.videoRatioList || [
              { name: "16:9", value: 0.5625 },
              { name: "4:3", value: 0.75 },
              { name: "21:9", value: 0.4285 },
            ],
            o = e.videoRatio,
            s = e.videoSizeOnlyPercentage,
            a = s ? ' style="display: none !important;"' : "",
            r = e.videoHeightShow ? "" : ' style="display: none !important;"',
            c = e.videoRatioShow ? "" : ' style="display: none !important;"',
            d =
              s || e.videoHeightShow || e.videoRatioShow
                ? ""
                : ' style="display: none !important;"';
          (n +=
            '<div class="ke-dialog-form"><div class="ke-dialog-size-text"><label class="size-w">' +
            t.dialogBox.width +
            '</label><label class="ke-dialog-size-x">&nbsp;</label><label class="size-h"' +
            r +
            ">" +
            t.dialogBox.height +
            '</label><label class="size-h"' +
            c +
            ">(" +
            t.dialogBox.ratio +
            ')</label></div><input class="ke-input-control _ke_video_size_x" placeholder="100%"' +
            (s ? ' type="number" min="1"' : 'type="text"') +
            (s ? ' max="100"' : "") +
            '/><label class="ke-dialog-size-x"' +
            d +
            ">" +
            (s ? "%" : "x") +
            '</label><input class="ke-input-control _ke_video_size_y" placeholder="' +
            100 * e.videoRatio +
            '%"' +
            (s ? ' type="number" min="1"' : 'type="text"') +
            (s ? ' max="100"' : "") +
            r +
            '/><select class="ke-input-select ke-video-ratio" title="' +
            t.dialogBox.ratio +
            '"' +
            c +
            ">"),
            r || (n += '<option value=""> - </option>');
          for (var u = 0, h = l.length; u < h; u++)
            n +=
              '<option value="' +
              l[u].value +
              '"' +
              (o.toString() === l[u].value.toString() ? " selected" : "") +
              ">" +
              l[u].name +
              "</option>";
          n +=
            '</select><button type="button" title="' +
            t.dialogBox.revertButton +
            '" class="ke-btn ke-dialog-btn-revert" style="float: right;">' +
            this.icons.revert +
            '</button></div><div class="ke-dialog-form ke-dialog-form"' +
            a +
            d +
            '><label><input type="checkbox" class="ke-dialog-btn-check _ke_video_check_proportion" checked/>&nbsp;' +
            t.dialogBox.proportion +
            "</label></div>";
        }
        return (
          (n +=
            '</div><div class="ke-dialog-footer"><div><label><input type="radio" name="kothing-editor_video_radio" class="ke-dialog-btn-radio" value="none" checked>' +
            t.dialogBox.basic +
            '</label><label><input type="radio" name="kothing-editor_video_radio" class="ke-dialog-btn-radio" value="left">' +
            t.dialogBox.left +
            '</label><label><input type="radio" name="kothing-editor_video_radio" class="ke-dialog-btn-radio" value="center">' +
            t.dialogBox.center +
            '</label><label><input type="radio" name="kothing-editor_video_radio" class="ke-dialog-btn-radio" value="right">' +
            t.dialogBox.right +
            '</label></div><button type="submit" class="ke-btn-primary" title="' +
            t.dialogBox.submitButton +
            '"><span>' +
            t.dialogBox.submitButton +
            "</span></button></div></form>"),
          (i.innerHTML = n),
          i
        );
      },
      _fileInputChange: function () {
        this.videoInputFile.value
          ? (this.videoUrlFile.setAttribute("disabled", !0),
            (this.preview.style.textDecoration = "line-through"))
          : (this.videoUrlFile.removeAttribute("disabled"),
            (this.preview.style.textDecoration = ""));
      },
      _removeSelectedFiles: function (e, t) {
        (this.value = ""),
          e && (e.removeAttribute("disabled"), (t.style.textDecoration = ""));
      },
      _onLinkPreview: function (e, t, i) {
        var n = i.target.value.trim();
        /^<iframe.*\/iframe>$/.test(n)
          ? ((e._linkValue = n),
            (this.textContent = '<IFrame :src=".."></IFrame>'))
          : (e._linkValue = this.textContent = n
              ? t && -1 === n.indexOf("://") && 0 !== n.indexOf("#")
                ? t + n
                : -1 === n.indexOf("://")
                ? "/" + n
                : n
              : "");
      },
      _setTagAttrs: function (e) {
        e.setAttribute("controls", !0);
        var t = this.context.options.videoTagAttrs;
        if (t)
          for (var i in t) this.util.hasOwn(t, i) && e.setAttribute(i, t[i]);
      },
      createVideoTag: function () {
        var e = this.util.createElement("VIDEO");
        return this.plugins.video._setTagAttrs.call(this, e), e;
      },
      _setIframeAttrs: function (e) {
        (e.frameBorder = "0"), (e.allowFullscreen = !0);
        var t = this.context.options.videoIframeAttrs;
        if (t)
          for (var i in t) this.util.hasOwn(t, i) && e.setAttribute(i, t[i]);
      },
      createIframeTag: function () {
        var e = this.util.createElement("IFRAME");
        return this.plugins.video._setIframeAttrs.call(this, e), e;
      },
      fileTags: ["iframe", "video"],
      select: function (e) {
        this.plugins.video.onModifyMode.call(
          this,
          e,
          this.plugins.resizing.call_controller_resize.call(this, e, "video")
        );
      },
      destroy: function (e) {
        var t = e || this.context.video._element,
          i = this.context.video._container,
          n = +t.getAttribute("data-index"),
          l = i.previousElementSibling || i.nextElementSibling,
          o = i.parentNode;
        this.util.removeItem(i),
          this.plugins.video.init.call(this),
          this.controllersOff(),
          o !== this.context.element.wysiwyg &&
            this.util.removeItemAllParents(
              o,
              function (e) {
                return 0 === e.childNodes.length;
              },
              null
            ),
          this.focusEdge(l),
          this.plugins.fileManager.deleteInfo.call(
            this,
            "video",
            n,
            this.functions.onVideoUpload
          ),
          this.history.push(!1);
      },
      on: function (e) {
        var t = this.context.video;
        e
          ? t.videoInputFile &&
            this.context.options.videoMultipleFile &&
            t.videoInputFile.removeAttribute("multiple")
          : ((t.inputX.value = t._origin_w =
              this.context.option.videoWidth === t._defaultSizeX
                ? ""
                : this.context.option.videoWidth),
            (t.inputY.value = t._origin_h =
              this.context.option.videoHeight === t._defaultSizeY
                ? ""
                : this.context.option.videoHeight),
            (t.proportion.disabled = !0),
            t.videoInputFile &&
              this.context.options.videoMultipleFile &&
              t.videoInputFile.setAttribute("multiple", "multiple")),
          t._resizing &&
            this.plugins.video.setVideoRatioSelect.call(
              this,
              t._origin_h || t._defaultRatio
            );
      },
      open: function () {
        this.plugins.dialog.open.call(
          this,
          "video",
          "video" === this.currentControllerName
        );
      },
      setVideoRatio: function (e) {
        var t = this.context.video,
          i = e.target.options[e.target.selectedIndex].value;
        (t._defaultSizeY = t._videoRatio = i ? 100 * i + "%" : t._defaultSizeY),
          (t.inputY.placeholder = i ? 100 * i + "%" : ""),
          (t.inputY.value = "");
      },
      setInputSize: function (e, t) {
        var i;
        t && 32 === t.keyCode
          ? t.preventDefault()
          : ((i = this.context.video),
            this.plugins.resizing._module_setInputSize.call(this, i, e),
            "y" === e &&
              this.plugins.video.setVideoRatioSelect.call(
                this,
                t.target.value || i._defaultRatio
              ));
      },
      setRatio: function () {
        this.plugins.resizing._module_setRatio.call(this, this.context.video);
      },
      submit: function (e) {
        var t = this.context.video,
          i = this.plugins.video;
        e.preventDefault(),
          e.stopPropagation(),
          (t._align = t.modal.querySelector(
            'input[name="kothing-editor_video_radio"]:checked'
          ).value);
        try {
          t.videoInputFile && 0 < t.videoInputFile.files.length
            ? (this.showLoading(),
              i.submitAction.call(
                this,
                this.context.video.videoInputFile.files
              ))
            : t.videoUrlFile &&
              0 < t._linkValue.length &&
              (this.showLoading(), i.setup_url.call(this));
        } catch (e) {
          throw (
            (this.closeLoading(),
            Error(
              '[KothingEditor.video.submit.fail] cause : "' + e.message + '"'
            ))
          );
        } finally {
          this.plugins.dialog.close.call(this);
        }
        return !1;
      },
      submitAction: function (e) {
        if (0 !== e.length) {
          for (var t = 0, i = [], n = 0, l = e.length; n < l; n++)
            /video/i.test(e[n].type) && (i.push(e[n]), (t += e[n].size));
          var o = this.context.option.videoUploadSizeLimit;
          if (0 < o) {
            for (
              var s = 0, a = this.context.video._infoList, r = 0, c = a.length;
              r < c;
              r++
            )
              s += +a[r].size;
            if (o < t + s) {
              this.closeLoading();
              var d =
                "[KothingEditor.videoUpload.fail] Size of uploadable total videos: " +
                o / 1e3 +
                "KB";
              return void (
                ("function" === this.functions.onVideoUploadError &&
                  !this.functions.onVideoUploadError(
                    d,
                    { limitSize: o, currentSize: s, uploadSize: t },
                    this
                  )) ||
                this.functions.noticeOpen(d)
              );
            }
          }
          var u = this.context.video;
          u._uploadFileLength = i.length;
          var h = {
            inputWidth: u.inputX.value,
            inputHeight: u.inputY.value,
            align: u._align,
            isUpdate: this.context.dialog.updateModal,
            element: u._element,
          };
          if ("function" == typeof this.functions.onVideoUploadBefore) {
            var g = this.functions.onVideoUploadBefore(
              i,
              h,
              this,
              function (e) {
                e && this._w.Array.isArray(e.result)
                  ? this.plugins.video.register.call(this, h, e)
                  : this.plugins.video.upload.call(this, h, e);
              }.bind(this)
            );
            if (void 0 === g) return;
            if (!g) return void this.closeLoading();
            "object" === _(g) && 0 < g.length && (i = g);
          }
          this.plugins.video.upload.call(this, h, i);
        }
      },
      error: function (e, t) {
        if (
          (this.closeLoading(),
          "function" != typeof this.functions.onVideoUploadError ||
            this.functions.onVideoUploadError(e, t, this))
        )
          throw (
            (this.functions.noticeOpen(e),
            Error("[KothingEditor.plugin.video.error] response: " + e))
          );
      },
      upload: function (e, t) {
        if (t)
          if ("string" != typeof t) {
            var i = this.context.option.videoUploadUrl,
              n = this.context.dialog.updateModal ? 1 : t.length;
            if (!("string" == typeof i && 0 < i.length))
              throw Error(
                '[KothingEditor.videoUpload.fail] cause : There is no "videoUploadUrl" option.'
              );
            for (var l = new FormData(), o = 0; o < n; o++)
              l.append("file-" + o, t[o]);
            this.plugins.fileManager.upload.call(
              this,
              i,
              this.context.option.videoUploadHeader,
              l,
              this.plugins.video.callBack_videoUpload.bind(this, e),
              this.functions.onVideoUploadError
            );
          } else this.plugins.video.error.call(this, t, null);
        else this.closeLoading();
      },
      callBack_videoUpload: function (e, t) {
        var i;
        "function" == typeof this.functions.videoUploadHandler
          ? this.functions.videoUploadHandler(t, e, this)
          : (i = JSON.parse(t.responseText)).errorMessage
          ? this.plugins.video.error.call(this, i.errorMessage, i)
          : this.plugins.video.register.call(this, e, i);
      },
      register: function (e, t) {
        for (
          var i,
            n = t.result,
            l = this.plugins.video.createVideoTag.call(this),
            o = 0,
            s = n.length;
          o < s;
          o++
        )
          (i = { name: n[o].name, size: n[o].size }),
            this.plugins.video.create_video.call(
              this,
              e.isUpdate ? e.element : l.cloneNode(!1),
              n[o].url,
              e.inputWidth,
              e.inputHeight,
              e.align,
              i,
              e.isUpdate
            );
        this.closeLoading();
      },
      setup_url: function () {
        try {
          var e,
            t = this.context.video,
            i = t._linkValue;
          if (0 === i.length) return !1;
          if (
            /^<iframe.*\/iframe>$/.test(i) &&
            0 ===
              (i = new this._w.DOMParser()
                .parseFromString(i, "text/html")
                .querySelector("iframe").src).length
          )
            return !1;
          /youtu\.?be/.test(i)
            ? (/^http/.test(i) || (i = "https://" + i),
              (i = i.replace("watch?v=", "")),
              /^\/\/.+\/embed\//.test(i) ||
                (i = i
                  .replace(i.match(/\/\/.+\//)[0], "//www.youtube.com/embed/")
                  .replace("&", "?&")),
              0 < t._youtubeQuery.length &&
                (/\?/.test(i)
                  ? (i =
                      (e = i.split("?"))[0] +
                      "?" +
                      t._youtubeQuery +
                      "&" +
                      e[1])
                  : (i += "?" + t._youtubeQuery)))
            : /vimeo\.com/.test(i) &&
              (i.endsWith("/") && (i = i.slice(0, -1)),
              (i =
                "https://player.vimeo.com/video/" +
                i.slice(i.lastIndexOf("/") + 1))),
            this.plugins.video.create_video.call(
              this,
              this.plugins.video.createIframeTag.call(this),
              i,
              t.inputX.value,
              t.inputY.value,
              t._align,
              null,
              this.context.dialog.updateModal
            );
        } catch (e) {
          throw Error(
            '[KothingEditor.video.upload.fail] cause : "' + e.message + '"'
          );
        } finally {
          this.closeLoading();
        }
      },
      create_video: function (e, t, i, n, l, o, s) {
        this.context.resizing._resize_plugin = "video";
        var a,
          r,
          c,
          d,
          u = this.context.video,
          h = null,
          g = null,
          p = !1;
        s
          ? ((e = u._element).src !== t &&
              ((p = !0),
              (a = /youtu\.?be/.test(t)),
              (r = /vimeo\.com/.test(t)),
              (!a && !r) || /^iframe$/i.test(e.nodeName)
                ? a || r || /^videoo$/i.test(e.nodeName)
                  ? (e.src = t)
                  : (((c = this.plugins.video.createVideoTag.call(
                      this
                    )).src = t),
                    e.parentNode.replaceChild(c, e),
                    (u._element = e = c))
                : (((d = this.plugins.video.createIframeTag.call(
                    this
                  )).src = t),
                  e.parentNode.replaceChild(d, e),
                  (u._element = e = d))),
            (g = u._container),
            (h = this.util.getParentElement(e, "FIGURE")))
          : ((p = !0),
            (e.src = t),
            (u._element = e),
            (h = this.plugins.component.set_cover.call(this, e)),
            (g = this.plugins.component.set_container.call(
              this,
              h,
              "ke-video-container"
            ))),
          (u._cover = h),
          (u._container = g);
        var m =
            this.plugins.resizing._module_getSizeX.call(this, u) !==
              (i || u._defaultSizeX) ||
            this.plugins.resizing._module_getSizeY.call(this, u) !==
              (n || u._videoRatio),
          f = !s || m;
        u._resizing &&
          ((this.context.video._proportionChecked = u.proportion.checked),
          e.setAttribute("data-proportion", u._proportionChecked));
        var v = !1;
        f && (v = this.plugins.video.applySize.call(this)),
          (v && "center" === l) ||
            this.plugins.video.setAlign.call(this, null, e, h, g);
        var _ = !0;
        s
          ? u._resizing &&
            this.context.resizing._rotateVertical &&
            f &&
            this.plugins.resizing.setTransformSize.call(this, e, null, null)
          : (_ = this.insertComponent(g, !1, !0, !1)),
          _ &&
            (p &&
              this.plugins.fileManager.setInfo.call(
                this,
                "video",
                e,
                this.functions.onVideoUpload,
                o,
                !0
              ),
            s && (this.selectComponent(e, "video"), this.history.push(!1))),
          (this.context.resizing._resize_plugin = "");
      },
      _update_videoCover: function (e) {
        var t, i, n, l, o, s, a;
        e &&
          ((t = this.context.video),
          /^video$/i.test(e.nodeName)
            ? this.plugins.video._setTagAttrs.call(this, e)
            : this.plugins.video._setIframeAttrs.call(this, e),
          (i =
            this.util.getParentElement(e, this.util.isMediaComponent) ||
            this.util.getParentElement(
              e,
              function (e) {
                return this.isWysiwygDiv(e.parentNode);
              }.bind(this.util)
            )),
          (t._element = e = e.cloneNode(!0)),
          (n = t._cover = this.plugins.component.set_cover.call(this, e)),
          (l = t._container = this.plugins.component.set_container.call(
            this,
            n,
            "ke-video-container"
          )),
          (s = null),
          (o = i.querySelector("figcaption")) &&
            (((s = this.util.createElement("DIV")).innerHTML = o.innerHTML),
            this.util.removeItem(o)),
          (a = (
            e.getAttribute("data-size") ||
            e.getAttribute("data-origin") ||
            ""
          ).split(",")),
          this.plugins.video.applySize.call(this, a[0], a[1]),
          i.parentNode.replaceChild(l, i),
          s && i.parentNode.insertBefore(s, l.nextElementSibling),
          this.plugins.fileManager.setInfo.call(
            this,
            "video",
            e,
            this.functions.onVideoUpload,
            null,
            !0
          ));
      },
      onModifyMode: function (e, t) {
        var i = this.context.video;
        (i._element = e),
          (i._cover = this.util.getParentElement(e, "FIGURE")),
          (i._container = this.util.getParentElement(
            e,
            this.util.isMediaComponent
          )),
          (i._align = e.getAttribute("data-align") || "none"),
          t &&
            ((i._element_w = t.w),
            (i._element_h = t.h),
            (i._element_t = t.t),
            (i._element_l = t.l));
        var n =
          i._element.getAttribute("data-size") ||
          i._element.getAttribute("data-origin");
        n
          ? ((n = n.split(",")), (i._origin_w = n[0]), (i._origin_h = n[1]))
          : t && ((i._origin_w = t.w), (i._origin_h = t.h));
      },
      openModify: function (e) {
        var t,
          i = this.context.video;
        i.videoUrlFile &&
          ((i._linkValue =
            i._element.src ||
            (i._element.querySelector("source") || "").src ||
            ""),
          (i.preview.textContent =
            i._element.src ||
            (i._element.querySelector("source") || "").src ||
            ""),
          (i.videoUrlFile.value =
            i._element.src ||
            (i._element.querySelector("source") || "").src ||
            "")),
          (i.modal.querySelector(
            'input[name="kothing-editor_video_radio"][value="' + i._align + '"]'
          ).checked = !0),
          i._resizing &&
            (this.plugins.resizing._module_setModifyInputSize.call(
              this,
              i,
              this.plugins.video
            ),
            (t = i._videoRatio = this.plugins.resizing._module_getSizeY.call(
              this,
              i
            )),
            this.plugins.video.setVideoRatioSelect.call(this, t) ||
              (i.inputY.value = i._onlyPercentage
                ? this.util.getNumber(t, 2)
                : t)),
          e || this.plugins.dialog.open.call(this, "video", !0);
      },
      setVideoRatioSelect: function (e) {
        var t = !1,
          i = this.context.video,
          n = i.videoRatioOption.options;
        /%$/.test(e) || i._onlyPercentage
          ? (e = this.util.getNumber(e, 2) / 100 + "")
          : (!this.util.isNumber(e) || 1 <= +e) && (e = ""),
          (i.inputY.placeholder = "");
        for (var l = 0, o = n.length; l < o; l++)
          n[l].value === e
            ? ((t = n[l].selected = !0),
              (i.inputY.placeholder = e ? 100 * e + "%" : ""))
            : (n[l].selected = !1);
        return t;
      },
      checkFileInfo: function () {
        this.plugins.fileManager.checkInfo.call(
          this,
          "video",
          ["iframe", "video"],
          this.functions.onVideoUpload,
          this.plugins.video._update_videoCover.bind(this),
          !0
        );
      },
      resetFileInfo: function () {
        this.plugins.fileManager.resetInfo.call(
          this,
          "video",
          this.functions.onVideoUpload
        );
      },
      sizeRevert: function () {
        this.plugins.resizing._module_sizeRevert.call(this, this.context.video);
      },
      applySize: function (e, t) {
        var i = this.context.video;
        return (
          (e = e || i.inputX.value || this.context.option.videoWidth),
          (t = t || i.inputY.value || this.context.option.videoHeight),
          i._onlyPercentage || /%$/.test(e) || !e
            ? (this.plugins.video.setPercentSize.call(
                this,
                e || "100%",
                t ||
                  (/%$/.test(i._videoRatio) ? i._videoRatio : i._defaultRatio)
              ),
              !0)
            : ((e && "auto" !== e) || (t && "auto" !== t)
                ? this.plugins.video.setSize.call(
                    this,
                    e,
                    t || i._videoRatio || i._defaultRatio,
                    !1
                  )
                : this.plugins.video.setAutoSize.call(this),
              !1)
        );
      },
      setSize: function (e, t, i, n) {
        var l = this.context.video,
          o = /^(rw|lw)$/.test(n),
          s = /^(th|bh)$/.test(n);
        s || (e = this.util.getNumber(e, 0)),
          o || (t = this.util.isNumber(t) ? t + l.sizeUnit : t || ""),
          s || (l._element.style.width = e ? e + l.sizeUnit : ""),
          o || (l._cover.style.paddingBottom = l._cover.style.height = t),
          s ||
            /%$/.test(e) ||
            ((l._cover.style.width = ""), (l._container.style.width = "")),
          o || /%$/.test(t)
            ? (l._element.style.height = "")
            : (l._element.style.height = t),
          i || l._element.removeAttribute("data-percentage"),
          this.plugins.resizing._module_saveCurrentSize.call(this, l);
      },
      setAutoSize: function () {
        this.plugins.video.setPercentSize.call(
          this,
          100,
          this.context.video._defaultRatio
        );
      },
      setOriginSize: function (e) {
        var t = this.context.video;
        t._element.removeAttribute("data-percentage"),
          this.plugins.resizing.resetTransform.call(this, t._element),
          this.plugins.video.cancelPercentAttr.call(this);
        var i,
          n,
          l = (
            (e ? t._element.getAttribute("data-size") : "") ||
            t._element.getAttribute("data-origin") ||
            ""
          ).split(",");
        l &&
          ((i = l[0]),
          (n = l[1]),
          t._onlyPercentage || (/%$/.test(i) && (/%$/.test(n) || !/\d/.test(n)))
            ? this.plugins.video.setPercentSize.call(this, i, n)
            : this.plugins.video.setSize.call(this, i, n),
          this.plugins.resizing._module_saveCurrentSize.call(this, t));
      },
      setPercentSize: function (e, t) {
        var i = this.context.video;
        (t =
          !t || /%$/.test(t) || this.util.getNumber(t, 0)
            ? this.util.isNumber(t)
              ? t + i.sizeUnit
              : t || i._defaultRatio
            : this.util.isNumber(t)
            ? t + "%"
            : t),
          (i._container.style.width = this.util.isNumber(e) ? e + "%" : e),
          (i._container.style.height = ""),
          (i._cover.style.width = "100%"),
          (i._cover.style.height = t),
          (i._cover.style.paddingBottom = t),
          (i._element.style.width = "100%"),
          (i._element.style.height = "100%"),
          (i._element.style.maxWidth = ""),
          "center" === i._align &&
            this.plugins.video.setAlign.call(this, null, null, null, null),
          i._element.setAttribute("data-percentage", e + "," + t),
          this.plugins.resizing._module_saveCurrentSize.call(this, i);
      },
      cancelPercentAttr: function () {
        var e = this.context.video;
        (e._cover.style.width = ""),
          (e._cover.style.height = ""),
          (e._cover.style.paddingBottom = ""),
          (e._container.style.width = ""),
          (e._container.style.height = ""),
          this.util.removeClass(
            e._container,
            this.context.video._floatClassRegExp
          ),
          this.util.addClass(e._container, "__ke__float-" + e._align),
          "center" === e._align &&
            this.plugins.video.setAlign.call(this, null, null, null, null);
      },
      setAlign: function (e, t, i, n) {
        var l = this.context.video;
        (e = e || l._align),
          (t = t || l._element),
          (i = i || l._cover),
          (n = n || l._container),
          (i.style.margin = e && "none" !== e ? "auto" : "0"),
          /%$/.test(t.style.width) && "center" === e
            ? ((n.style.minWidth = "100%"),
              (i.style.width = n.style.width),
              (i.style.height = n.style.height),
              (i.style.paddingBottom = /%$/.test(i.style.height)
                ? this.util.getNumber(
                    (this.util.getNumber(i.style.height, 2) / 100) *
                      this.util.getNumber(i.style.width, 2),
                    2
                  ) + "%"
                : i.style.height))
            : ((n.style.minWidth = ""),
              (i.style.width = this.context.resizing._rotateVertical
                ? t.style.height || t.offsetHeight
                : t.style.width || "100%"),
              (i.style.paddingBottom = i.style.height)),
          this.util.hasClass(n, "__ke__float-" + e) ||
            (this.util.removeClass(n, l._floatClassRegExp),
            this.util.addClass(n, "__ke__float-" + e)),
          t.setAttribute("data-align", e);
      },
      resetAlign: function () {
        var e = this.context.video;
        e._element.setAttribute("data-align", ""),
          (e._align = "none"),
          (e._cover.style.margin = "0"),
          this.util.removeClass(e._container, e._floatClassRegExp);
      },
      init: function () {
        var e = this.context.video;
        e.videoInputFile && (e.videoInputFile.value = ""),
          e.videoUrlFile &&
            (e._linkValue = e.preview.textContent = e.videoUrlFile.value = ""),
          e.videoInputFile &&
            e.videoUrlFile &&
            (e.videoUrlFile.removeAttribute("disabled"),
            (e.preview.style.textDecoration = "")),
          (e._origin_w = this.context.option.videoWidth),
          (e._origin_h = this.context.option.videoHeight),
          (e.modal.querySelector(
            'input[name="kothing-editor_video_radio"][value="none"]'
          ).checked = !0),
          e._resizing &&
            ((e.inputX.value =
              this.context.option.videoWidth === e._defaultSizeX
                ? ""
                : this.context.option.videoWidth),
            (e.inputY.value =
              this.context.option.videoHeight === e._defaultSizeY
                ? ""
                : this.context.option.videoHeight),
            (e.proportion.checked = !0),
            (e.proportion.disabled = !0),
            this.plugins.video.setVideoRatioSelect.call(this, e._defaultRatio));
      },
    };
    function y(e) {
      return (y =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    var w = {
        name: "audio",
        display: "dialog",
        add: function (e) {
          e.addModule([c.a, h.a, f.a]);
          var t = e.context,
            i = (t.audio = {
              _infoList: [],
              _infoIndex: 0,
              _uploadFileLength: 0,
              focusElement: null,
              targetSelect: null,
              _origin_w: t.option.audioWidth,
              _origin_h: t.option.audioHeight,
              _linkValue: "",
              _element: null,
              _cover: null,
              _container: null,
            }),
            n = this.setDialog.call(e);
          (i.modal = n),
            (i.audioInputFile = n.querySelector("._ke_audio_files")),
            (i.audioUrlFile = n.querySelector(".ke-input-url")),
            (i.focusElement = i.audioInputFile || i.audioUrlFile),
            (i.preview = n.querySelector(".ke-link-preview"));
          var l = this.setController.call(e);
          (i.controller = l).addEventListener("mousedown", e.eventStop),
            n
              .querySelector(".ke-btn-primary")
              .addEventListener("click", this.submit.bind(e)),
            i.audioInputFile &&
              n
                .querySelector(".ke-dialog-files-edge-button")
                .addEventListener(
                  "click",
                  this._removeSelectedFiles.bind(
                    i.audioInputFile,
                    i.audioUrlFile,
                    i.preview
                  )
                ),
            i.audioInputFile &&
              i.audioUrlFile &&
              i.audioInputFile.addEventListener(
                "change",
                this._fileInputChange.bind(i)
              ),
            l.addEventListener("click", this.onClick_controller.bind(e)),
            i.audioUrlFile &&
              i.audioUrlFile.addEventListener(
                "input",
                this._onLinkPreview.bind(i.preview, i, t.options.linkProtocol)
              ),
            t.dialog.modal.appendChild(n),
            t.element.relative.appendChild(l),
            (l = n = null);
        },
        setDialog: function () {
          var e = this.context.option,
            t = this.lang,
            i = this.util.createElement("DIV");
          (i.className = "ke-dialog-content"), (i.style.display = "none");
          var n =
            '<form method="post" enctype="multipart/form-data"><div class="ke-dialog-header"><button type="button" data-command="close" class="ke-btn ke-dialog-close" aria-label="Close" title="' +
            t.dialogBox.close +
            '">' +
            this.icons.cancel +
            '</button><span class="ke-modal-title">' +
            t.dialogBox.audioBox.title +
            '</span></div><div class="ke-dialog-body">';
          return (
            e.audioFileInput &&
              (n +=
                '<div class="ke-dialog-form"><label>' +
                t.dialogBox.audioBox.file +
                '</label><div class="ke-dialog-form-files"><input class="ke-input-form _ke_audio_files" type="file" accept="audio/"' +
                e.audioAccept +
                (e.audioMultipleFile ? ' multiple="multiple"' : "") +
                '/><button type="button" data-command="filesRemove" class="ke-btn ke-dialog-files-edge-button ke-file-remove" title="' +
                t.controller.remove +
                '">' +
                this.icons.cancel +
                "</button></div></div>"),
            e.audioUrlInput &&
              (n +=
                '<div class="ke-dialog-form"><label>' +
                t.dialogBox.audioBox.url +
                '</label><input class="ke-input-form ke-input-url" type="text" /><pre class="ke-link-preview"></pre></div>'),
            (n +=
              '</div><div class="ke-dialog-footer"><button type="submit" class="ke-btn-primary" title="' +
              t.dialogBox.submitButton +
              '"><span>' +
              t.dialogBox.submitButton +
              "</span></button></div></form>"),
            (i.innerHTML = n),
            i
          );
        },
        setController: function () {
          var e = this.lang,
            t = this.icons,
            i = this.util.createElement("DIV");
          return (
            (i.className = "ke-controller ke-controller-link"),
            (i.innerHTML =
              '<div class="ke-arrow ke-arrow-up"></div><div class="link-content"><div class="ke-btn-group"><button type="button" data-command="update" tabindex="-1" class="ke-tooltip">' +
              t.edit +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.edit +
              '</span></span></button><button type="button" data-command="delete" tabindex="-1" class="ke-tooltip">' +
              t.delete +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.remove +
              "</span></span></button></div></div>"),
            i
          );
        },
        _fileInputChange: function () {
          this.audioInputFile.value
            ? (this.audioUrlFile.setAttribute("disabled", !0),
              (this.preview.style.textDecoration = "line-through"))
            : (this.audioUrlFile.removeAttribute("disabled"),
              (this.preview.style.textDecoration = ""));
        },
        _removeSelectedFiles: function (e, t) {
          (this.value = ""),
            e && (e.removeAttribute("disabled"), (t.style.textDecoration = ""));
        },
        _createAudioTag: function () {
          var e = this.util.createElement("AUDIO");
          this.plugins.audio._setTagAttrs.call(this, e);
          var t = this.context.audio._origin_w,
            i = this.context.audio._origin_h;
          return (
            e.setAttribute("origin-size", t + "," + i),
            (e.style.cssText =
              (t ? "width:" + t + "; " : "") + (i ? "height:" + i + ";" : "")),
            e
          );
        },
        _setTagAttrs: function (e) {
          e.setAttribute("controls", !0);
          var t = this.context.options.audioTagAttrs;
          if (t)
            for (var i in t) this.util.hasOwn(t, i) && e.setAttribute(i, t[i]);
        },
        _onLinkPreview: function (e, t, i) {
          var n = i.target.value.trim();
          e._linkValue = this.textContent = n
            ? t && -1 === n.indexOf("://") && 0 !== n.indexOf("#")
              ? t + n
              : -1 === n.indexOf("://")
              ? "/" + n
              : n
            : "";
        },
        fileTags: ["audio"],
        select: function (e) {
          this.plugins.audio.onModifyMode.call(this, e);
        },
        destroy: function (e) {
          e = e || this.context.audio._element;
          var t = this.util.getParentElement(e, this.util.isComponent) || e,
            i = +e.getAttribute("data-index"),
            n = t.previousElementSibling || t.nextElementSibling,
            l = t.parentNode;
          this.util.removeItem(t),
            this.plugins.audio.init.call(this),
            this.controllersOff(),
            l !== this.context.element.wysiwyg &&
              this.util.removeItemAllParents(
                l,
                function (e) {
                  return 0 === e.childNodes.length;
                },
                null
              ),
            this.focusEdge(n),
            this.plugins.fileManager.deleteInfo.call(
              this,
              "audio",
              i,
              this.functions.onAudioUpload
            ),
            this.history.push(!1);
        },
        checkFileInfo: function () {
          this.plugins.fileManager.checkInfo.call(
            this,
            "audio",
            ["audio"],
            this.functions.onAudioUpload,
            this.plugins.audio.updateCover.bind(this),
            !1
          );
        },
        resetFileInfo: function () {
          this.plugins.fileManager.resetInfo.call(
            this,
            "audio",
            this.functions.onAudioUpload
          );
        },
        on: function (e) {
          var t = this.context.audio;
          e
            ? (t._element &&
                ((this.context.dialog.updateModal = !0),
                (t._linkValue = t.preview.textContent = t.audioUrlFile.value =
                  t._element.src)),
              t.audioInputFile &&
                this.context.options.audioMultipleFile &&
                t.audioInputFile.removeAttribute("multiple"))
            : (this.plugins.audio.init.call(this),
              t.audioInputFile &&
                this.context.options.audioMultipleFile &&
                t.audioInputFile.setAttribute("multiple", "multiple"));
        },
        open: function () {
          this.plugins.dialog.open.call(
            this,
            "audio",
            "audio" === this.currentControllerName
          );
        },
        submit: function (e) {
          var t = this.context.audio;
          e.preventDefault(), e.stopPropagation();
          try {
            t.audioInputFile && 0 < t.audioInputFile.files.length
              ? (this.showLoading(),
                this.plugins.audio.submitAction.call(
                  this,
                  t.audioInputFile.files
                ))
              : t.audioUrlFile &&
                0 < t._linkValue.length &&
                (this.showLoading(),
                this.plugins.audio.setupUrl.call(this, t._linkValue));
          } catch (e) {
            throw (
              (this.closeLoading(),
              Error(
                '[KothingEditor.audio.submit.fail] cause : "' + e.message + '"'
              ))
            );
          } finally {
            this.plugins.dialog.close.call(this);
          }
          return !1;
        },
        submitAction: function (e) {
          if (0 !== e.length) {
            for (var t = 0, i = [], n = 0, l = e.length; n < l; n++)
              /audio/i.test(e[n].type) && (i.push(e[n]), (t += e[n].size));
            var o = this.context.option.audioUploadSizeLimit;
            if (0 < o) {
              for (
                var s = 0,
                  a = this.context.audio._infoList,
                  r = 0,
                  c = a.length;
                r < c;
                r++
              )
                s += +a[r].size;
              if (o < t + s) {
                this.closeLoading();
                var d =
                  "[KothingEditor.audioUpload.fail] Size of uploadable total audios: " +
                  o / 1e3 +
                  "KB";
                return void (
                  ("function" === this.functions.onAudioUploadError &&
                    !this.functions.onAudioUploadError(
                      d,
                      { limitSize: o, currentSize: s, uploadSize: t },
                      this
                    )) ||
                  this.functions.noticeOpen(d)
                );
              }
            }
            var u = this.context.audio;
            u._uploadFileLength = i.length;
            var h = {
              isUpdate: this.context.dialog.updateModal,
              element: u._element,
            };
            if ("function" == typeof this.functions.onAudioUploadBefore) {
              var g = this.functions.onAudioUploadBefore(
                i,
                h,
                this,
                function (e) {
                  e && this._w.Array.isArray(e.result)
                    ? this.plugins.audio.register.call(this, h, e)
                    : this.plugins.audio.upload.call(this, h, e);
                }.bind(this)
              );
              if (void 0 === g) return;
              if (!g) return void this.closeLoading();
              "object" === y(g) && 0 < g.length && (i = g);
            }
            this.plugins.audio.upload.call(this, h, i);
          }
        },
        error: function (e, t) {
          if (
            (this.closeLoading(),
            "function" != typeof this.functions.onAudioUploadError ||
              this.functions.onAudioUploadError(e, t, this))
          )
            throw (
              (this.functions.noticeOpen(e),
              Error("[KothingEditor.plugin.audio.exception] response: " + e))
            );
        },
        upload: function (e, t) {
          if (t)
            if ("string" != typeof t) {
              for (
                var i = this.context.option.audioUploadUrl,
                  n = this.context.dialog.updateModal ? 1 : t.length,
                  l = new FormData(),
                  o = 0;
                o < n;
                o++
              )
                l.append("file-" + o, t[o]);
              this.plugins.fileManager.upload.call(
                this,
                i,
                this.context.option.audioUploadHeader,
                l,
                this.plugins.audio.callBack_upload.bind(this, e),
                this.functions.onAudioUploadError
              );
            } else this.plugins.audio.error.call(this, t, null);
          else this.closeLoading();
        },
        callBack_upload: function (e, t) {
          var i;
          "function" == typeof this.functions.audioUploadHandler
            ? this.functions.audioUploadHandler(t, e, this)
            : (i = JSON.parse(t.responseText)).errorMessage
            ? this.plugins.audio.error.call(this, i.errorMessage, i)
            : this.plugins.audio.register.call(this, e, i);
        },
        register: function (e, t) {
          for (var i, n, l = t.result, o = 0, s = l.length; o < s; o++)
            (n = e.isUpdate
              ? e.element
              : this.plugins.audio._createAudioTag.call(this)),
              (i = { name: l[o].name, size: l[o].size }),
              this.plugins.audio.create_audio.call(
                this,
                n,
                l[o].url,
                i,
                e.isUpdate
              );
          this.closeLoading();
        },
        setupUrl: function (e) {
          try {
            if (0 === e.length) return !1;
            this.plugins.audio.create_audio.call(
              this,
              this.plugins.audio._createAudioTag.call(this),
              e,
              null,
              this.context.dialog.updateModal
            );
          } catch (e) {
            throw Error(
              '[KothingEditor.audio.audio.fail] cause : "' + e.message + '"'
            );
          } finally {
            this.closeLoading();
          }
        },
        create_audio: function (e, t, i, n) {
          var l = this.context.audio;
          if (n) {
            if ((l._element && (e = l._element), !e || e.src === t))
              return void this.selectComponent(e, "audio");
            e.src = t;
          } else {
            e.src = t;
            var o = this.plugins.component.set_cover.call(this, e),
              s = this.plugins.component.set_container.call(this, o, "");
            if (!this.insertComponent(s, !1, !0, !1)) return void this.focus();
          }
          this.plugins.fileManager.setInfo.call(
            this,
            "audio",
            e,
            this.functions.onAudioUpload,
            i,
            !1
          ),
            this.selectComponent(e, "audio"),
            n && this.history.push(!1);
        },
        updateCover: function (e) {
          var t = this.context.audio;
          this.plugins.audio._setTagAttrs.call(this, e);
          var i =
            this.util.getParentElement(e, this.util.isMediaComponent) ||
            this.util.getParentElement(
              e,
              function (e) {
                return this.isWysiwygDiv(e.parentNode);
              }.bind(this.util)
            );
          t._element = e = e.cloneNode(!1);
          var n = this.plugins.component.set_cover.call(this, e),
            l = this.plugins.component.set_container.call(
              this,
              n,
              "ke-audio-container"
            );
          i.parentNode.replaceChild(l, i),
            this.plugins.fileManager.setInfo.call(
              this,
              "audio",
              e,
              this.functions.onAudioUpload,
              null,
              !1
            );
        },
        onModifyMode: function (e) {
          var t = this.context.audio,
            i = t.controller,
            n = this.util.getOffset(e, this.context.element.wysiwygFrame);
          (i.style.top = n.top + e.offsetHeight + 10 + "px"),
            (i.style.left =
              n.left - this.context.element.wysiwygFrame.scrollLeft + "px"),
            (i.style.display = "block");
          var l =
            this.context.element.wysiwygFrame.offsetWidth -
            (i.offsetLeft + i.offsetWidth);
          l < 0
            ? ((i.style.left = i.offsetLeft + l + "px"),
              (i.firstElementChild.style.left = 20 - l + "px"))
            : (i.firstElementChild.style.left = "20px"),
            this.controllersOn(
              i,
              e,
              this.plugins.audio.onControllerOff.bind(this, e),
              "audio"
            ),
            this.util.addClass(e, "active"),
            (t._element = e),
            (t._cover = this.util.getParentElement(e, "FIGURE")),
            (t._container = this.util.getParentElement(
              e,
              this.util.isComponent
            ));
        },
        openModify: function (e) {
          var t;
          this.context.audio.audioUrlFile &&
            ((t = this.context
              .audio)._linkValue = t.preview.textContent = t.audioUrlFile.value =
              t._element.src),
            e || this.plugins.dialog.open.call(this, "audio", !0);
        },
        onClick_controller: function (e) {
          e.stopPropagation();
          var t = e.target.getAttribute("data-command");
          t &&
            (e.preventDefault(),
            /update/.test(t)
              ? this.plugins.audio.openModify.call(this, !1)
              : this.plugins.audio.destroy.call(
                  this,
                  this.context.audio._element
                ),
            this.controllersOff());
        },
        onControllerOff: function (e) {
          this.util.removeClass(e, "active"),
            (this.context.audio.controller.style.display = "none");
        },
        init: function () {
          var e;
          this.context.dialog.updateModal ||
            ((e = this.context.audio).audioInputFile &&
              (e.audioInputFile.value = ""),
            e.audioUrlFile &&
              (e._linkValue = e.preview.textContent = e.audioUrlFile.value =
                ""),
            e.audioInputFile &&
              e.audioUrlFile &&
              (e.audioUrlFile.removeAttribute("disabled"),
              (e.preview.style.textDecoration = "")),
            (e._element = null));
        },
      },
      C = {
        name: "math",
        display: "dialog",
        add: function (e) {
          e.addModule([c.a]);
          var t = e.context;
          t.math = {
            focusElement: null,
            previewElement: null,
            fontSizeElement: null,
            _mathExp: null,
          };
          var i = this.setDialog.call(e);
          (t.math.modal = i),
            (t.math.focusElement = i.querySelector(".ke-math-exp")),
            (t.math.previewElement = i.querySelector(".ke-math-preview")),
            (t.math.fontSizeElement = i.querySelector(".ke-math-size")),
            t.math.focusElement.addEventListener(
              "keyup",
              this._renderMathExp.bind(e, t.math),
              !1
            ),
            t.math.focusElement.addEventListener(
              "change",
              this._renderMathExp.bind(e, t.math),
              !1
            ),
            t.math.fontSizeElement.addEventListener(
              "change",
              function (e) {
                this.fontSize = e.target.value;
              }.bind(t.math.previewElement.style),
              !1
            );
          var n = this.setController_MathButton.call(e);
          (t.math.mathController = n),
            (t.math._mathExp = null),
            n.addEventListener("mousedown", e.eventStop),
            i
              .querySelector(".ke-btn-primary")
              .addEventListener("click", this.submit.bind(e), !1),
            n.addEventListener("click", this.onClick_mathController.bind(e)),
            t.dialog.modal.appendChild(i),
            t.element.relative.appendChild(n),
            (n = i = null);
        },
        setDialog: function () {
          var e = this.lang,
            t = this.util.createElement("DIV");
          return (
            (t.className = "ke-dialog-content"),
            (t.style.display = "none"),
            (t.innerHTML =
              '<form><div class="ke-dialog-header"><button type="button" data-command="close" class="ke-btn ke-dialog-close" aria-label="Close" title="' +
              e.dialogBox.close +
              '">' +
              this.icons.cancel +
              '</button><span class="ke-modal-title">' +
              e.dialogBox.mathBox.title +
              '</span></div><div class="ke-dialog-body"><div class="ke-dialog-form"><label>' +
              e.dialogBox.mathBox.inputLabel +
              ' (<a href="https://katex.org/docs/supported.html" target="_blank">KaTeX</a>)</label><textarea class="ke-input-form ke-math-exp" type="text"></textarea></div><div class="ke-dialog-form"><label>' +
              e.dialogBox.mathBox.fontSizeLabel +
              '</label><select class="ke-input-select ke-math-size"><option value="1em">1</option><option value="1.5em">1.5</option><option value="2em">2</option><option value="2.5em">2.5</option></select></div><div class="ke-dialog-form"><label>' +
              e.dialogBox.mathBox.previewLabel +
              '</label><p class="ke-math-preview"></p></div></div><div class="ke-dialog-footer"><button type="submit" class="ke-btn-primary" title="' +
              e.dialogBox.submitButton +
              '"><span>' +
              e.dialogBox.submitButton +
              "</span></button></div></form>"),
            t
          );
        },
        setController_MathButton: function () {
          var e = this.lang,
            t = this.util.createElement("DIV");
          return (
            (t.className = "ke-controller ke-controller-link"),
            (t.innerHTML =
              '<div class="ke-arrow ke-arrow-up"></div><div class="link-content"><div class="ke-btn-group"><button type="button" data-command="update" tabindex="-1" class="ke-btn ke-tooltip">' +
              this.icons.edit +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.edit +
              '</span></span></button><button type="button" data-command="delete" tabindex="-1" class="ke-btn ke-tooltip">' +
              this.icons.delete +
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              e.controller.remove +
              "</span></span></button></div></div>"),
            t
          );
        },
        open: function () {
          this.plugins.dialog.open.call(
            this,
            "math",
            "math" === this.currentControllerName
          );
        },
        managedTags: function () {
          return {
            className: "katex",
            method: function (e) {
              var t;
              e.getAttribute("data-exp") &&
                ((t = this._d
                  .createRange()
                  .createContextualFragment(
                    this.plugins.math._renderer.call(
                      this,
                      this.util.HTMLDecoder(e.getAttribute("data-exp"))
                    )
                  )),
                (e.innerHTML = t.querySelector(".katex").innerHTML));
            },
          };
        },
        _renderer: function (e) {
          var t = this.context.option.katex;
          return t.src.renderToString(e, t.options);
        },
        _renderMathExp: function (e, t) {
          e.previewElement.innerHTML = this.plugins.math._renderer.call(
            this,
            t.target.value
          );
        },
        submit: function (e) {
          this.showLoading(), e.preventDefault(), e.stopPropagation();
          var t = function () {
            if (0 === this.context.math.focusElement.value.trim().length)
              return !1;
            var e = this.context.math,
              t = e.focusElement.value,
              i = e.previewElement.querySelector(".katex");
            if (!i) return !1;
            if (
              ((i.className = "__ke__katex " + i.className),
              i.setAttribute("contenteditable", !1),
              i.setAttribute("data-exp", this.util.HTMLEncoder(t)),
              i.setAttribute("data-font-size", e.fontSizeElement.value),
              (i.style.fontSize = e.fontSizeElement.value),
              this.context.dialog.updateModal)
            ) {
              var n = this.util.getParentElement(e._mathExp, ".katex");
              n.parentNode.replaceChild(i, n), this.setRange(i, 0, i, 1);
            } else {
              var l = this.getSelectedElements();
              if (1 < l.length) {
                var o = this.util.createElement(l[0].nodeName);
                if ((o.appendChild(i), !this.insertNode(o, null, !0)))
                  return !1;
              } else if (!this.insertNode(i, null, !0)) return !1;
              var s = this.util.createTextNode(this.util.zeroWidthSpace);
              i.parentNode.insertBefore(s, i.nextSibling),
                this.setRange(i, 0, i, 1);
            }
            return (
              (e.focusElement.value = ""),
              (e.fontSizeElement.value = "1em"),
              (e.previewElement.style.fontSize = "1em"),
              !(e.previewElement.innerHTML = "")
            );
          }.bind(this);
          try {
            t() &&
              (this.plugins.dialog.close.call(this), this.history.push(!1));
          } catch (e) {
            this.plugins.dialog.close.call(this);
          } finally {
            this.closeLoading();
          }
          return !1;
        },
        active: function (e) {
          if (e) {
            if (e.getAttribute("data-exp"))
              return (
                this.controllerArray.indexOf(this.context.math.mathController) <
                  0 &&
                  (this.setRange(e, 0, e, 1),
                  this.plugins.math.call_controller.call(this, e)),
                !0
              );
          } else
            -1 <
              this.controllerArray.indexOf(this.context.math.mathController) &&
              this.controllersOff();
          return !1;
        },
        on: function (e) {
          var t, i, n;
          e
            ? (t = this.context.math)._mathExp &&
              ((i = this.util.HTMLDecoder(t._mathExp.getAttribute("data-exp"))),
              (n = t._mathExp.getAttribute("data-font-size") || "1em"),
              (this.context.dialog.updateModal = !0),
              (t.focusElement.value = i),
              (t.fontSizeElement.value = n),
              (t.previewElement.innerHTML = this.plugins.math._renderer.call(
                this,
                i
              )),
              (t.previewElement.style.fontSize = n))
            : this.plugins.math.init.call(this);
        },
        call_controller: function (e) {
          this.context.math._mathExp = e;
          var t = this.context.math.mathController,
            i = this.util.getOffset(e, this.context.element.wysiwygFrame);
          (t.style.top = i.top + e.offsetHeight + 10 + "px"),
            (t.style.left =
              i.left - this.context.element.wysiwygFrame.scrollLeft + "px"),
            (t.style.display = "block");
          var n =
            this.context.element.wysiwygFrame.offsetWidth -
            (t.offsetLeft + t.offsetWidth);
          n < 0
            ? ((t.style.left = t.offsetLeft + n + "px"),
              (t.firstElementChild.style.left = 20 - n + "px"))
            : (t.firstElementChild.style.left = "20px"),
            this.controllersOn(t, e, "math");
        },
        onClick_mathController: function (e) {
          e.stopPropagation();
          var t =
            e.target.getAttribute("data-command") ||
            e.target.parentNode.getAttribute("data-command");
          t &&
            (e.preventDefault(),
            /update/.test(t)
              ? ((this.context.math.focusElement.value = this.util.HTMLDecoder(
                  this.context.math._mathExp.getAttribute("data-exp")
                )),
                this.plugins.dialog.open.call(this, "math", !0))
              : (this.util.removeItem(this.context.math._mathExp),
                (this.context.math._mathExp = null),
                this.focus(),
                this.history.push(!1)),
            this.controllersOff());
        },
        init: function () {
          var e = this.context.math;
          (e.mathController.style.display = "none"),
            (e._mathExp = null),
            (e.focusElement.value = ""),
            (e.previewElement.innerHTML = "");
        },
      },
      k = i("JhlZ"),
      x = i.n(k),
      E = {
        blockquote: {
          name: "blockquote",
          display: "command",
          add: function (e, t) {
            e.context.blockquote = {
              targetButton: t,
              tag: e.util.createElement("BLOCKQUOTE"),
            };
          },
          active: function (e) {
            if (e) {
              if (/blockquote/i.test(e.nodeName))
                return (
                  this.util.addClass(
                    this.context.blockquote.targetButton,
                    "active"
                  ),
                  !0
                );
            } else
              this.util.removeClass(
                this.context.blockquote.targetButton,
                "active"
              );
            return !1;
          },
          action: function () {
            var e = this.util.getParentElement(
              this.getSelectionNode(),
              "blockquote"
            );
            e
              ? this.detachRangeFormatElement(e, null, null, !1, !1)
              : this.applyRangeFormatElement(
                  this.context.blockquote.tag.cloneNode(!1)
                );
          },
        },
        align: {
          name: "align",
          display: "submenu",
          add: function (e, t) {
            var i = e.icons,
              n = e.context;
            n.align = {
              targetButton: t,
              _alignList: null,
              currentAlign: "",
              icons: {
                justify: i.align_justify,
                left: i.align_left,
                right: i.align_right,
                center: i.align_center,
              },
            };
            var l = this.setSubmenu.call(e),
              o = l.querySelector("ul");
            o.addEventListener("click", this.pickup.bind(e)),
              (n.align._alignList = o.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, l),
              (o = l = null);
          },
          setSubmenu: function () {
            var e = this.lang,
              t = this.icons,
              i = this.util.createElement("DIV");
            return (
              (i.className = "ke-submenu ke-list-layer ke-list-align"),
              (i.innerHTML =
                '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="ke-btn-list ke-btn-align" data-command="justifyleft" data-value="left" title="' +
                e.toolbar.alignLeft +
                '"><span class="ke-list-icon">' +
                t.align_left +
                "</span>" +
                e.toolbar.alignLeft +
                '</button></li><li><button type="button" class="ke-btn-list ke-btn-align" data-command="justifycenter" data-value="center" title="' +
                e.toolbar.alignCenter +
                '"><span class="ke-list-icon">' +
                t.align_center +
                "</span>" +
                e.toolbar.alignCenter +
                '</button></li><li><button type="button" class="ke-btn-list ke-btn-align" data-command="justifyright" data-value="right" title="' +
                e.toolbar.alignRight +
                '"><span class="ke-list-icon">' +
                t.align_right +
                "</span>" +
                e.toolbar.alignRight +
                '</button></li><li><button type="button" class="ke-btn-list ke-btn-align" data-command="justifyfull" data-value="justify" title="' +
                e.toolbar.alignJustify +
                '"><span class="ke-list-icon">' +
                t.align_justify +
                "</span>" +
                e.toolbar.alignJustify +
                "</button></li></ul></div>"),
              i
            );
          },
          active: function (e) {
            var t = this.context.align.targetButton,
              i = t.firstElementChild;
            if (e) {
              if (this.util.isFormatElement(e)) {
                var n = e.style.textAlign;
                if (n)
                  return (
                    this.util.changeElement(i, this.context.align.icons[n]),
                    t.setAttribute("data-focus", n),
                    !0
                  );
              }
            } else
              this.util.changeElement(i, this.context.align.icons.left),
                t.removeAttribute("data-focus");
            return !1;
          },
          on: function () {
            var e = this.context.align,
              t = e._alignList,
              i = e.targetButton.getAttribute("data-focus") || "left";
            if (i !== e.currentAlign) {
              for (var n = 0, l = t.length; n < l; n++)
                i === t[n].getAttribute("data-value")
                  ? this.util.addClass(t[n], "active")
                  : this.util.removeClass(t[n], "active");
              e.currentAlign = i;
            }
          },
          pickup: function (e) {
            e.preventDefault(), e.stopPropagation();
            for (var t = e.target, i = null; !i && !/UL/i.test(t.tagName); )
              (i = t.getAttribute("data-value")), (t = t.parentNode);
            if (i) {
              for (
                var n = this.getSelectedElements(), l = 0, o = n.length;
                l < o;
                l++
              )
                this.util.setStyle(n[l], "textAlign", "left" === i ? "" : i);
              (this.effectNode = null),
                this.submenuOff(),
                this.focus(),
                this.history.push(!1);
            }
          },
        },
        font: {
          name: "font",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.font = {
              targetText: t.querySelector(".txt"),
              targetTooltip: t.parentNode.querySelector(".ke-tooltip-text"),
              _fontList: null,
              currentFont: "",
            };
            var n = this.setSubmenu.call(e);
            n
              .querySelector(".ke-list-inner")
              .addEventListener("click", this.pickup.bind(e)),
              (i.font._fontList = n.querySelectorAll("ul li button")),
              e.initMenuTarget(this.name, t, n),
              (n = null);
          },
          setSubmenu: function () {
            var e,
              t,
              i = this.context.option,
              n = this.lang,
              l = this.util.createElement("DIV");
            l.className = "ke-submenu ke-list-layer ke-list-font-family";
            for (
              var o = i.font
                  ? i.font
                  : [
                      "Arial",
                      "Comic Sans MS",
                      "Courier New",
                      "Impact",
                      "Georgia",
                      "tahoma",
                      "Trebuchet MS",
                      "Verdana",
                    ],
                s =
                  '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="default_value ke-btn-list" title="' +
                  n.toolbar.default +
                  '">(' +
                  n.toolbar.default +
                  ")</button></li>",
                a = 0,
                r = o.length;
              a < r;
              a++
            )
              (t = (e = o[a]).split(",")[0]),
                (s +=
                  '<li><button type="button" class="ke-btn-list" data-value="' +
                  e +
                  '" data-txt="' +
                  t +
                  '" title="' +
                  t +
                  '" style="font-family:' +
                  e +
                  ';">' +
                  t +
                  "</button></li>");
            return (s += "</ul></div>"), (l.innerHTML = s), l;
          },
          active: function (e) {
            var t = this.context.font.targetText,
              i = this.context.font.targetTooltip;
            if (e) {
              if (e.style && 0 < e.style.fontFamily.length) {
                var n = e.style.fontFamily.replace(/["']/g, "");
                return this.util.changeTxt(t, n), this.util.changeTxt(i, n), !0;
              }
            } else {
              var l = this.lang.toolbar.font;
              this.util.changeTxt(t, l), this.util.changeTxt(i, l);
            }
            return !1;
          },
          on: function () {
            var e = this.context.font,
              t = e._fontList,
              i = e.targetText.textContent;
            if (i !== e.currentFont) {
              for (var n = 0, l = t.length; n < l; n++)
                i === t[n].getAttribute("data-value")
                  ? this.util.addClass(t[n], "active")
                  : this.util.removeClass(t[n], "active");
              e.currentFont = i;
            }
          },
          pickup: function (e) {
            if (!/^BUTTON$/i.test(e.target.tagName)) return !1;
            e.preventDefault(), e.stopPropagation();
            var t,
              i = e.target.getAttribute("data-value");
            i
              ? (((t = this.util.createElement("SPAN")).style.fontFamily = i),
                this.nodeChange(t, ["font-family"], null, null))
              : this.nodeChange(null, ["font-family"], ["span"], !0),
              this.submenuOff();
          },
        },
        fontSize: {
          name: "fontSize",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.fontSize = {
              targetText: t.querySelector(".txt"),
              _sizeList: null,
              currentSize: "",
            };
            var n = this.setSubmenu.call(e),
              l = n.querySelector("ul");
            l.addEventListener("click", this.pickup.bind(e)),
              (i.fontSize._sizeList = l.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (l = n = null);
          },
          setSubmenu: function () {
            var e = this.context.option,
              t = this.lang,
              i = this.util.createElement("DIV");
            i.className = "ke-submenu ke-list-layer ke-list-font-size";
            for (
              var n,
                l = e.fontSize
                  ? e.fontSize
                  : [
                      8,
                      9,
                      10,
                      11,
                      12,
                      14,
                      16,
                      18,
                      20,
                      22,
                      24,
                      26,
                      28,
                      36,
                      48,
                      72,
                    ],
                o =
                  '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="default_value ke-btn-list" title="' +
                  t.toolbar.default +
                  '">(' +
                  t.toolbar.default +
                  ")</button></li>",
                s = 0,
                a = e.fontSizeUnit,
                r = l.length;
              s < r;
              s++
            )
              o +=
                '<li><button type="button" class="ke-btn-list" data-value="' +
                (n = l[s]) +
                a +
                '" title="' +
                n +
                a +
                '" style="font-size:' +
                n +
                a +
                ';">' +
                n +
                "</button></li>";
            return (o += "</ul></div>"), (i.innerHTML = o), i;
          },
          active: function (e) {
            if (e) {
              if (e.style && 0 < e.style.fontSize.length)
                return (
                  this.util.changeTxt(
                    this.context.fontSize.targetText,
                    e.style.fontSize
                  ),
                  !0
                );
            } else
              this.util.changeTxt(
                this.context.fontSize.targetText,
                this.lang.toolbar.fontSize
              );
            return !1;
          },
          on: function () {
            var e = this.context.fontSize,
              t = e._sizeList,
              i = e.targetText.textContent;
            if (i !== e.currentSize) {
              for (var n = 0, l = t.length; n < l; n++)
                i === t[n].getAttribute("data-value")
                  ? this.util.addClass(t[n], "active")
                  : this.util.removeClass(t[n], "active");
              e.currentSize = i;
            }
          },
          pickup: function (e) {
            if (!/^BUTTON$/i.test(e.target.tagName)) return !1;
            e.preventDefault(), e.stopPropagation();
            var t,
              i = e.target.getAttribute("data-value");
            i
              ? (((t = this.util.createElement("SPAN")).style.fontSize = i),
                this.nodeChange(t, ["font-size"], null, null))
              : this.nodeChange(null, ["font-size"], ["span"], !0),
              this.submenuOff();
          },
        },
        fontColor: o,
        hiliteColor: s,
        horizontalRule: {
          name: "horizontalRule",
          display: "submenu",
          add: function (e, t) {
            var i = this.setSubmenu.call(e);
            i
              .querySelector("ul")
              .addEventListener("click", this.horizontalRulePick.bind(e)),
              e.initMenuTarget(this.name, t, i),
              (i = null);
          },
          setSubmenu: function () {
            var e = this.lang,
              t = this.util.createElement("DIV");
            return (
              (t.className = "ke-submenu ke-list-layer ke-list-line"),
              (t.innerHTML =
                '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="ke-btn-list btn_line" data-command="horizontalRule" data-value="solid" title="' +
                e.toolbar.hr_solid +
                '"><hr style="border-width: 1px 0 0; border-style: solid none none; border-color: black; border-image: initial; height: 1px;" /></button></li><li><button type="button" class="ke-btn-list btn_line" data-command="horizontalRule" data-value="dotted" title="' +
                e.toolbar.hr_dotted +
                '"><hr style="border-width: 1px 0 0; border-style: dotted none none; border-color: black; border-image: initial; height: 1px;" /></button></li><li><button type="button" class="ke-btn-list btn_line" data-command="horizontalRule" data-value="dashed" title="' +
                e.toolbar.hr_dashed +
                '"><hr style="border-width: 1px 0 0; border-style: dashed none none; border-color: black; border-image: initial; height: 1px;" /></button></li></ul></div>'),
              t
            );
          },
          appendHr: function (e) {
            var t = this.util.createElement("HR");
            return (
              (t.className = e),
              this.focus(),
              this.insertComponent(t, !1, !0, !1)
            );
          },
          horizontalRulePick: function (e) {
            e.preventDefault(), e.stopPropagation();
            for (var t, i = e.target, n = null; !n && !/UL/i.test(i.tagName); )
              (n = i.getAttribute("data-value")), (i = i.parentNode);
            !n ||
              ((t = this.plugins.horizontalRule.appendHr.call(
                this,
                "__ke__" + n
              )) &&
                (this.setRange(t, 0, t, 0), this.submenuOff()));
          },
        },
        list: {
          name: "list",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.list = {
              targetButton: t,
              _list: null,
              currentList: "",
              icons: {
                bullets: e.icons.list_bullets,
                number: e.icons.list_number,
              },
            };
            var n = this.setSubmenu.call(e),
              l = n.querySelector("ul");
            l.addEventListener("click", this.pickup.bind(e)),
              (i.list._list = l.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (l = n = null);
          },
          setSubmenu: function () {
            var e = this.lang,
              t = this.util.createElement("DIV");
            return (
              (t.className = "ke-submenu ke-list-layer"),
              (t.innerHTML =
                '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="ke-btn-list ke-tooltip" data-command="OL" title="' +
                e.toolbar.orderList +
                '">' +
                this.icons.list_number +
                '</button></li><li><button type="button" class="ke-btn-list ke-tooltip" data-command="UL" title="' +
                e.toolbar.unorderList +
                '">' +
                this.icons.list_bullets +
                "</button></li></ul></div>"),
              t
            );
          },
          active: function (e) {
            var t = this.context.list.targetButton,
              i = t.firstElementChild,
              n = this.util;
            if (e) {
              if (n.isList(e)) {
                var l = e.nodeName;
                return (
                  t.setAttribute("data-focus", l),
                  n.addClass(t, "active"),
                  /UL/i.test(l)
                    ? n.changeElement(i, this.context.list.icons.bullets)
                    : n.changeElement(i, this.context.list.icons.number),
                  !0
                );
              }
            } else
              t.removeAttribute("data-focus"),
                n.changeElement(i, this.context.list.icons.number),
                n.removeClass(t, "active");
            return !1;
          },
          on: function () {
            var e = this.context.list,
              t = e._list,
              i = e.targetButton.getAttribute("data-focus") || "";
            if (i !== e.currentList) {
              for (var n = 0, l = t.length; n < l; n++)
                i === t[n].getAttribute("data-command")
                  ? this.util.addClass(t[n], "active")
                  : this.util.removeClass(t[n], "active");
              e.currentList = i;
            }
          },
          editList: function (e, t, i) {
            var n = this.getRange(),
              l = t || this.getSelectedElementsAndComponents(!1);
            if (0 === l.length) {
              if (t) return;
              if (
                ((n = this.getRange_addLine(n)),
                0 === (l = this.getSelectedElementsAndComponents(!1)).length)
              )
                return;
            }
            var o = this.util;
            o.sortByDepth(l, !0);
            for (
              var s = l[0],
                a = l[l.length - 1],
                r =
                  (!o.isListCell(s) && !o.isComponent(s)) ||
                  s.previousElementSibling
                    ? s.previousElementSibling
                    : s.parentNode.previousElementSibling,
                c =
                  (!o.isListCell(a) && !o.isComponent(a)) ||
                  a.nextElementSibling
                    ? a.nextElementSibling
                    : a.parentNode.nextElementSibling,
                d = {
                  sc: n.startContainer,
                  so: n.startOffset,
                  ec: n.endContainer,
                  eo: n.endOffset,
                },
                u = !0,
                h = 0,
                g = l.length;
              h < g &&
              "break" !==
                (function (e) {
                  if (
                    !o.isList(
                      o.getRangeFormatElement(
                        l[e],
                        function (t) {
                          return this.getRangeFormatElement(t) && t !== l[e];
                        }.bind(o)
                      )
                    )
                  )
                    return (u = !1), "break";
                })(h);
              h++
            );
            if (
              !u ||
              (r && s.tagName === r.tagName && e === r.tagName.toUpperCase()) ||
              (c && a.tagName === c.tagName && e === c.tagName.toUpperCase())
            ) {
              for (
                var p,
                  m,
                  f,
                  v,
                  _,
                  b,
                  y,
                  w,
                  C,
                  k,
                  x = r ? r.parentNode : r,
                  E = c ? c.parentNode : c,
                  S =
                    ((r = x && !o.isWysiwygDiv(x) && x.nodeName === e ? x : r),
                    (c = E && !o.isWysiwygDiv(E) && E.nodeName === e ? E : c),
                    r && r.tagName === e),
                  N = c && c.tagName === e,
                  T = S ? r : o.createElement(e),
                  L = null,
                  z = null,
                  B = function (e) {
                    return !this.isComponent(e) && !this.isList(e);
                  }.bind(o),
                  A = 0,
                  M = l.length;
                A < M;
                A++
              )
                if (
                  0 !== (f = l[A]).childNodes.length ||
                  o._isIgnoreNodeChange(f)
                ) {
                  if (
                    ((_ = l[A + 1]),
                    (b = f.parentNode),
                    (y = _ ? _.parentNode : null),
                    (v = o.isListCell(f)),
                    (k = o.isRangeFormatElement(b) ? b : null),
                    (w = v && !o.isWysiwygDiv(b) ? b.parentNode : b),
                    (C =
                      v && !o.isWysiwygDiv(b)
                        ? !_ || o.isListCell(w)
                          ? b
                          : b.nextSibling
                        : f.nextSibling),
                    (m = o.createElement("LI")),
                    o.copyFormatAttributes(m, f),
                    o.isComponent(f))
                  ) {
                    var H = /^HR$/i.test(f.nodeName);
                    H || (m.innerHTML = "<br>"),
                      (m.innerHTML += f.outerHTML),
                      H && (m.innerHTML += "<br>");
                  } else for (var I = f.childNodes; I[0]; ) m.appendChild(I[0]);
                  T.appendChild(m),
                    (_ && w === y && !o.isRangeFormatElement(C)) ||
                      ((L = L || T),
                      (S && _ && w === y) ||
                        (_ && o.isList(y) && y === b) ||
                        (T.parentNode !== w && w.insertBefore(T, C))),
                    o.removeItem(f),
                    S && null === z && (z = T.children.length - 1),
                    _ &&
                      (o.getRangeFormatElement(y, B) !==
                        o.getRangeFormatElement(b, B) ||
                        (o.isList(y) &&
                          o.isList(b) &&
                          o.getElementDepth(y) !== o.getElementDepth(b))) &&
                      (T = o.createElement(e)),
                    k && 0 === k.children.length && o.removeItem(k);
                } else o.removeItem(f);
              z && (L = L.children[z]),
                N &&
                  ((p = T.children.length - 1),
                  (T.innerHTML += c.innerHTML),
                  T.children[p],
                  o.removeItem(c));
            } else {
              if (i)
                for (var F = 0, D = l.length; F < D; F++)
                  for (var R = F - 1; 0 <= R; R--)
                    if (l[R].contains(l[F])) {
                      l.splice(F, 1), F--, D--;
                      break;
                    }
              var O,
                P,
                V = o.getRangeFormatElement(s),
                W = V && V.tagName === e,
                U = function (e) {
                  return !this.isComponent(e);
                }.bind(o);
              W || (P = o.createElement(e));
              for (var q, Z, $ = 0, Y = l.length; $ < Y; $++)
                (Z = o.getRangeFormatElement(l[$], U)) &&
                  o.isList(Z) &&
                  (q
                    ? q !== Z
                      ? (i && o.isListCell(Z.parentNode)
                          ? this.plugins.list._detachNested.call(this, O.f)
                          : this.detachRangeFormatElement(
                              O.f[0].parentNode,
                              O.f,
                              P,
                              !1,
                              !0
                            ),
                        (Z = l[$].parentNode),
                        W || (P = o.createElement(e)),
                        (O = {
                          r: (q = Z),
                          f: [o.getParentElement(l[$], "LI")],
                        }))
                      : O.f.push(o.getParentElement(l[$], "LI"))
                    : (O = { r: (q = Z), f: [o.getParentElement(l[$], "LI")] }),
                  $ === Y - 1 &&
                    (i && o.isListCell(Z.parentNode)
                      ? this.plugins.list._detachNested.call(this, O.f)
                      : this.detachRangeFormatElement(
                          O.f[0].parentNode,
                          O.f,
                          P,
                          !1,
                          !0
                        )));
            }
            return (this.effectNode = null), d;
          },
          _detachNested: function (e) {
            for (
              var t = e[0],
                i = e[e.length - 1],
                n = i.nextElementSibling,
                l = t.parentNode,
                o = l.parentNode.nextElementSibling,
                s = l.parentNode.parentNode,
                a = 0,
                r = e.length;
              a < r;
              a++
            )
              s.insertBefore(e[a], o);
            if (n && 0 < l.children.length) {
              for (
                var c = l.cloneNode(!1),
                  d = l.childNodes,
                  u = this.util.getPositionIndex(n);
                d[u];

              )
                c.appendChild(d[u]);
              i.appendChild(c);
            }
            0 === l.children.length && this.util.removeItem(l),
              this.util.mergeSameTags(s);
            var h = this.util.getEdgeChildNodes(t, i);
            return { cc: t.parentNode, sc: h.sc, ec: h.ec };
          },
          editInsideList: function (e, t) {
            var i = (t =
              t ||
              this.getSelectedElements().filter(
                function (e) {
                  return this.isListCell(e);
                }.bind(this.util)
              )).length;
            if (
              0 === i ||
              (!e &&
                !this.util.isListCell(t[0].previousElementSibling) &&
                !this.util.isListCell(t[i - 1].nextElementSibling))
            )
              return { sc: t[0], so: 0, ec: t[i - 1], eo: 1 };
            var n = t[0].parentNode,
              l = t[i - 1],
              o = null;
            if (e) {
              if (
                n !== l.parentNode &&
                this.util.isList(l.parentNode.parentNode) &&
                l.nextElementSibling
              )
                for (l = l.nextElementSibling; l; )
                  t.push(l), (l = l.nextElementSibling);
              o = this.plugins.list.editList.call(
                this,
                n.nodeName.toUpperCase(),
                t,
                !0
              );
            } else {
              for (
                var s,
                  a = this.util.createElement(n.nodeName),
                  r = t[0].previousElementSibling,
                  c = l.nextElementSibling,
                  d = { s: null, e: null, sl: n, el: n },
                  u = 0,
                  h = i;
                u < h;
                u++
              )
                (s = t[u]).parentNode !== n &&
                  (this.plugins.list._insiedList.call(this, n, a, r, c, d),
                  (n = s.parentNode),
                  (a = this.util.createElement(n.nodeName))),
                  (r = s.previousElementSibling),
                  (c = s.nextElementSibling),
                  a.appendChild(s);
              this.plugins.list._insiedList.call(this, n, a, r, c, d);
              var g = this.util.getNodeFromPath(d.s, d.sl),
                p = this.util.getNodeFromPath(d.e, d.el);
              o = { sc: g, so: 0, ec: p, eo: p.textContent.length };
            }
            return o;
          },
          _insiedList: function (e, t, i, n, l) {
            var o,
              s = !1;
            if (i && t.tagName === i.tagName) {
              for (var a = t.children; a[0]; ) i.appendChild(a[0]);
              (t = i), (s = !0);
            }
            if (n && t.tagName === n.tagName) {
              for (var r = n.children; r[0]; ) t.appendChild(r[0]);
              var c = n.nextElementSibling;
              n.parentNode.removeChild(n), (n = c);
            }
            return (
              s ||
                (this.util.isListCell(i) && ((e = i), (n = null)),
                e.insertBefore(t, n),
                l.s ||
                  ((l.s = this.util.getNodePath(
                    t.firstElementChild.firstChild,
                    e,
                    null
                  )),
                  (l.sl = e)),
                (o = e.contains(l.sl) ? this.util.getNodePath(l.sl, e) : null),
                (l.e = this.util.getNodePath(
                  t.lastElementChild.firstChild,
                  e,
                  null
                )),
                (l.el = e),
                this.util.mergeSameTags(e, [l.s, l.e, o], !1),
                this.util.mergeNestedTags(e),
                o && (l.sl = this.util.getNodeFromPath(o, e))),
              t
            );
          },
          pickup: function (e) {
            e.preventDefault(), e.stopPropagation();
            for (var t, i = e.target, n = ""; !n && !/^UL$/i.test(i.tagName); )
              (n = i.getAttribute("data-command")), (i = i.parentNode);
            n &&
              ((t = this.plugins.list.editList.call(this, n, null, !1)) &&
                this.setRange(t.sc, t.so, t.ec, t.eo),
              this.submenuOff(),
              this.history.push(!1));
          },
        },
        table: {
          name: "table",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.table = {
              _element: null,
              _tdElement: null,
              _trElement: null,
              _trElements: null,
              _tableXY: [],
              _maxWidth: !0,
              _fixedColumn: !1,
              cellControllerTop:
                "top" === i.options.tableCellControllerPosition,
              resizeText: null,
              headerButton: null,
              mergeButton: null,
              splitButton: null,
              splitMenu: null,
              maxText: e.lang.controller.maxSize,
              minText: e.lang.controller.minSize,
              _physical_cellCnt: 0,
              _logical_cellCnt: 0,
              _rowCnt: 0,
              _rowIndex: 0,
              _physical_cellIndex: 0,
              _logical_cellIndex: 0,
              _current_colSpan: 0,
              _current_rowSpan: 0,
              icons: {
                expansion: e.icons.expansion,
                reduction: e.icons.reduction,
              },
            };
            var n = this.setSubmenu.call(e),
              l = n.querySelector(".ke-controller-table-picker");
            (i.table.tableHighlight = n.querySelector(
              ".ke-table-size-highlighted"
            )),
              (i.table.tableUnHighlight = n.querySelector(
                ".ke-table-size-unhighlighted"
              )),
              (i.table.tableDisplay = n.querySelector(
                ".ke-table-size-display"
              ));
            var o = this.setController_table.call(e);
            (i.table.tableController = o),
              (i.table.resizeButton = o.querySelector("._ke_table_resize")),
              (i.table.resizeText = o.querySelector(
                "._ke_table_resize > span > span"
              )),
              (i.table.columnFixedButton = o.querySelector(
                "._ke_table_fixed_column"
              )),
              (i.table.headerButton = o.querySelector("._ke_table_header")),
              o.addEventListener("mousedown", e.eventStop);
            var s = this.setController_tableEditor.call(
              e,
              i.table.cellControllerTop
            );
            (i.table.resizeDiv = s),
              (i.table.splitMenu = s.querySelector(".ke-btn-group-sub")),
              (i.table.mergeButton = s.querySelector(
                "._ke_table_merge_button"
              )),
              (i.table.splitButton = s.querySelector(
                "._ke_table_split_button"
              )),
              (i.table.insertRowAboveButton = s.querySelector(
                "._ke_table_insert_row_a"
              )),
              (i.table.insertRowBelowButton = s.querySelector(
                "._ke_table_insert_row_b"
              )),
              s.addEventListener("mousedown", e.eventStop),
              l.addEventListener(
                "mousemove",
                this.onMouseMove_tablePicker.bind(e)
              ),
              l.addEventListener("click", this.appendTable.bind(e)),
              s.addEventListener("click", this.onClick_tableController.bind(e)),
              o.addEventListener("click", this.onClick_tableController.bind(e)),
              e.initMenuTarget(this.name, t, n),
              i.element.relative.appendChild(s),
              i.element.relative.appendChild(o),
              (o = s = l = n = null);
          },
          setSubmenu: function () {
            var e = this.util.createElement("DIV");
            return (
              (e.className = "ke-submenu ke-selector-table"),
              (e.innerHTML =
                '<div class="ke-table-size"><div class="ke-table-size-picker ke-controller-table-picker"></div><div class="ke-table-size-highlighted"></div><div class="ke-table-size-unhighlighted"></div></div><div class="ke-table-size-display">1 x 1</div>'),
              e
            );
          },
          setController_table: function () {
            var e = this.lang,
              t = this.icons,
              i = this.util.createElement("DIV");
            return (
              (i.className = "ke-controller ke-controller-table"),
              (i.innerHTML =
                '<div><div class="ke-btn-group"><button type="button" data-command="resize" class="ke-btn ke-tooltip _ke_table_resize">' +
                t.expansion +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                e.controller.maxSize +
                '</span></span></button><button type="button" data-command="layout" class="ke-btn ke-tooltip _ke_table_fixed_column">' +
                t.fixed_column_width +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                e.controller.fixedColumnWidth +
                '</span></span></button><button type="button" data-command="header" class="ke-btn ke-tooltip _ke_table_header">' +
                t.table_header +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                e.controller.tableHeader +
                '</span></span></button><button type="button" data-command="remove" class="ke-btn ke-tooltip">' +
                t.delete +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                e.controller.remove +
                "</span></span></button></div></div>"),
              i
            );
          },
          setController_tableEditor: function (e) {
            var t = this.lang,
              i = this.icons,
              n = this.util.createElement("DIV");
            return (
              (n.className = "ke-controller ke-controller-table-cell"),
              (n.innerHTML =
                (e ? "" : '<div class="ke-arrow ke-arrow-up"></div>') +
                '<div class="ke-btn-group"><button type="button" data-command="insert" data-value="row" data-option="up" class="ke-btn ke-tooltip _ke_table_insert_row_a">' +
                i.insert_row_above +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.insertRowAbove +
                '</span></span></button><button type="button" data-command="insert" data-value="row" data-option="down" class="ke-btn ke-tooltip _ke_table_insert_row_b">' +
                i.insert_row_below +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.insertRowBelow +
                '</span></span></button><button type="button" data-command="delete" data-value="row" class="ke-btn ke-tooltip">' +
                i.delete_row +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.deleteRow +
                '</span></span></button><button type="button" data-command="merge" class="_ke_table_merge_button ke-btn ke-tooltip" disabled>' +
                i.merge_cell +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.mergeCells +
                '</span></span></button></div><div class="ke-btn-group" style="padding-top: 0;"><button type="button" data-command="insert" data-value="cell" data-option="left" class="ke-btn ke-tooltip">' +
                i.insert_column_left +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.insertColumnBefore +
                '</span></span></button><button type="button" data-command="insert" data-value="cell" data-option="right" class="ke-btn ke-tooltip">' +
                i.insert_column_right +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.insertColumnAfter +
                '</span></span></button><button type="button" data-command="delete" data-value="cell" class="ke-btn ke-tooltip">' +
                i.delete_column +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.deleteColumn +
                '</span></span></button><button type="button" data-command="onsplit" class="_ke_table_split_button ke-btn ke-tooltip">' +
                i.split_cell +
                '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                t.controller.splitCells +
                '</span></span></button><div class="ke-btn-group-sub kothing-editor-common ke-list-layer"><div class="ke-list-inner"><ul class="ke-list-basic"><li class="ke-btn-list" data-command="split" data-value="vertical" style="line-height:32px;" title="' +
                t.controller.VerticalSplit +
                '">' +
                t.controller.VerticalSplit +
                '</li><li class="ke-btn-list" data-command="split" data-value="horizontal" style="line-height:32px;" title="' +
                t.controller.HorizontalSplit +
                '">' +
                t.controller.HorizontalSplit +
                "</li></ul></div></div></div>"),
              n
            );
          },
          appendTable: function () {
            for (
              var e,
                t = this.util.createElement("TABLE"),
                i = this.plugins.table.createCells,
                n = this.context.table._tableXY[0],
                l = this.context.table._tableXY[1],
                o = "<tbody>";
              0 < l;

            )
              (o += "<tr>" + i.call(this, "td", n) + "</tr>"), --l;
            (o += "</tbody>"),
              (t.innerHTML = o),
              this.insertComponent(t, !1, !0, !1) &&
                ((e = t.querySelector("td div")),
                this.setRange(e, 0, e, 0),
                this.plugins.table.reset_table_picker.call(this));
          },
          createCells: function (e, t, i) {
            if (((e = e.toLowerCase()), i)) {
              var n = this.util.createElement(e);
              return (n.innerHTML = "<div><br></div>"), n;
            }
            for (var l = ""; 0 < t; )
              (l += "<" + e + "><div><br></div></" + e + ">"), t--;
            return l;
          },
          onMouseMove_tablePicker: function (e) {
            e.stopPropagation();
            var t = (t = this._w.Math.ceil(e.offsetX / 18)) < 1 ? 1 : t,
              i = (i = this._w.Math.ceil(e.offsetY / 18)) < 1 ? 1 : i;
            (this.context.table.tableHighlight.style.width = t + "em"),
              (this.context.table.tableHighlight.style.height = i + "em"),
              (this.context.table.tableUnHighlight.style.width = "10em"),
              (this.context.table.tableUnHighlight.style.height = "10em"),
              this.util.changeTxt(
                this.context.table.tableDisplay,
                t + " x " + i
              ),
              (this.context.table._tableXY = [t, i]);
          },
          reset_table_picker: function () {
            var e, t;
            this.context.table.tableHighlight &&
              ((e = this.context.table.tableHighlight.style),
              (t = this.context.table.tableUnHighlight.style),
              (e.width = "1em"),
              (e.height = "1em"),
              (t.width = "10em"),
              (t.height = "10em"),
              this.util.changeTxt(this.context.table.tableDisplay, "1 x 1"),
              this.submenuOff());
          },
          init: function () {
            var e = this.context.table,
              t = this.plugins.table;
            if ((t._removeEvents.call(this), t._selectedTable))
              for (
                var i = t._selectedTable.querySelectorAll(
                    ".ke-table-selected-cell"
                  ),
                  n = 0,
                  l = i.length;
                n < l;
                n++
              )
                this.util.removeClass(i[n], "ke-table-selected-cell");
            t._toggleEditor.call(this, !0),
              (e._element = null),
              (e._tdElement = null),
              (e._trElement = null),
              (e._trElements = null),
              (e._tableXY = []),
              (e._maxWidth = !0),
              (e._fixedColumn = !1),
              (e._physical_cellCnt = 0),
              (e._logical_cellCnt = 0),
              (e._rowCnt = 0),
              (e._rowIndex = 0),
              (e._physical_cellIndex = 0),
              (e._logical_cellIndex = 0),
              (e._current_colSpan = 0),
              (e._current_rowSpan = 0),
              (t._shift = !1),
              (t._selectedCells = null),
              (t._selectedTable = null),
              (t._ref = null),
              (t._fixedCell = null),
              (t._selectedCell = null),
              (t._fixedCellName = null);
          },
          call_controller_tableEdit: function (e) {
            var t = this.plugins.table,
              i = this.context.table;
            if (!this.getSelection().isCollapsed && !t._selectedCell)
              return (
                this.controllersOff(),
                void this.util.removeClass(e, "ke-table-selected-cell")
              );
            var n =
              i._element ||
              this.plugins.table._selectedTable ||
              this.util.getParentElement(e, "TABLE");
            t.setPositionControllerTop.call(this, n),
              (i._maxWidth =
                this.util.hasClass(n, "ke-table-size-100") ||
                "100%" === n.style.width ||
                (!n.style.width &&
                  !this.util.hasClass(n, "ke-table-size-auto"))),
              (i._fixedColumn =
                this.util.hasClass(n, "ke-table-layout-fixed") ||
                "fixed" === n.style.tableLayout),
              t.setTableStyle.call(
                this,
                i._maxWidth ? "width|column" : "width"
              ),
              t.setPositionControllerDiv.call(this, e, t._shift),
              t._shift ||
                this.controllersOn(
                  i.resizeDiv,
                  i.tableController,
                  t.init.bind(this),
                  e,
                  "table"
                );
          },
          setPositionControllerTop: function (e) {
            var t = this.context.table.tableController,
              i = this.util.getOffset(e, this.context.element.wysiwygFrame);
            (t.style.left = i.left + "px"),
              (t.style.display = "block"),
              (t.style.top = i.top - t.offsetHeight - 2 + "px");
          },
          setPositionControllerDiv: function (e, t) {
            var i,
              n,
              l,
              o = this.context.table,
              s = o.resizeDiv;
            this.plugins.table.setCellInfo.call(this, e, t),
              (s.style.visibility = "hidden"),
              (s.style.display = "block"),
              o.cellControllerTop
                ? ((i = this.util.getOffset(
                    o._element,
                    this.context.element.wysiwygFrame
                  )),
                  (s.style.top = i.top - s.offsetHeight - 2 + "px"),
                  (s.style.left =
                    i.left + o.tableController.offsetWidth + "px"))
                : ((n = this.util.getOffset(
                    e,
                    this.context.element.wysiwygFrame
                  )),
                  (s.style.left =
                    n.left -
                    this.context.element.wysiwygFrame.scrollLeft +
                    "px"),
                  (s.style.top = n.top + e.offsetHeight + 12 + "px"),
                  (l =
                    this.context.element.wysiwygFrame.offsetWidth -
                    (s.offsetLeft + s.offsetWidth)) < 0
                    ? ((s.style.left = s.offsetLeft + l + "px"),
                      (s.firstElementChild.style.left = 20 - l + "px"))
                    : (s.firstElementChild.style.left = "20px")),
              (s.style.visibility = "");
          },
          setCellInfo: function (e, t) {
            var i = this.context.table,
              n = (i._element =
                this.plugins.table._selectedTable ||
                this.util.getParentElement(e, "TABLE"));
            if (
              (/THEAD/i.test(n.firstElementChild.nodeName)
                ? this.util.addClass(i.headerButton, "active")
                : this.util.removeClass(i.headerButton, "active"),
              t || 0 === i._physical_cellCnt)
            ) {
              i._tdElement !== e &&
                ((i._tdElement = e), (i._trElement = e.parentNode));
              for (
                var l = (i._trElements = n.rows),
                  o = e.cellIndex,
                  s = 0,
                  a = 0,
                  r = l[0].cells,
                  c = l[0].cells.length;
                a < c;
                a++
              )
                s += r[a].colSpan;
              var d = (i._rowIndex = i._trElement.rowIndex);
              (i._rowCnt = l.length),
                (i._physical_cellCnt = i._trElement.cells.length),
                (i._logical_cellCnt = s),
                (i._physical_cellIndex = o),
                (i._current_colSpan = i._tdElement.colSpan - 1),
                (i._current_rowSpan = i._trElement.cells[o].rowSpan - 1);
              for (var u, h, g = [], p = [], m = 0; m <= d; m++) {
                for (
                  var f, v, _, b, y = (h = 0), w = (u = l[m].cells).length;
                  y < w;
                  y++
                ) {
                  if (
                    ((v = (f = u[y]).colSpan - 1),
                    (_ = f.rowSpan - 1),
                    (b = y + h),
                    0 < p.length)
                  )
                    for (var C, k = 0; k < p.length; k++)
                      (C = p[k]).row > m ||
                        (b >= C.index
                          ? ((h += C.cs),
                            (b += C.cs),
                            --C.rs,
                            (C.row = m + 1),
                            C.rs < 1 && (p.splice(k, 1), k--))
                          : y === w - 1 &&
                            (--C.rs,
                            (C.row = m + 1),
                            C.rs < 1 && (p.splice(k, 1), k--)));
                  if (m === d && y === o) {
                    i._logical_cellIndex = b;
                    break;
                  }
                  0 < _ && g.push({ index: b, cs: 1 + v, rs: _, row: -1 }),
                    (h += v);
                }
                (p = p.concat(g).sort(function (e, t) {
                  return e.index - t.index;
                })),
                  (g = []);
              }
              p = g = null;
            }
          },
          editTable: function (e, t) {
            var i = this.plugins.table,
              n = this.context.table,
              l = n._element,
              o = "row" === e;
            if (o) {
              var s = n._trElement.parentNode;
              if (/^THEAD$/i.test(s.nodeName)) {
                if ("up" === t) return;
                if (
                  !s.nextElementSibling ||
                  !/^TBODY$/i.test(s.nextElementSibling.nodeName)
                )
                  return void (l.innerHTML +=
                    "<tbody><tr>" +
                    i.createCells.call(this, "td", n._logical_cellCnt, !1) +
                    "</tr></tbody>");
              }
            }
            if (i._ref) {
              var a = n._tdElement,
                r = i._selectedCells;
              if (o)
                if (t)
                  i.setCellInfo.call(
                    this,
                    "up" === t ? r[0] : r[r.length - 1],
                    !0
                  ),
                    i.editRow.call(this, t, a);
                else {
                  for (
                    var c, d = r[0].parentNode, u = [r[0]], h = 1, g = r.length;
                    h < g;
                    h++
                  )
                    d !== (c = r[h]).parentNode &&
                      (u.push(c), (d = c.parentNode));
                  for (var p = 0, m = u.length; p < m; p++)
                    i.setCellInfo.call(this, u[p], !0), i.editRow.call(this, t);
                }
              else {
                var f = r[0].parentNode;
                if (t) {
                  for (var v = null, _ = 0, b = r.length - 1; _ < b; _++)
                    if (f !== r[_ + 1].parentNode) {
                      v = r[_];
                      break;
                    }
                  i.setCellInfo.call(this, ("left" !== t && v) || r[0], !0),
                    i.editCell.call(this, t, a);
                } else {
                  for (
                    var y, w = [r[0]], C = 1, k = r.length;
                    C < k && f === (y = r[C]).parentNode;
                    C++
                  )
                    w.push(y);
                  for (var x = 0, E = w.length; x < E; x++)
                    i.setCellInfo.call(this, w[x], !0),
                      i.editCell.call(this, t);
                }
              }
              t || i.init.call(this);
            } else i[o ? "editRow" : "editCell"].call(this, t);
            if (!t) {
              for (var S = l.children, N = 0; N < S.length; N++)
                0 === S[N].children.length && (this.util.removeItem(S[N]), N--);
              0 === l.children.length && this.util.removeItem(l);
            }
          },
          editRow: function (e, t) {
            for (
              var i,
                n = this.context.table,
                l = !e,
                o = "up" === e,
                s = n._rowIndex,
                a = l || o ? s : s + n._current_rowSpan + 1,
                r = l ? -1 : 1,
                c = n._trElements,
                d = n._logical_cellCnt,
                u = 0,
                h = s + (l ? -1 : 0);
              u <= h;
              u++
            ) {
              if (0 === (i = c[u].cells).length) return;
              for (var g, p, m = 0, f = i.length; m < f; m++)
                (g = i[m].rowSpan),
                  (p = i[m].colSpan),
                  (g < 2 && p < 2) ||
                    (a < g + u && u < a && ((i[m].rowSpan = g + r), (d -= p)));
            }
            if (l) {
              var v = c[s + 1];
              if (v) {
                for (
                  var _, b, y = [], w = 0, C = 0, k = (x = c[s].cells).length;
                  C < k;
                  C++
                )
                  (b = C + w),
                    (w += (_ = x[C]).colSpan - 1),
                    1 < _.rowSpan &&
                      (--_.rowSpan,
                      y.push({ cell: _.cloneNode(!1), index: b }));
                if (0 < y.length) {
                  for (
                    var x,
                      E,
                      S,
                      N = y.shift(),
                      T = ((w = 0), 0),
                      L = (x = v.cells).length;
                    T < L &&
                    ((S = T + w),
                    (w += (E = x[T]).colSpan - 1),
                    !(S >= N.index) ||
                      (T--,
                      w--,
                      (w += N.cell.colSpan - 1),
                      v.insertBefore(N.cell, E),
                      (N = y.shift())));
                    T++
                  );
                  if (N) {
                    v.appendChild(N.cell);
                    for (var z = 0, B = y.length; z < B; z++)
                      v.appendChild(y[z].cell);
                  }
                }
              }
              n._element.deleteRow(a);
            } else
              n._element.insertRow(
                a
              ).innerHTML = this.plugins.table.createCells.call(
                this,
                "td",
                d,
                !1
              );
            l
              ? this.controllersOff()
              : this.plugins.table.setPositionControllerDiv.call(
                  this,
                  t || n._tdElement,
                  !0
                );
          },
          editCell: function (e, t) {
            for (
              var i,
                n,
                l,
                o,
                s,
                a,
                r = this.context.table,
                c = this.util,
                d = !e,
                u = "left" === e,
                h = r._current_colSpan,
                g =
                  d || u ? r._logical_cellIndex : r._logical_cellIndex + h + 1,
                p = r._trElements,
                m = [],
                f = [],
                v = 0,
                _ = [],
                b = [],
                y = 0,
                w = r._rowCnt;
              y < w;
              y++
            ) {
              (n = g), (s = !1);
              for (
                var C, k, x, E, S = (a = 0), N = (l = (i = p[y]).cells).length;
                S < N && (C = l[S]);
                S++
              )
                if (((k = C.rowSpan - 1), (x = C.colSpan - 1), d)) {
                  if (((E = S + a), 0 < f.length))
                    for (var T, L = !l[S + 1], z = 0; z < f.length; z++)
                      (T = f[z]).row > y ||
                        (E >= T.index
                          ? ((E = S + (a += T.cs)),
                            --T.rs,
                            (T.row = y + 1),
                            T.rs < 1 && (f.splice(z, 1), z--))
                          : L &&
                            (--T.rs,
                            (T.row = y + 1),
                            T.rs < 1 && (f.splice(z, 1), z--)));
                  0 < k && m.push({ rs: k, cs: 1 + x, index: E, row: -1 }),
                    n <= E && E + x <= n + h
                      ? _.push(C)
                      : E <= n + h && n <= E + x
                      ? (C.colSpan -= c.getOverlapRangeAtIndex(
                          g,
                          g + h,
                          E,
                          E + x
                        ))
                      : 0 < k &&
                        (E < n || n + h < E + x) &&
                        b.push({ cell: C, i: y, rs: y + k }),
                    (a += x);
                } else {
                  if (n <= S) break;
                  if (0 < x) {
                    if (v < 1 && n <= x + S) {
                      (C.colSpan += 1), (n = null), (v = 1 + k);
                      break;
                    }
                    n -= x;
                  }
                  if (!s) {
                    for (var B, A = 0; A < f.length; A++)
                      (n -= (B = f[A]).cs),
                        --B.rs,
                        B.rs < 1 && (f.splice(A, 1), A--);
                    s = !0;
                  }
                }
              if (
                ((f = f.concat(m).sort(function (e, t) {
                  return e.index - t.index;
                })),
                (m = []),
                !d)
              ) {
                if (0 < v) {
                  --v;
                  continue;
                }
                null !== n &&
                  0 < l.length &&
                  ((o = this.plugins.table.createCells.call(
                    this,
                    l[0].nodeName,
                    0,
                    !0
                  )),
                  i.insertBefore(o, l[n]));
              }
            }
            if (d) {
              for (var M, H, I, F = 0, D = _.length; F < D; F++)
                (I = _[F].parentNode),
                  c.removeItem(_[F]),
                  0 === I.cells.length &&
                    ((M = M || c.getArrayIndex(p, I)),
                    (H = c.getArrayIndex(p, I)),
                    c.removeItem(I));
              for (var R, O = 0, P = b.length; O < P; O++)
                (R = b[O]).cell.rowSpan = c.getOverlapRangeAtIndex(
                  M,
                  H,
                  R.i,
                  R.rs
                );
              this.controllersOff();
            } else
              this.plugins.table.setPositionControllerDiv.call(
                this,
                t || r._tdElement,
                !0
              );
          },
          _closeSplitMenu: null,
          openSplitMenu: function () {
            this.util.addClass(this.context.table.splitButton, "on"),
              (this.context.table.splitMenu.style.display = "inline-table"),
              (this.plugins.table._closeSplitMenu = function () {
                this.util.removeClass(this.context.table.splitButton, "on"),
                  (this.context.table.splitMenu.style.display = "none"),
                  this.removeDocEvent(
                    "mousedown",
                    this.plugins.table._closeSplitMenu
                  ),
                  (this.plugins.table._closeSplitMenu = null);
              }.bind(this)),
              this.addDocEvent("mousedown", this.plugins.table._closeSplitMenu);
          },
          splitCells: function (e) {
            var t = this.util,
              i = "vertical" === e,
              n = this.context.table,
              l = n._tdElement,
              o = n._trElements,
              s = n._trElement,
              a = n._logical_cellIndex,
              r = n._rowIndex,
              c = this.plugins.table.createCells.call(this, l.nodeName, 0, !0);
            if (i) {
              var d = l.colSpan;
              if (((c.rowSpan = l.rowSpan), 1 < d))
                (c.colSpan = this._w.Math.floor(d / 2)),
                  (l.colSpan = d - c.colSpan),
                  s.insertBefore(c, l.nextElementSibling);
              else {
                for (
                  var u, h, g = [], p = [], m = 0, f = n._rowCnt;
                  m < f;
                  m++
                ) {
                  for (
                    var v, _, b, y, w = (h = 0), C = (u = o[m].cells).length;
                    w < C;
                    w++
                  ) {
                    if (
                      ((_ = (v = u[w]).colSpan - 1),
                      (b = v.rowSpan - 1),
                      (y = w + h),
                      0 < p.length)
                    )
                      for (var k, x = 0; x < p.length; x++)
                        (k = p[x]).row > m ||
                          (y >= k.index
                            ? ((h += k.cs),
                              (y += k.cs),
                              --k.rs,
                              (k.row = m + 1),
                              k.rs < 1 && (p.splice(x, 1), x--))
                            : w === C - 1 &&
                              (--k.rs,
                              (k.row = m + 1),
                              k.rs < 1 && (p.splice(x, 1), x--)));
                    if (
                      (y <= a &&
                        0 < b &&
                        g.push({ index: y, cs: 1 + _, rs: b, row: -1 }),
                      v !== l && y <= a && a + d - 1 <= y + _)
                    ) {
                      v.colSpan += 1;
                      break;
                    }
                    if (a < y) break;
                    h += _;
                  }
                  (p = p.concat(g).sort(function (e, t) {
                    return e.index - t.index;
                  })),
                    (g = []);
                }
                s.insertBefore(c, l.nextElementSibling);
              }
            } else {
              var E = l.rowSpan;
              if (((c.colSpan = l.colSpan), 1 < E)) {
                c.rowSpan = this._w.Math.floor(E / 2);
                for (
                  var S,
                    N,
                    T = E - c.rowSpan,
                    L = [],
                    z = t.getArrayIndex(o, s) + T,
                    B = 0;
                  B < z;
                  B++
                )
                  for (
                    var A, M, H, I = (N = 0), F = (S = o[B].cells).length;
                    I < F && !(a <= (H = I + N));
                    I++
                  )
                    0 < (M = (A = S[I]).rowSpan - 1) &&
                      z <= M + B &&
                      H < a &&
                      L.push({ index: H, cs: A.colSpan }),
                      (N += A.colSpan - 1);
                for (
                  var D,
                    R,
                    O,
                    P = o[z],
                    V = P.cells,
                    W = L.shift(),
                    U = 0,
                    q = V.length,
                    Z = 0;
                  U < q;
                  U++
                ) {
                  if (
                    ((O = U + Z + (R = (D = V[U]).colSpan - 1) + 1),
                    W &&
                      O >= W.index &&
                      ((Z += W.cs), (O += W.cs), (W = L.shift())),
                    a <= O || U === q - 1)
                  ) {
                    P.insertBefore(c, D.nextElementSibling);
                    break;
                  }
                  Z += R;
                }
                l.rowSpan = T;
              } else {
                c.rowSpan = l.rowSpan;
                var $ = t.createElement("TR");
                $.appendChild(c);
                for (var Y, K = 0; K < r; K++) {
                  if (0 === (Y = o[K].cells).length) return;
                  for (var X = 0, j = Y.length; X < j; X++)
                    K + Y[X].rowSpan - 1 >= r && (Y[X].rowSpan += 1);
                }
                for (
                  var G = n._physical_cellIndex,
                    J = s.cells,
                    Q = 0,
                    ee = J.length;
                  Q < ee;
                  Q++
                )
                  Q !== G && (J[Q].rowSpan += 1);
                s.parentNode.insertBefore($, s.nextElementSibling);
              }
            }
            this.focusEdge(l),
              this.plugins.table.setPositionControllerDiv.call(this, l, !0);
          },
          mergeCells: function () {
            for (
              var e,
                t,
                i = this.plugins.table,
                n = this.context.table,
                l = this.util,
                o = i._ref,
                s = i._selectedCells,
                a = s[0],
                r = null,
                c = null,
                d = o.ce - o.cs + 1,
                u = o.re - o.rs + 1,
                h = "",
                g = null,
                p = 1,
                m = s.length;
              p < m;
              p++
            ) {
              g !== (e = s[p]).parentNode && (g = e.parentNode);
              for (var f = 0, v = (t = e.children).length; f < v; f++)
                l.isFormatElement(t[f]) &&
                  l.onlyZeroWidthSpace(t[f].textContent) &&
                  l.removeItem(t[f]);
              (h += e.innerHTML),
                l.removeItem(e),
                0 === g.cells.length && (r ? (c = g) : (r = g), --u);
            }
            if (r) {
              for (
                var _,
                  b = n._trElements,
                  y = l.getArrayIndex(b, r),
                  w = l.getArrayIndex(b, c || r),
                  C = [],
                  k = 0;
                k <= w;
                k++
              )
                if (0 !== (_ = b[k].cells).length)
                  for (var x, E, S = 0, N = _.length; S < N; S++)
                    0 < (E = (x = _[S]).rowSpan - 1) &&
                      y <= k + E &&
                      (x.rowSpan -= l.getOverlapRangeAtIndex(y, w, k, k + E));
                else C.push(b[k]);
              for (var T = 0, L = C.length; T < L; T++) l.removeItem(C[T]);
            }
            (a.innerHTML += h),
              (a.colSpan = d),
              (a.rowSpan = u),
              this.controllersOff(),
              i.setActiveButton.call(this, !0, !1),
              i.call_controller_tableEdit.call(this, a),
              l.addClass(a, "ke-table-selected-cell"),
              this.focusEdge(a);
          },
          toggleHeader: function () {
            var e,
              t = this.util,
              i = this.context.table.headerButton,
              n = t.hasClass(i, "active"),
              l = this.context.table._element;
            n
              ? t.removeItem(l.querySelector("thead"))
              : (((e = t.createElement("THEAD")).innerHTML =
                  "<tr>" +
                  this.plugins.table.createCells.call(
                    this,
                    "th",
                    this.context.table._logical_cellCnt,
                    !1
                  ) +
                  "</tr>"),
                l.insertBefore(e, l.firstElementChild)),
              t.toggleClass(i, "active"),
              /TH/i.test(this.context.table._tdElement.nodeName)
                ? this.controllersOff()
                : this.plugins.table.setPositionControllerDiv.call(
                    this,
                    this.context.table._tdElement,
                    !1
                  );
          },
          setTableStyle: function (e) {
            var t,
              i,
              n,
              l,
              o = this.context.table,
              s = o._element;
            -1 < e.indexOf("width") &&
              ((t = o.resizeButton.firstElementChild),
              (i = o.resizeText),
              o._maxWidth
                ? ((n = o.icons.reduction),
                  (l = o.minText),
                  (o.columnFixedButton.style.display = "block"),
                  this.util.removeClass(s, "ke-table-size-auto"),
                  this.util.addClass(s, "ke-table-size-100"))
                : ((n = o.icons.expansion),
                  (l = o.maxText),
                  (o.columnFixedButton.style.display = "none"),
                  this.util.removeClass(s, "ke-table-size-100"),
                  this.util.addClass(s, "ke-table-size-auto")),
              this.util.changeElement(t, n),
              this.util.changeTxt(i, l)),
              -1 < e.indexOf("column") &&
                (o._fixedColumn
                  ? (this.util.removeClass(s, "ke-table-layout-auto"),
                    this.util.addClass(s, "ke-table-layout-fixed"),
                    this.util.addClass(o.columnFixedButton, "active"))
                  : (this.util.removeClass(s, "ke-table-layout-fixed"),
                    this.util.addClass(s, "ke-table-layout-auto"),
                    this.util.removeClass(o.columnFixedButton, "active")));
          },
          setActiveButton: function (e, t) {
            var i = this.context.table;
            /^TH$/i.test(e.nodeName)
              ? (i.insertRowAboveButton.setAttribute("disabled", !0),
                i.insertRowBelowButton.setAttribute("disabled", !0))
              : (i.insertRowAboveButton.removeAttribute("disabled"),
                i.insertRowBelowButton.removeAttribute("disabled")),
              t && e !== t
                ? (i.splitButton.setAttribute("disabled", !0),
                  i.mergeButton.removeAttribute("disabled"))
                : (i.splitButton.removeAttribute("disabled"),
                  i.mergeButton.setAttribute("disabled", !0));
          },
          _bindOnSelect: null,
          _bindOffSelect: null,
          _bindOffShift: null,
          _selectedCells: null,
          _shift: !1,
          _fixedCell: null,
          _fixedCellName: null,
          _selectedCell: null,
          _selectedTable: null,
          _ref: null,
          _toggleEditor: function (e) {
            this.context.element.wysiwyg.setAttribute("contenteditable", e),
              e
                ? this.util.removeClass(
                    this.context.element.wysiwyg,
                    "ke-disabled"
                  )
                : this.util.addClass(
                    this.context.element.wysiwyg,
                    "ke-disabled"
                  );
          },
          _offCellMultiSelect: function (e) {
            e.stopPropagation();
            var t = this.plugins.table;
            t._shift
              ? t._initBind &&
                (this._wd.removeEventListener("touchmove", t._initBind),
                (t._initBind = null))
              : (t._removeEvents.call(this), t._toggleEditor.call(this, !0)),
              t._fixedCell &&
                t._selectedTable &&
                (t.setActiveButton.call(this, t._fixedCell, t._selectedCell),
                t.call_controller_tableEdit.call(
                  this,
                  t._selectedCell || t._fixedCell
                ),
                (t._selectedCells = t._selectedTable.querySelectorAll(
                  ".ke-table-selected-cell"
                )),
                t._selectedCell &&
                  t._fixedCell &&
                  this.focusEdge(t._selectedCell),
                t._shift ||
                  ((t._fixedCell = null),
                  (t._selectedCell = null),
                  (t._fixedCellName = null)));
          },
          _onCellMultiSelect: function (e) {
            this._antiBlur = !0;
            var t = this.plugins.table,
              i = this.util.getParentElement(e.target, this.util.isCell);
            if (t._shift)
              i === t._fixedCell
                ? t._toggleEditor.call(this, !0)
                : t._toggleEditor.call(this, !1);
            else if (!t._ref) {
              if (i === t._fixedCell) return;
              t._toggleEditor.call(this, !1);
            }
            i &&
              i !== t._selectedCell &&
              t._fixedCellName === i.nodeName &&
              t._selectedTable === this.util.getParentElement(i, "TABLE") &&
              ((t._selectedCell = i),
              t._setMultiCells.call(this, t._fixedCell, i));
          },
          _setMultiCells: function (e, t) {
            for (
              var i = this.plugins.table,
                n = i._selectedTable.rows,
                l = this.util,
                o = i._selectedTable.querySelectorAll(
                  ".ke-table-selected-cell"
                ),
                s = 0,
                a = o.length;
              s < a;
              s++
            )
              l.removeClass(o[s], "ke-table-selected-cell");
            if (e !== t || (l.addClass(e, "ke-table-selected-cell"), i._shift))
              for (
                var r,
                  c,
                  d = !0,
                  u = [],
                  h = [],
                  g = (i._ref = {
                    _i: 0,
                    cs: null,
                    ce: null,
                    rs: null,
                    re: null,
                  }),
                  p = 0,
                  m = n.length;
                p < m;
                p++
              ) {
                for (
                  var f, v, _, b, y = (c = 0), w = (r = n[p].cells).length;
                  y < w;
                  y++
                ) {
                  if (
                    ((_ = (f = r[y]).colSpan - 1),
                    (b = f.rowSpan - 1),
                    (v = y + c),
                    0 < u.length)
                  )
                    for (var C, k = 0; k < u.length; k++)
                      (C = u[k]).row > p ||
                        (v >= C.index
                          ? ((c += C.cs),
                            (v += C.cs),
                            --C.rs,
                            (C.row = p + 1),
                            C.rs < 1 && (u.splice(k, 1), k--))
                          : y === w - 1 &&
                            (--C.rs,
                            (C.row = p + 1),
                            C.rs < 1 && (u.splice(k, 1), k--)));
                  if (d) {
                    if (
                      ((f !== e && f !== t) ||
                        ((g.cs = null !== g.cs && g.cs < v ? g.cs : v),
                        (g.ce = null !== g.ce && g.ce > v + _ ? g.ce : v + _),
                        (g.rs = null !== g.rs && g.rs < p ? g.rs : p),
                        (g.re = null !== g.re && g.re > p + b ? g.re : p + b),
                        (g._i += 1)),
                      2 === g._i)
                    ) {
                      (d = !1), (u = []), (h = []), (p = -1);
                      break;
                    }
                  } else if (
                    l.getOverlapRangeAtIndex(g.cs, g.ce, v, v + _) &&
                    l.getOverlapRangeAtIndex(g.rs, g.re, p, p + b)
                  ) {
                    var x = g.cs < v ? g.cs : v,
                      E = g.ce > v + _ ? g.ce : v + _,
                      S = g.rs < p ? g.rs : p,
                      N = g.re > p + b ? g.re : p + b;
                    if (g.cs !== x || g.ce !== E || g.rs !== S || g.re !== N) {
                      (g.cs = x),
                        (g.ce = E),
                        (g.rs = S),
                        (g.re = N),
                        (p = -1),
                        (u = []),
                        (h = []);
                      break;
                    }
                    l.addClass(f, "ke-table-selected-cell");
                  }
                  0 < b && h.push({ index: v, cs: 1 + _, rs: b, row: -1 }),
                    (c += f.colSpan - 1);
                }
                (u = u.concat(h).sort(function (e, t) {
                  return e.index - t.index;
                })),
                  (h = []);
              }
          },
          _removeEvents: function () {
            var e = this.plugins.table;
            e._initBind &&
              (this._wd.removeEventListener("touchmove", e._initBind),
              (e._initBind = null)),
              e._bindOnSelect &&
                (this._wd.removeEventListener("mousedown", e._bindOnSelect),
                this._wd.removeEventListener("mousemove", e._bindOnSelect),
                (e._bindOnSelect = null)),
              e._bindOffSelect &&
                (this._wd.removeEventListener("mouseup", e._bindOffSelect),
                (e._bindOffSelect = null)),
              e._bindOffShift &&
                (this._wd.removeEventListener("keyup", e._bindOffShift),
                (e._bindOffShift = null));
          },
          _initBind: null,
          onTableCellMultiSelect: function (e, t) {
            var i = this.plugins.table;
            i._removeEvents.call(this),
              this.controllersOff(),
              (i._shift = t),
              (i._fixedCell = e),
              (i._fixedCellName = e.nodeName),
              (i._selectedTable = this.util.getParentElement(e, "TABLE"));
            for (
              var n = i._selectedTable.querySelectorAll(
                  ".ke-table-selected-cell"
                ),
                l = 0,
                o = n.length;
              l < o;
              l++
            )
              this.util.removeClass(n[l], "ke-table-selected-cell");
            this.util.addClass(e, "ke-table-selected-cell"),
              (i._bindOnSelect = i._onCellMultiSelect.bind(this)),
              (i._bindOffSelect = i._offCellMultiSelect.bind(this)),
              t
                ? ((i._bindOffShift = function () {
                    this.controllersOn(
                      this.context.table.resizeDiv,
                      this.context.table.tableController,
                      this.plugins.table.init.bind(this),
                      e,
                      "table"
                    ),
                      i._ref || this.controllersOff();
                  }.bind(this)),
                  this._wd.addEventListener("keyup", i._bindOffShift, !1),
                  this._wd.addEventListener("mousedown", i._bindOnSelect, !1))
                : this._wd.addEventListener("mousemove", i._bindOnSelect, !1),
              this._wd.addEventListener("mouseup", i._bindOffSelect, !1),
              (i._initBind = i.init.bind(this)),
              this._wd.addEventListener("touchmove", i._initBind, !1);
          },
          onClick_tableController: function (e) {
            e.stopPropagation();
            var t = e.target.getAttribute("data-command")
              ? e.target
              : e.target.parentNode;
            if (!t.getAttribute("disabled")) {
              var i = t.getAttribute("data-command"),
                n = t.getAttribute("data-value"),
                l = t.getAttribute("data-option"),
                o = this.plugins.table;
              if (
                ("function" != typeof o._closeSplitMenu ||
                  (o._closeSplitMenu(), "onsplit" !== i)) &&
                i
              ) {
                e.preventDefault();
                var s = this.context.table,
                  a = s._element.parentNode;
                switch (i) {
                  case "insert":
                  case "delete":
                    o.editTable.call(this, n, l);
                    break;
                  case "header":
                    o.toggleHeader.call(this);
                    break;
                  case "onsplit":
                    o.openSplitMenu.call(this);
                    break;
                  case "split":
                    o.splitCells.call(this, n);
                    break;
                  case "merge":
                    o.mergeCells.call(this);
                    break;
                  case "resize":
                    (s._maxWidth = !s._maxWidth),
                      o.setTableStyle.call(this, "width"),
                      o.setPositionControllerTop.call(this, s._element),
                      o.setPositionControllerDiv.call(
                        this,
                        s._tdElement,
                        o._shift
                      );
                    break;
                  case "layout":
                    (s._fixedColumn = !s._fixedColumn),
                      o.setTableStyle.call(this, "column"),
                      o.setPositionControllerTop.call(this, s._element),
                      o.setPositionControllerDiv.call(
                        this,
                        s._tdElement,
                        o._shift
                      );
                    break;
                  case "remove":
                    this.util.removeItem(s._element),
                      this.controllersOff(),
                      a !== this.context.element.wysiwyg &&
                        this.util.removeItemAllParents(
                          a,
                          function (e) {
                            return 0 === e.childNodes.length;
                          },
                          null
                        ),
                      this.focus();
                }
                this.history.push(!1);
              }
            }
          },
        },
        formatBlock: {
          name: "formatBlock",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.formatBlock = {
              targetText: t.querySelector(".txt"),
              targetTooltip: t.parentNode.querySelector(".ke-tooltip-text"),
              _formatList: null,
              currentFormat: "",
            };
            var n = this.setSubmenu.call(e);
            n
              .querySelector("ul")
              .addEventListener("click", this.pickUp.bind(e)),
              (i.formatBlock._formatList = n.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (n = null);
          },
          setSubmenu: function () {
            var e = this.context.option,
              t = this.lang.toolbar,
              i = this.util.createElement("DIV");
            i.className = "ke-submenu ke-list-layer ke-list-format";
            for (
              var n,
                l,
                o,
                s,
                a,
                r,
                c,
                d = [
                  "p",
                  "div",
                  "blockquote",
                  "pre",
                  "h1",
                  "h2",
                  "h3",
                  "h4",
                  "h5",
                  "h6",
                ],
                u = e.formats && 0 !== e.formats.length ? e.formats : d,
                h = '<div class="ke-list-inner"><ul class="ke-list-basic">',
                g = 0,
                p = u.length;
              g < p;
              g++
            )
              (r =
                "string" == typeof (n = u[g]) && -1 < d.indexOf(n)
                  ? ((o =
                      "blockquote" === (l = n.toLowerCase())
                        ? "range"
                        : "pre" === l
                        ? "free"
                        : "replace"),
                    (s =
                      t[
                        "tag_" +
                          ((a = /^h/.test(l) ? l.match(/\d+/)[0] : "")
                            ? "h"
                            : l)
                      ] + a),
                    (c = ""))
                  : ((l = n.tag.toLowerCase()),
                    (o = n.command),
                    (s = n.name || l),
                    (c = n.class) ? ' class="' + c + '"' : "")),
                (h +=
                  '<li><button type="button" class="ke-btn-list" data-command="' +
                  o +
                  '" data-value="' +
                  l +
                  '" data-class="' +
                  c +
                  '" title="' +
                  s +
                  '"><' +
                  l +
                  r +
                  ">" +
                  s +
                  "</" +
                  l +
                  "></button></li>");
            return (h += "</ul></div>"), (i.innerHTML = h), i;
          },
          active: function (e) {
            var t = this.lang.toolbar.formats,
              i = this.context.formatBlock.targetText,
              n = this.context.formatBlock.targetTooltip;
            if (e) {
              if (this.util.isFormatElement(e)) {
                for (
                  var l,
                    o = this.context.formatBlock._formatList,
                    s = e.nodeName.toLowerCase(),
                    a = (e.className.match(/(\s|^)__ke__format__[^\s]+/) || [
                      "",
                    ])[0].trim(),
                    r = 0,
                    c = o.length;
                  r < c;
                  r++
                )
                  if (
                    s === (l = o[r]).getAttribute("data-value") &&
                    a === l.getAttribute("data-class")
                  ) {
                    t = l.title;
                    break;
                  }
                return (
                  this.util.changeTxt(i, t),
                  this.util.changeTxt(n, t),
                  i.setAttribute("data-value", s),
                  i.setAttribute("data-class", a),
                  !0
                );
              }
            } else this.util.changeTxt(i, t), this.util.changeTxt(n, t);
            return !1;
          },
          on: function () {
            var e = this.context.formatBlock,
              t = e._formatList,
              i = e.targetText,
              n =
                (i.getAttribute("data-value") || "") +
                (i.getAttribute("data-class") || "");
            if (n !== e.currentFormat) {
              for (var l, o = 0, s = t.length; o < s; o++)
                n ===
                (l = t[o]).getAttribute("data-value") +
                  l.getAttribute("data-class")
                  ? this.util.addClass(l, "active")
                  : this.util.removeClass(l, "active");
              e.currentFormat = n;
            }
          },
          pickUp: function (e) {
            var t = this;
            e.preventDefault(), e.stopPropagation();
            for (
              var i = e.target, n = null, l = null, o = null, s = "";
              !n && !/UL/i.test(i.tagName);

            ) {
              if (
                ((n = i.getAttribute("data-command")),
                (l = i.getAttribute("data-value")),
                (s = i.getAttribute("data-class")),
                n)
              ) {
                o = i.firstChild;
                break;
              }
              i = i.parentNode;
            }
            if (n) {
              if ("range" === n) {
                var a = o.cloneNode(!1);
                this.applyRangeFormatElement(a);
              } else {
                var r = this.getRange(),
                  c = this.getSelectedElementsAndComponents(!1);
                if (
                  0 === c.length &&
                  ((r = this.getRange_addLine(r)),
                  0 === (c = this.getSelectedElementsAndComponents(!1)).length)
                )
                  return;
                var d = r.startOffset,
                  u = r.endOffset,
                  h = this.util,
                  g = c[0],
                  p = c[c.length - 1],
                  m = h.getNodePath(r.startContainer, g, null, null),
                  f = h.getNodePath(r.endContainer, p, null, null),
                  v = this.detachList(c, !1);
                v.sc && (g = v.sc),
                  v.ec && (p = v.ec),
                  this.setRange(
                    h.getNodeFromPath(m, g),
                    d,
                    h.getNodeFromPath(f, p),
                    u
                  );
                var _ = this.getSelectedElementsAndComponents(!1);
                if ("free" === n)
                  !(function () {
                    for (
                      var e,
                        i,
                        n,
                        l,
                        s,
                        a,
                        r,
                        c = _.length - 1,
                        d = _[c].parentNode,
                        u = o.cloneNode(!1),
                        g = u,
                        p = c,
                        m = !0;
                      0 <= p;
                      p--
                    )
                      (e = _[p]) !== (_[p + 1] ? _[p + 1].parentNode : null) &&
                        ((a = (s = h.isComponent(e))
                          ? ""
                          : e.innerHTML.replace(/(?!>)\s+(?=<)|\n/g, " ")),
                        (r = h.getParentElement(e, function (e) {
                          return e.parentNode === d;
                        })),
                        (d === e.parentNode && !s) ||
                          ((d = h.isFormatElement(d)
                            ? (d.parentNode.insertBefore(u, d.nextSibling),
                              d.parentNode)
                            : (d.insertBefore(u, r ? r.nextSibling : null),
                              e.parentNode)),
                          (i = u.nextSibling) &&
                            u.nodeName === i.nodeName &&
                            h.isSameAttributes(u, i) &&
                            ((u.innerHTML += "<BR>" + i.innerHTML),
                            h.removeItem(i)),
                          (u = o.cloneNode(!1)),
                          (m = !0)),
                        (n = u.innerHTML),
                        (u.innerHTML =
                          (m || !a || !n || /<br>$/i.test(a) ? a : a + "<BR>") +
                          n),
                        0 === p &&
                          (d.insertBefore(u, e),
                          (i = e.nextSibling) &&
                            u.nodeName === i.nodeName &&
                            h.isSameAttributes(u, i) &&
                            ((u.innerHTML += "<BR>" + i.innerHTML),
                            h.removeItem(i)),
                          (l = u.previousSibling) &&
                            u.nodeName === l.nodeName &&
                            h.isSameAttributes(u, l) &&
                            ((l.innerHTML += "<BR>" + u.innerHTML),
                            h.removeItem(u))),
                        s || h.removeItem(e),
                        a && (m = !1));
                    t.setRange(g, 0, g, 0);
                  })();
                else {
                  for (var b, y, w = 0, C = _.length; w < C; w++)
                    ((b = _[w]).nodeName.toLowerCase() === l.toLowerCase() &&
                      (b.className.match(/(\s|^)__ke__format__[^\s]+/) || [
                        "",
                      ])[0].trim() === s) ||
                      h.isComponent(b) ||
                      ((y = o.cloneNode(!1)),
                      h.copyFormatAttributes(y, b),
                      (y.innerHTML = b.innerHTML),
                      b.parentNode.replaceChild(y, b)),
                      0 === w && (g = y || b),
                      w === C - 1 && (p = y || b),
                      (y = null);
                  this.setRange(
                    h.getNodeFromPath(m, g),
                    d,
                    h.getNodeFromPath(f, p),
                    u
                  );
                }
                this.history.push(!1);
              }
              this.submenuOff();
            }
          },
        },
        lineHeight: {
          name: "lineHeight",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.lineHeight = { _sizeList: null, currentSize: -1 };
            var n = this.setSubmenu.call(e),
              l = n.querySelector("ul");
            l.addEventListener("click", this.pickup.bind(e)),
              (i.lineHeight._sizeList = l.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (l = n = null);
          },
          setSubmenu: function () {
            var e = this.context.option,
              t = this.lang,
              i = this.util.createElement("DIV");
            i.className = "ke-submenu ke-list-layer";
            for (
              var n,
                l = e.lineHeights
                  ? e.lineHeights
                  : [
                      { text: "1", value: 1 },
                      { text: "1.15", value: 1.15 },
                      { text: "1.5", value: 1.5 },
                      { text: "2", value: 2 },
                    ],
                o =
                  '<div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="default_value ke-btn-list" title="' +
                  t.toolbar.default +
                  '">(' +
                  t.toolbar.default +
                  ")</button></li>",
                s = 0,
                a = l.length;
              s < a;
              s++
            )
              o +=
                '<li><button type="button" class="ke-btn-list" data-value="' +
                (n = l[s]).value +
                '" title="' +
                n.text +
                '">' +
                n.text +
                "</button></li>";
            return (o += "</ul></div>"), (i.innerHTML = o), i;
          },
          on: function () {
            var e = this.context.lineHeight,
              t = e._sizeList,
              i = this.util.getFormatElement(this.getSelectionNode()),
              n = i ? i.style.lineHeight + "" : "";
            if (n !== e.currentSize) {
              for (var l = 0, o = t.length; l < o; l++)
                n === t[l].getAttribute("data-value")
                  ? this.util.addClass(t[l], "active")
                  : this.util.removeClass(t[l], "active");
              e.currentSize = n;
            }
          },
          pickup: function (e) {
            if (!/^BUTTON$/i.test(e.target.tagName)) return !1;
            e.preventDefault(), e.stopPropagation();
            for (
              var t = e.target.getAttribute("data-value") || "",
                i = this.getSelectedElements(),
                n = 0,
                l = i.length;
              n < l;
              n++
            )
              i[n].style.lineHeight = t;
            this.submenuOff(), this.history.push(!1);
          },
        },
        template: a,
        paragraphStyle: {
          name: "paragraphStyle",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.paragraphStyle = { _classList: null };
            var n = this.setSubmenu.call(e);
            n
              .querySelector("ul")
              .addEventListener("click", this.pickUp.bind(e)),
              (i.paragraphStyle._classList = n.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (n = null);
          },
          setSubmenu: function () {
            var e = this.context.option,
              t = this.util.createElement("DIV");
            t.className = "ke-submenu ke-list-layer ke-list-format";
            for (
              var i,
                n,
                l,
                o,
                s = this.lang.menu,
                a = {
                  spaced: {
                    name: s.spaced,
                    class: "__ke__p-spaced",
                    _class: "",
                  },
                  bordered: {
                    name: s.bordered,
                    class: "__ke__p-bordered",
                    _class: "",
                  },
                  neon: { name: s.neon, class: "__ke__p-neon", _class: "" },
                },
                r =
                  e.paragraphStyles && 0 !== e.paragraphStyles.length
                    ? e.paragraphStyles
                    : ["spaced", "bordered", "neon"],
                c = '<div class="ke-list-inner"><ul class="ke-list-basic">',
                d = 0,
                u = r.length;
              d < u;
              d++
            ) {
              if ("string" == typeof (i = r[d])) {
                var h = a[i.toLowerCase()];
                if (!h) continue;
                i = h;
              }
              (n = i.name),
                (l = i.class ? ' class="' + i.class + '"' : ""),
                (c +=
                  '<li><button type="button" class="ke-btn-list' +
                  ((o = i._class) ? " " + o : "") +
                  '" data-value="' +
                  i.class +
                  '" title="' +
                  n +
                  '"><div' +
                  l +
                  ">" +
                  n +
                  "</div></button></li>");
            }
            return (c += "</ul></div>"), (t.innerHTML = c), t;
          },
          on: function () {
            for (
              var e = this.context.paragraphStyle._classList,
                t = this.util.getFormatElement(this.getSelectionNode()),
                i = 0,
                n = e.length;
              i < n;
              i++
            )
              this.util.hasClass(t, e[i].getAttribute("data-value"))
                ? this.util.addClass(e[i], "active")
                : this.util.removeClass(e[i], "active");
          },
          pickUp: function (e) {
            e.preventDefault(), e.stopPropagation();
            for (
              var t = e.target, i = null;
              !/^UL$/i.test(t.tagName) && !(i = t.getAttribute("data-value"));

            )
              t = t.parentNode;
            if (i) {
              var n = this.getSelectedElements();
              if (
                0 !== n.length ||
                (this.getRange_addLine(this.getRange()),
                0 !== (n = this.getSelectedElements()).length)
              ) {
                for (
                  var l = this.util.hasClass(t, "active")
                      ? this.util.removeClass.bind(this.util)
                      : this.util.addClass.bind(this.util),
                    o = 0,
                    s = n.length;
                  o < s;
                  o++
                )
                  l(n[o], i);
                this.submenuOff(), this.history.push(!1);
              }
            }
          },
        },
        textStyle: {
          name: "textStyle",
          display: "submenu",
          add: function (e, t) {
            var i = e.context;
            i.textStyle = { _styleList: null };
            var n = this.setSubmenu.call(e);
            n
              .querySelector("ul")
              .addEventListener("click", this.pickup.bind(e)),
              (i.textStyle._styleList = n.querySelectorAll("li button")),
              e.initMenuTarget(this.name, t, n),
              (n = null);
          },
          setSubmenu: function () {
            var e = this.context.option,
              t = this.util.createElement("DIV");
            t.className = "ke-submenu ke-list-layer ke-list-format";
            for (
              var i,
                n,
                l,
                o,
                s,
                a,
                r,
                c = {
                  code: {
                    name: this.lang.menu.code,
                    class: "__ke__t-code",
                    tag: "code",
                  },
                  translucent: {
                    name: this.lang.menu.translucent,
                    style: "opacity: 0.5;",
                    tag: "span",
                  },
                  shadow: {
                    name: this.lang.menu.shadow,
                    class: "__ke__t-shadow",
                    tag: "span",
                  },
                },
                d = e.textStyles ? e.textStyles : this._w.Object.keys(c),
                u = '<div class="ke-list-inner"><ul class="ke-list-basic">',
                h = 0,
                g = d.length;
              h < g;
              h++
            ) {
              if (((a = o = ""), (s = []), "string" == typeof (i = d[h]))) {
                var p = c[i.toLowerCase()];
                if (!p) continue;
                i = p;
              }
              (l = i.name),
                (n = i.tag || "span"),
                (r = i._class),
                i.style &&
                  ((o += ' style="' + i.style + '"'),
                  (a += i.style.replace(/:[^;]+(;|$)\s*/g, ",")),
                  s.push("style")),
                i.class &&
                  ((o += ' class="' + i.class + '"'),
                  (a += "." + i.class.trim().replace(/\s+/g, ",.")),
                  s.push("class")),
                (u +=
                  '<li><button type="button" class="ke-btn-list' +
                  (r ? " " + r : "") +
                  '" data-command="' +
                  n +
                  '" data-value="' +
                  (a = a.replace(/,$/, "")) +
                  '" title="' +
                  l +
                  '"><' +
                  n +
                  o +
                  ">" +
                  l +
                  "</" +
                  n +
                  "></button></li>");
            }
            return (u += "</ul></div>"), (t.innerHTML = u), t;
          },
          on: function () {
            for (
              var e,
                t,
                i,
                n = this.util,
                l = this.context.textStyle._styleList,
                o = this.getSelectionNode(),
                s = 0,
                a = l.length;
              s < a;
              s++
            ) {
              t = (e = l[s]).getAttribute("data-value").split(",");
              for (var r, c, d = 0; d < t.length; d++) {
                for (
                  r = o, i = !1;
                  r && !n.isFormatElement(r) && !n.isComponent(r);

                ) {
                  if (
                    r.nodeName.toLowerCase() ===
                      e.getAttribute("data-command").toLowerCase() &&
                    ((c = t[d]),
                    /^\./.test(c)
                      ? n.hasClass(r, c.replace(/^\./, ""))
                      : r.style[c])
                  ) {
                    i = !0;
                    break;
                  }
                  r = r.parentNode;
                }
                if (!i) break;
              }
              i ? n.addClass(e, "active") : n.removeClass(e, "active");
            }
          },
          pickup: function (e) {
            e.preventDefault(), e.stopPropagation();
            for (
              var t = e.target, i = null, n = null;
              !i && !/UL/i.test(t.tagName);

            ) {
              if ((i = t.getAttribute("data-command"))) {
                n = t.firstChild;
                break;
              }
              t = t.parentNode;
            }
            if (i) {
              var l = n.style.cssText.replace(/:.+(;|$)/g, ",").split(",");
              l.pop();
              for (var o = n.classList, s = 0, a = o.length; s < a; s++)
                l.push("." + o[s]);
              var r = this.util.hasClass(t, "active") ? null : n.cloneNode(!1),
                c = r ? null : [n.nodeName];
              this.nodeChange(r, l, c, !0), this.submenuOff();
            }
          },
        },
        link: d,
        image: v,
        video: b,
        audio: w,
        math: C,
        imageGallery: {
          name: "imageGallery",
          add: function (e) {
            e.addModule([x.a]);
            var t = e.context;
            t.imageGallery = {
              title: e.lang.toolbar.imageGallery,
              url: t.options.imageGalleryUrl,
              listClass: "ke-image-list",
              itemTemplateHandler: this.drawItems,
              selectorHandler: this.setImage.bind(e),
              columnSize: 4,
            };
          },
          open: function (e) {
            this.plugins.fileBrowser.open.call(this, "imageGallery", e);
          },
          drawItems: function (e) {
            var t = e.src.split("/").pop();
            return (
              '<div class="ke-file-item-img"><img src="' +
              e.src +
              '" alt="' +
              (e.alt || t) +
              '" data-command="pick"><div class="ke-file-img-name ke-file-name-back"></div><div class="ke-file-img-name __ke__img_name">' +
              (e.name || t) +
              "</div></div>"
            );
          },
          setImage: function (e) {
            this.callPlugin(
              "image",
              function () {
                var t = {
                  name: e.parentNode.querySelector(".__ke__img_name")
                    .textContent,
                  size: 0,
                };
                (this.context.image._altText = e.alt),
                  this.plugins.image.create_image.call(
                    this,
                    e.src,
                    "",
                    !1,
                    this.context.image._origin_w,
                    this.context.image._origin_h,
                    "none",
                    t
                  );
              }.bind(this),
              null
            );
          },
        },
      },
      S = {
        redo:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2-29.4-29.4-52.5-63.6-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5c-16.1 38.1-39.2 72.3-68.6 101.7-9.3 9.3-19.1 18-29.3 26L668.2 724c-4.1-5.3-12.5-3.5-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 0.8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z" /></svg>',
        undo:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-0.3 13 6.3 12.9l167-0.8c5.2 0 9-4.9 7.7-9.9L369.8 727c-1.6-6.5-10-8.3-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26-29.4-29.4-52.5-63.6-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5c-16.1 38.1-39.2 72.3-68.6 101.7-7.5 7.5-15.3 14.5-23.4 21.2-3.4 2.8-3.9 7.7-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z" /></svg>',
        bold:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M697.8 481.4c33.6-35 54.2-82.3 54.2-134.3v-10.2C752 229.3 663.9 142 555.3 142H259.4c-15.1 0-27.4 12.3-27.4 27.4v679.1c0 16.3 13.2 29.5 29.5 29.5h318.7c117 0 211.8-94.2 211.8-210.5v-11c0-73-37.4-137.3-94.2-175.1zM328 238h224.7c57.1 0 103.3 44.4 103.3 99.3v9.5c0 54.8-46.3 99.3-103.3 99.3H328V238z m366.6 429.4c0 62.9-51.7 113.9-115.5 113.9H328V542.7h251.1c63.8 0 115.5 51 115.5 113.9v10.8z" /></svg>',
        underline:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M824 804H200c-4.4 0-8 3.4-8 7.6v60.8c0 4.2 3.6 7.6 8 7.6h624c4.4 0 8-3.4 8-7.6v-60.8c0-4.2-3.6-7.6-8-7.6zM512 728c69.4 0 134.6-27.1 183.8-76.2C745 602.7 772 537.4 772 468V156c0-6.6-5.4-12-12-12h-60c-6.6 0-12 5.4-12 12v312c0 97-79 176-176 176s-176-79-176-176V156c0-6.6-5.4-12-12-12h-60c-6.6 0-12 5.4-12 12v312c0 69.4 27.1 134.6 76.2 183.8C377.3 701 442.6 728 512 728z" /></svg>',
        italic:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M798 160H366c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h181.2l-156 544H229c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h432c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8H474.4l156-544H798c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z" /></svg>',
        strike:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M952 474H569.9c-10-2-20.5-4-31.6-6-15.9-2.9-22.2-4.1-30.8-5.8-51.3-10-82.2-20-106.8-34.2-35.1-20.5-52.2-48.3-52.2-85.1 0-37 15.2-67.7 44-89 28.4-21 68.8-32.1 116.8-32.1 54.8 0 97.1 14.4 125.8 42.8 14.6 14.4 25.3 32.1 31.8 52.6 1.3 4.1 2.8 10 4.3 17.8 0.9 4.8 5.2 8.2 9.9 8.2h72.8c5.6 0 10.1-4.6 10.1-10.1v-1c-0.7-6.8-1.3-12.1-2-16-7.3-43.5-28-81.7-59.7-110.3-44.4-40.5-109.7-61.8-188.7-61.8-72.3 0-137.4 18.1-183.3 50.9-25.6 18.4-45.4 41.2-58.6 67.7-13.5 27.1-20.3 58.4-20.3 92.9 0 29.5 5.7 54.5 17.3 76.5 8.3 15.7 19.6 29.5 34.1 42H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h433.2c2.1 0.4 3.9 0.8 5.9 1.2 30.9 6.2 49.5 10.4 66.6 15.2 23 6.5 40.6 13.3 55.2 21.5 35.8 20.2 53.3 49.2 53.3 89 0 35.3-15.5 66.8-43.6 88.8-30.5 23.9-75.6 36.4-130.5 36.4-43.7 0-80.7-8.5-110.2-25-29.1-16.3-49.1-39.8-59.7-69.5-0.8-2.2-1.7-5.2-2.7-9-1.2-4.4-5.3-7.5-9.7-7.5h-79.7c-5.6 0-10.1 4.6-10.1 10.1v1c0.2 2.3 0.4 4.2 0.6 5.7 6.5 48.8 30.3 88.8 70.7 118.8 47.1 34.8 113.4 53.2 191.8 53.2 84.2 0 154.8-19.8 204.2-57.3 25-18.9 44.2-42.2 57.1-69 13-27.1 19.7-57.9 19.7-91.5 0-31.8-5.8-58.4-17.8-81.4-5.8-11.2-13.1-21.5-21.8-30.8H952c4.4 0 8-3.6 8-8v-60c0-4.3-3.6-7.9-8-7.9z" /></svg>',
        subscript:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M825.905 790.87v51.138h130.908v65.454H760.452V758.143L891.36 696.78v-51.137H760.452V580.19h196.361v149.318L825.905 790.87z m-94.09-668.857H592.726l-192.271 192.27-192.336-192.27H69.029l261.815 261.815L69.03 645.643h139.09l192.336-192.272 192.271 192.272h139.09L470 383.827l261.815-261.815z" /></svg>',
        superscript:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M821.441 332.052v50.742h129.897v64.948H756.494V299.577l129.896-60.888v-50.742H756.494V123h194.845v148.165l-129.896 60.888z m-93.363 50.74H590.063L399.276 573.58 208.424 382.793H70.409l259.795 259.794L70.409 902.383h138.016l190.852-190.786 190.786 190.786h138.015L468.282 642.587l259.796-259.794z" /></svg>',
        erase:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M651.229 199.033c-6.769-6.77-17.845-6.77-24.615 0L74.612 751.036c-6.769 6.768-6.769 17.845 0 24.614l107.36 107.361c6.77 6.769 20.14 12.307 29.713 12.307H555.62c9.572 0 22.944-5.538 29.712-12.307l362.63-362.628c6.77-6.769 6.77-17.845 0-24.615L651.23 199.033zM551.187 817.522c-6.769 6.768-20.14 12.307-29.712 12.307H255.194c-9.573 0-22.944-5.539-29.712-12.307l-50.61-50.61c-6.769-6.769-6.769-17.845 0-24.615l202.36-202.361c6.77-6.768 17.846-6.768 24.616 0l201.155 201.156c6.769 6.768 6.769 17.845 0 24.614l-51.816 51.816z" /></svg>',
        indent:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM400 646c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zM904 160H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 792H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM142.4 642.1L298.7 519c4.5-3.5 4.5-10.3 0-13.9L142.4 381.9c-5.8-4.6-14.4-0.5-14.4 6.9v246.3c0 7.4 8.5 11.6 14.4 7z" /></svg>',
        outdent:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM400 646c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zM904 160H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 792H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4 0.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1c-4.5 3.5-4.5 10.3 0 13.8z" /></svg>',
        expansion:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M342 88H120c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V168h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM920 664h-48c-8.8 0-16 7.2-16 16v176H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V680c0-8.8-7.2-16-16-16zM342 856H168V680c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM904 88H682c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V120c0-17.7-14.3-32-32-32z" /></svg>',
        reduction:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M326 664H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V696c0-17.7-14.3-32-32-32zM342 88h-48c-8.8 0-16 7.2-16 16v176H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V104c0-8.8-7.2-16-16-16zM920 664H698c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V744h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zM920 280H746V104c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16z" /></svg>',
        code_view:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M438.4 849.1l222.7-646.7c0.2-0.5 0.3-1.1 0.4-1.6L438.4 849.1zM661.2 168.7h-67.5c-3.4 0-6.5 2.2-7.6 5.4L354.7 846c-0.3 0.8-0.4 1.7-0.4 2.6 0 4.4 3.6 8 8 8h67.8c3.4 0 6.5-2.2 7.6-5.4l0.7-2.1 223.1-648.3 7.4-21.4c0.3-0.8 0.4-1.7 0.4-2.6-0.1-4.5-3.6-8.1-8.1-8.1zM954.6 502.1c-0.8-1-1.7-1.9-2.7-2.7l-219-171.3c-3.5-2.7-8.5-2.1-11.2 1.4-1.1 1.4-1.7 3.1-1.7 4.9v81.3c0 2.5 1.1 4.8 3.1 6.3l115 90-115 90c-1.9 1.5-3.1 3.8-3.1 6.3v81.3c0 4.4 3.6 8 8 8 1.8 0 3.5-0.6 4.9-1.7l219-171.3c6.9-5.4 8.2-15.5 2.7-22.5zM291.1 328.1l-219 171.3c-1 0.8-1.9 1.7-2.7 2.7-5.4 7-4.2 17 2.7 22.5l219 171.3c1.4 1.1 3.1 1.7 4.9 1.7 4.4 0 8-3.6 8-8v-81.3c0-2.5-1.1-4.8-3.1-6.3l-115-90 115-90c1.9-1.5 3.1-3.8 3.1-6.3v-81.3c0-1.8-0.6-3.5-1.7-4.9-2.7-3.5-7.7-4.1-11.2-1.4z" /></svg>',
        preview:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem"viewBox="0 0 15.65 15.66"><g><path d="M16.19,14.43l2.49,2.49a.73.73,0,0,1,.21.52.67.67,0,0,1-.22.51.7.7,0,0,1-.52.22.69.69,0,0,1-.51-.21l-2.49-2.48a5.17,5.17,0,0,1-1.34.69,4.64,4.64,0,0,1-1.48.24,4.78,4.78,0,1,1,0-9.56,4.79,4.79,0,0,1,1.84.36,4.9,4.9,0,0,1,1.56,1,4.77,4.77,0,0,1,.46,6.18ZM10,14a3.3,3.3,0,0,0,2.34.93A3.37,3.37,0,0,0,14.7,14a3.3,3.3,0,0,0-1.08-5.41,3.47,3.47,0,0,0-2.56,0A3,3,0,0,0,10,9.28,3.31,3.31,0,0,0,10,14ZM16,4a3.86,3.86,0,0,1,2.77,1.14A3.9,3.9,0,0,1,20,7.85v4a.77.77,0,0,1-.22.53.7.7,0,0,1-.52.21.72.72,0,0,1-.74-.74v-4a2.46,2.46,0,0,0-.72-1.73A2.37,2.37,0,0,0,16,5.45H8.53A2.42,2.42,0,0,0,6.08,7.89v7.52a2.41,2.41,0,0,0,.71,1.73,2.46,2.46,0,0,0,1.74.72h4.08a.73.73,0,0,1,0,1.46H8.53a3.85,3.85,0,0,1-2.78-1.14A3.93,3.93,0,0,1,4.6,15.4V7.87A3.94,3.94,0,0,1,5.76,5.09,3.88,3.88,0,0,1,8.54,4H16Z" transform="translate(-4.45 -3.8)"/></g></svg>',
        print:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M820 436h-40c-4.4 0-8 3.6-8 8v40c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-40c0-4.4-3.6-8-8-8zM852 332H732V120c0-4.4-3.6-8-8-8H300c-4.4 0-8 3.6-8 8v212H172c-44.2 0-80 35.8-80 80v328c0 17.7 14.3 32 32 32h168v132c0 4.4 3.6 8 8 8h424c4.4 0 8-3.6 8-8V772h168c17.7 0 32-14.3 32-32V412c0-44.2-35.8-80-80-80zM360 180h304v152H360V180z m304 664H360V568h304v276z m200-140H732V500H292v204H160V412c0-6.6 5.4-12 12-12h680c6.6 0 12 5.4 12 12v292z" /></svg>',
        template:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 14.27 15.64"><g><path d="M18.18,19.16a1,1,0,0,0,1-1V5.73a1,1,0,0,0-1-1h-2v1h2V18.19H6.37V5.73h2v-1h-2A.94.94,0,0,0,5.68,5a1,1,0,0,0-.29.7V18.18a.94.94,0,0,0,.29.69,1,1,0,0,0,.69.29H18.18ZM9.82,10.31h4.92a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.49.49,0,0,0-.15-.35.47.47,0,0,0-.35-.15H9.82a.49.49,0,0,0-.35.15.47.47,0,0,0-.15.35.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15Zm5.9,4.92H8.83a.49.49,0,0,0-.35.15.47.47,0,0,0-.15.35.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15h6.89a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.51.51,0,0,0-.5-.5ZM7.36,12.77a.49.49,0,0,0,.15.35.47.47,0,0,0,.35.15h8.85a.49.49,0,0,0,.35-.15.47.47,0,0,0,.15-.35.49.49,0,0,0-.15-.35.47.47,0,0,0-.35-.15H7.85a.49.49,0,0,0-.35.15.52.52,0,0,0-.14.35Z" transform="translate(-5.14 -3.77)"/><path d="M14.24,6.71a1,1,0,0,0,1-1,1,1,0,0,0-1-1,1,1,0,0,0-1-1h-2a.94.94,0,0,0-.69.28,1,1,0,0,0-.29.7A.94.94,0,0,0,9.62,5a.91.91,0,0,0-.29.69,1,1,0,0,0,.29.7,1,1,0,0,0,.69.29h3.93Z" transform="translate(-5.14 -3.77)"/></g></svg>',
        line_height:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M657.067 136.533H76.8c-4.693 0-8.533 3.84-8.533 8.534V281.6c0 4.693 3.84 8.533 8.533 8.533h59.733c4.694 0 8.534-3.84 8.534-8.533v-68.267h179.2v597.334h-98.134c-4.693 0-8.533 3.84-8.533 8.533v59.733c0 4.694 3.84 8.534 8.533 8.534h281.6c4.694 0 8.534-3.84 8.534-8.534V819.2c0-4.693-3.84-8.533-8.534-8.533H409.6V213.333h179.2V281.6c0 4.693 3.84 8.533 8.533 8.533h59.734c4.693 0 8.533-3.84 8.533-8.533V145.067c0-4.694-3.84-8.534-8.533-8.534z m290.986 582.4h-69.12V305.067h69.12c6.4 0 10.027-7.467 6.08-12.48L846.613 156.48c-3.093-3.947-9.066-3.947-12.053 0L727.04 292.587c-3.947 5.013-0.427 12.48 6.08 12.48h69.013v413.866h-69.12c-6.4 0-10.026 7.467-6.08 12.48l107.52 136c3.094 3.947 9.067 3.947 12.054 0l107.52-136c4.053-5.013 0.426-12.48-5.974-12.48z" /></svg>',
        paragraph_style:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M512 256v640h-85.333333v-213.333333a256 256 0 1 1 0-512h426.666666v85.333333h-128v640h-85.333333V256h-128z m-85.333333 0a170.666667 170.666667 0 1 0 0 341.333333V256z"></path></svg>',
        text_style:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M890.592 729.19V296.255a115.329 115.329 0 1 0-140.099-163.93H268.452A115.257 115.257 0 1 0 135.213 298.42v428.602A115.293 115.293 0 1 0 270.98 888.426h476.987A115.293 115.293 0 1 0 890.592 729.19z m-39.719-590.727a49.468 49.468 0 1 1-49.467 49.468 49.324 49.324 0 0 1 49.467-49.468zM117.881 187.93a49.468 49.468 0 1 1 49.468 49.468 49.54 49.54 0 0 1-49.468-49.468z m49.468 698.69a49.468 49.468 0 1 1 49.468-49.469 49.324 49.324 0 0 1-49.468 49.468z m569.423-64.634h-454.96a115.834 115.834 0 0 0-80.882-94.964V298.06a114.896 114.896 0 0 0 80.882-99.297h454.6a115.076 115.076 0 0 0 87.742 101.464v424.99a114.787 114.787 0 0 0-87.382 96.77z m114.101 64.633a49.468 49.468 0 1 1 49.468-49.468 49.324 49.324 0 0 1-49.468 49.468zM539.262 283.256a4.983 4.983 0 0 1-1.084-1.444 33.544 33.544 0 0 0-17.332-21.665 32.822 32.822 0 0 0-44.051 15.526L274.95 695.61a32.822 32.822 0 0 0 15.526 44.052 33.725 33.725 0 0 0 14.444 3.25 33.292 33.292 0 0 0 29.97-18.777l64.272-133.6h211.592a10.58 10.58 0 0 0 3.25-0.721l67.883 141.543a33.292 33.292 0 0 0 29.97 18.776 34.953 34.953 0 0 0 14.443-3.25 32.93 32.93 0 0 0 15.526-44.051zM430.576 524.818l75.466-157.43 75.466 157.43z" /></svg>',
        save:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184z m456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144z m0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z" /></svg>',
        blockquote:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 475.082 475.081"><g><path d="M164.45,219.27h-63.954c-7.614,0-14.087-2.664-19.417-7.994c-5.327-5.33-7.994-11.801-7.994-19.417v-9.132c0-20.177,7.139-37.401,21.416-51.678c14.276-14.272,31.503-21.411,51.678-21.411h18.271c4.948,0,9.229-1.809,12.847-5.424c3.616-3.617,5.424-7.898,5.424-12.847V54.819c0-4.948-1.809-9.233-5.424-12.85c-3.617-3.612-7.898-5.424-12.847-5.424h-18.271c-19.797,0-38.684,3.858-56.673,11.563c-17.987,7.71-33.545,18.132-46.68,31.267c-13.134,13.129-23.553,28.688-31.262,46.677C3.855,144.039,0,162.931,0,182.726v200.991c0,15.235,5.327,28.171,15.986,38.834c10.66,10.657,23.606,15.985,38.832,15.985h109.639c15.225,0,28.167-5.328,38.828-15.985c10.657-10.663,15.987-23.599,15.987-38.834V274.088c0-15.232-5.33-28.168-15.994-38.832C192.622,224.6,179.675,219.27,164.45,219.27z"/><path d="M459.103,235.256c-10.656-10.656-23.599-15.986-38.828-15.986h-63.953c-7.61,0-14.089-2.664-19.41-7.994c-5.332-5.33-7.994-11.801-7.994-19.417v-9.132c0-20.177,7.139-37.401,21.409-51.678c14.271-14.272,31.497-21.411,51.682-21.411h18.267c4.949,0,9.233-1.809,12.848-5.424c3.613-3.617,5.428-7.898,5.428-12.847V54.819c0-4.948-1.814-9.233-5.428-12.85c-3.614-3.612-7.898-5.424-12.848-5.424h-18.267c-19.808,0-38.691,3.858-56.685,11.563c-17.984,7.71-33.537,18.132-46.672,31.267c-13.135,13.129-23.559,28.688-31.265,46.677c-7.707,17.987-11.567,36.879-11.567,56.674v200.991c0,15.235,5.332,28.171,15.988,38.834c10.657,10.657,23.6,15.985,38.828,15.985h109.633c15.229,0,28.171-5.328,38.827-15.985c10.664-10.663,15.985-23.599,15.985-38.834V274.088C475.082,258.855,469.76,245.92,459.103,235.256z"/></g></svg>',
        arrow_down:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 15.73 8.67"><g><path d="M18.79,7.52a.8.8,0,0,1,.56-.23.82.82,0,0,1,.79.79.8.8,0,0,1-.23.56l-7.07,7.07a.79.79,0,0,1-.57.25.77.77,0,0,1-.57-.25h0L4.64,8.65a.8.8,0,0,1-.23-.57.82.82,0,0,1,.79-.79.8.8,0,0,1,.56.23L12.28,14l3.26-3.26,3.25-3.26Z" transform="translate(-4.41 -7.29)"/></g></svg>',
        align_justify:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 15.74 13.77"><g><path d="M4.41,4.74v2H20.15v-2H4.41Zm0,5.9H20.15v-2H4.41v2Zm0,3.94H20.15v-2H4.41v2Zm0,3.93h7.87v-2H4.41v2Z" transform="translate(-4.41 -4.74)"/></g></svg>',
        align_left:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M120 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM120 654h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z" /></svg>',
        align_right:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M904 158H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 582H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z" /></svg>',
        align_center:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M264 230h496c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zM760 654c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H264c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496zM904 794H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM904 370H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8z" /></svg>',
        font_color:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zM253.7 736h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-0.2 3.2-0.5 5.1-1.8 7.8-7.3 6-12.4L573.6 118.6c-1.4-3.9-5.1-6.6-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-0.4 1-0.5 2.1-0.5 3.2-0.1 5.3 4.3 9.7 9.7 9.7z m255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z" /></svg>',
        highlight_color:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zM389.3 700.2c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-0.6-0.6-1.3-1.2-2-1.7l-78.2-78.2c-3.5-3.5-9.3-3.5-12.8 0l-48 48c-3.5 3.5-3.5 9.3 0 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256z m12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z" /></svg>',
        list_bullets:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM912 476H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM912 760H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM160 228m-56 0a56 56 0 1 0 112 0 56 56 0 1 0-112 0ZM160 512m-56 0a56 56 0 1 0 112 0 56 56 0 1 0-112 0ZM160 796m-56 0a56 56 0 1 0 112 0 56 56 0 1 0-112 0Z" /></svg>',
        list_number:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M920 760H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM920 192H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM920 476H336c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM216 712H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h72.4v20.5h-35.7c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h35.7V838H100c-2.2 0-4 1.8-4 4v34c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4V716c0-2.2-1.8-4-4-4zM100 188h38v120c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4V152c0-4.4-3.6-8-8-8h-78c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4zM216 428H100c-2.2 0-4 1.8-4 4v36c0 2.2 1.8 4 4 4h68.4l-70.3 77.7c-1.3 1.5-2.1 3.4-2.1 5.4V592c0 2.2 1.8 4 4 4h116c2.2 0 4-1.8 4-4v-36c0-2.2-1.8-4-4-4h-68.4l70.3-77.7c1.3-1.5 2.1-3.4 2.1-5.4V432c0-2.2-1.8-4-4-4z" /></svg>',
        table:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1181 1024"><path d="M1065.846 62H96.615C69.028 62 62 69.269 62 96.616v830.768C62 954.731 69.027 962 96.616 962h969.23c27.59 0 34.615-7.269 34.615-34.616V96.616c0-27.347-7.027-34.616-34.615-34.616zM373.54 892.769l-243.45 2.874V720.8l243.45-1.107v173.076z m0-242.308H131.23V477.384h242.308v173.077z m0-242.307H131.23V269.693h242.308v138.46z m346.154 484.615H442.769V719.693h276.923v173.076z m0-242.308H442.769V477.384h276.923v173.077z m0-242.307H442.769V269.693h276.923v138.46z m311.538 484.615H788.923V719.693h242.308v173.076z m0-242.308H788.923V477.384h242.308v173.077z m0-242.307H788.923V269.693h242.308v138.46z" /></svg>',
        horizontal_rule:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 15.74 2.24"><g><path d="M20.15,12.75V10.51H4.41v2.24H20.15Z" transform="translate(-4.41 -10.51)"/></g></svg>',
        show_blocks:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 15.66 15.67"><g><path d="M19.72,5.58a1.64,1.64,0,0,0-1.64-1.64H6.23a1.62,1.62,0,0,0-1.16.48,1.63,1.63,0,0,0-.48,1.16V9.63a1.6,1.6,0,0,0,.48,1.16,1.62,1.62,0,0,0,1.16.47H18.09a1.67,1.67,0,0,0,1.16-.47,1.62,1.62,0,0,0,.48-1.16V5.58Zm-.94,4.05a.68.68,0,0,1-.7.7H6.23a.66.66,0,0,1-.48-.2.74.74,0,0,1-.21-.5V5.58a.66.66,0,0,1,.2-.48.71.71,0,0,1,.48-.21H18.08a.74.74,0,0,1,.5.21.66.66,0,0,1,.2.48ZM6.48,7.72a.21.21,0,0,0,.17-.07.22.22,0,0,0,.07-.17V7.06a1.27,1.27,0,0,1,.11-.52.37.37,0,0,1,.36-.23H8.77A.25.25,0,0,0,9,6.17a.19.19,0,0,0,0-.23.27.27,0,0,0-.2-.12H7.19a.88.88,0,0,0-.72.39,1.51,1.51,0,0,0-.23.85v.42a.24.24,0,0,0,.24.24Zm-.19.81a.21.21,0,0,0,.17-.07.26.26,0,0,0,.07-.17.24.24,0,0,0-.24-.24.2.2,0,0,0-.16.09.2.2,0,0,0-.07.16.22.22,0,0,0,.07.17.23.23,0,0,0,.16.06Zm8.46,5.1a1.63,1.63,0,0,0-.47-1.16A1.61,1.61,0,0,0,13.12,12H6.23a1.6,1.6,0,0,0-1.16.46,1.62,1.62,0,0,0-.48,1.16v4.05a1.64,1.64,0,0,0,1.64,1.64h6.89a1.6,1.6,0,0,0,1.16-.48,1.62,1.62,0,0,0,.47-1.16Zm-.94,4a.7.7,0,0,1-.2.49.65.65,0,0,1-.5.2H6.23a.66.66,0,0,1-.48-.2.75.75,0,0,1-.21-.49v-4a.74.74,0,0,1,.21-.5.66.66,0,0,1,.48-.2h6.89a.68.68,0,0,1,.7.7v4Zm6.15,0v-4a1.6,1.6,0,0,0-.48-1.16A1.67,1.67,0,0,0,18.32,12H17.1a1.63,1.63,0,0,0-1.16.47,1.61,1.61,0,0,0-.47,1.16v4a1.67,1.67,0,0,0,.47,1.16,1.62,1.62,0,0,0,1.16.48h1.22A1.64,1.64,0,0,0,20,17.68Zm-.94-4v4a.75.75,0,0,1-.21.49.62.62,0,0,1-.48.2H17.11a.69.69,0,0,1-.5-.2.7.7,0,0,1-.2-.49v-4a.68.68,0,0,1,.7-.7h1.22a.66.66,0,0,1,.48.2.72.72,0,0,1,.21.5Z" transform="translate(-4.44 -3.79)"/></g></svg>',
        cancel:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 15.74 15.74"><g><path d="M14.15,11.63l5.61,5.61a1.29,1.29,0,0,1,.38.93,1.27,1.27,0,0,1-.4.93,1.25,1.25,0,0,1-.92.4,1.31,1.31,0,0,1-.94-.4l-5.61-5.61L6.67,19.1a1.31,1.31,0,0,1-.94.4,1.24,1.24,0,0,1-.92-.4,1.27,1.27,0,0,1-.4-.93,1.33,1.33,0,0,1,.38-.93l5.61-5.63L4.79,6a1.26,1.26,0,0,1-.38-.93,1.22,1.22,0,0,1,.4-.92,1.28,1.28,0,0,1,.92-.39,1.38,1.38,0,0,1,.94.38l5.61,5.61,5.61-5.61a1.33,1.33,0,0,1,.94-.38,1.26,1.26,0,0,1,.92.39,1.24,1.24,0,0,1,.4.92,1.29,1.29,0,0,1-.39.93L17,8.81l-2.8,2.82Z" transform="translate(-4.41 -3.76)"/></g></svg>',
        image:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32z m-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792z m0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456c48.6 0 88-39.4 88-88s-39.4-88-88-88-88 39.4-88 88 39.4 88 88 88z m0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z" /></svg>',
        audio:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1zM512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168z m-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92V232z" /></svg>',
        video:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M912 302.3L784 376V224c0-35.3-28.7-64-64-64H128c-35.3 0-64 28.7-64 64v576c0 35.3 28.7 64 64 64h592c35.3 0 64-28.7 64-64V648l128 73.7c21.3 12.3 48-3.1 48-27.6V330c0-24.6-26.7-40-48-27.7zM712 792H136V232h576v560z m176-167l-104-59.8V458.9L888 399v226zM208 360h112c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H208c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z" /></svg>',
        link:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox="0 0 1024 1024"><path d="M574 665.4c-3.1-3.1-8.2-3.1-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8c-3.1-3.1-8.2-3.1-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zM832.6 191.4c-84.6-84.6-221.5-84.6-306 0L410.3 307.6c-3.1 3.1-3.1 8.2 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6c-3.1 3.1-3.1 8.2 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3c-3.1-3.1-8.2-3.1-11.3 0L372.3 598.7c-3.1 3.1-3.1 8.2 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z" /></svg>',
        unlink:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.74 15.72"><g><path d="M13.05,13.63a.24.24,0,0,1,.15.22L13.42,16a.19.19,0,0,1-.08.18l-2.12,2.14a4.08,4.08,0,0,1-1.29.85A4,4,0,0,1,4.71,17a3.92,3.92,0,0,1-.3-1.52A4,4,0,0,1,4.71,14a3.91,3.91,0,0,1,.87-1.3L7.7,10.56a.25.25,0,0,1,.2-.06l2.17.22a.21.21,0,0,1,.19.15.24.24,0,0,1,0,.25L7.12,14.23a1.81,1.81,0,0,0,0,2.58,1.78,1.78,0,0,0,1.29.52,1.74,1.74,0,0,0,1.28-.52L12.8,13.7a.24.24,0,0,1,.25-.07ZM19,4.92a4,4,0,0,1,0,5.66L16.86,12.7a.25.25,0,0,1-.17.08l-2.2-.23a.21.21,0,0,1-.19-.15.22.22,0,0,1,0-.25L17.44,9a1.81,1.81,0,0,0,0-2.58,1.78,1.78,0,0,0-1.29-.52,1.74,1.74,0,0,0-1.28.52L11.76,9.57a.21.21,0,0,1-.25,0,.24.24,0,0,1-.16-.21l-.22-2.17a.19.19,0,0,1,.08-.18l2.12-2.14a4.08,4.08,0,0,1,1.29-.85,4.05,4.05,0,0,1,3.06,0,3.85,3.85,0,0,1,1.3.85ZM5.84,9.82a.25.25,0,0,1-.18-.08.19.19,0,0,1-.07-.19l.11-.77a.2.2,0,0,1,.11-.17.24.24,0,0,1,.2,0l2.5.72a.25.25,0,0,1,.15.27.22.22,0,0,1-.23.21l-2.59,0Zm4.12-2-.73-2.5a.27.27,0,0,1,0-.2A.21.21,0,0,1,9.41,5L10.19,5a.25.25,0,0,1,.19,0,.23.23,0,0,1,.08.18l-.05,2.61a.2.2,0,0,1-.19.23h0A.22.22,0,0,1,10,7.85Zm8.76,5.58a.25.25,0,0,1,.18.08.23.23,0,0,1,.06.2l-.11.77a.25.25,0,0,1-.11.17.21.21,0,0,1-.12,0l-.08,0L16,14a.25.25,0,0,1-.15-.27.22.22,0,0,1,.22-.21l1.29,0,1.33,0Zm-4.12,2,.74,2.51a.28.28,0,0,1,0,.2.23.23,0,0,1-.18.11l-.8.11a.23.23,0,0,1-.17-.07.25.25,0,0,1-.08-.18l0-2.61a.22.22,0,0,1,.22-.22.21.21,0,0,1,.26.15Z" transform="translate(-4.41 -3.77)"/></g></svg>',
        math:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 11.81 15.73"><g><path d="M17.19,5.73a1,1,0,0,0,.71-.29,1,1,0,0,0,.28-.7,1,1,0,0,0-1-1H7.35a1,1,0,0,0-1,1,.77.77,0,0,0,.13.47h0l4.58,6.43L6.68,17.81a1.25,1.25,0,0,0-.29.71.94.94,0,0,0,.28.7.92.92,0,0,0,.69.28H17.2a1,1,0,0,0,.71-.28,1,1,0,0,0,0-1.39.92.92,0,0,0-.71-.29H9.26l3.87-5.43a.86.86,0,0,0,0-.95L9.26,5.73h7.93Z" transform="translate(-6.38 -3.77)"/></g></svg>',
        table_header:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.75 15.74"><g><path d="M17,19.5v-.78H15.5v.78H17Zm-3,0v-.78H12.5v.78H14Zm-3,0v-.78H9.53v.78H11Zm-3,0v-.78H6.53v.78H8Zm10.55,0a1.73,1.73,0,0,0,.85-.35,1.67,1.67,0,0,0,.56-.76l-.71-.31a1.21,1.21,0,0,1-.35.4,1.34,1.34,0,0,1-.53.23l.08.38c.06.24.09.38.1.41Zm-13.7-.63.55-.55A.77.77,0,0,1,5.25,18a1.31,1.31,0,0,1-.06-.38v-.38H4.41v.38a2,2,0,0,0,.12.68,1.6,1.6,0,0,0,.35.57Zm15.27-2.12V15.26h-.78v1.49h.78Zm-15-1V14.23H4.41v1.49h.78Zm15-2V12.26h-.78v1.49h.78Zm-15-1V11.22H4.41v1.51h.78Zm15-2V9.26h-.78v1.51h.78Zm-15-1V8.17H4.41V9.74h.78Zm15-2V6.28h-.78V7.77h.78Zm-15-1.11V5.33L4.48,5.1a.77.77,0,0,0-.07.27,2.72,2.72,0,0,0,0,.28v1h.79ZM19.21,5l.63-.4A1.62,1.62,0,0,0,19.16,4a1.94,1.94,0,0,0-.91-.22v.78a1.31,1.31,0,0,1,.56.12.88.88,0,0,1,.4.36ZM6,4.54H7.78V3.76H6a.82.82,0,0,0-.28.06l.12.35c.07.21.1.33.11.36Zm10.8,0V3.76H15.28v.78h1.49Zm-3,0V3.76H12.28v.78h1.49Zm-3,0V3.76H9.28v.78h1.51ZM6,10.84h12.6V6.91H6Z" transform="translate(-4.4 -3.76)"/></g></svg>',
        merge_cell:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.76 15.74"><g><path d="M18.92,13.5h1.23v4.15A1.84,1.84,0,0,1,18.3,19.5H14V18.27H18.3a.6.6,0,0,0,.44-.18.59.59,0,0,0,.18-.44V13.5ZM18.3,3.76a1.84,1.84,0,0,1,1.85,1.85V9.82H18.92V5.6a.6.6,0,0,0-.18-.44A.59.59,0,0,0,18.3,5H14V3.76H18.3Zm1.85,8.51H15.6L17.26,14l-.86.86-3.14-3.17L16.4,8.51l.86.86L15.62,11h4.54v1.24Zm-13.9,6h4.27V19.5H6.25A1.84,1.84,0,0,1,4.4,17.65V13.5H5.63v4.15a.61.61,0,0,0,.62.62Zm0-14.51h4.27V5H6.25a.6.6,0,0,0-.44.18.57.57,0,0,0-.17.43V9.81H4.41V5.6A1.83,1.83,0,0,1,6.25,3.76Zm5,7.9L8.15,14.83,7.3,14,9,12.27H4.41V11H8.94L7.3,9.38,7.73,9l.43-.43Z" transform="translate(-4.4 -3.76)"/></g></svg>',
        split_cell:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.75 15.74"><g><path d="M10.37,12.25H6.74L8.4,13.94l-.87.86L4.41,11.63,7.53,8.5l.87.86L6.74,11h3.62v1.23Zm9.78-.61L17,14.81,16.13,14l1.66-1.69H14.16V11h3.63L16.13,9.37l.43-.43A5.24,5.24,0,0,1,17,8.51ZM18.9,8.22V5.61a.57.57,0,0,0-.18-.43A.65.65,0,0,0,18.29,5H12.88V18.28h5.41a.7.7,0,0,0,.44-.18.57.57,0,0,0,.18-.43V15h1.23v2.64a1.84,1.84,0,0,1-1.85,1.83h-12A1.84,1.84,0,0,1,4.94,19a1.81,1.81,0,0,1-.54-1.29V15H5.63v2.64a.57.57,0,0,0,.18.43.67.67,0,0,0,.44.18h5.41V5H6.25a.7.7,0,0,0-.44.18.56.56,0,0,0-.17.43V8.22H4.41V5.61A1.8,1.8,0,0,1,5,4.31a1.91,1.91,0,0,1,1.31-.55h12a1.89,1.89,0,0,1,1.31.55,1.8,1.8,0,0,1,.54,1.3V8.23H18.9Z" transform="translate(-4.4 -3.76)"/></g></svg>',
        caption:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.74 13.79"><g><path d="M4.41,18.52H20.15v-2H4.41ZM20,4.73H18.07V6h.65v.65H20V4.73ZM17,6V4.73H14.55V6H17ZM13.49,6V4.73H11V6h2.47ZM10,6V4.73H7.5V6H10ZM5.79,6h.65V4.73H4.5V6.67H5.8V6ZM4.5,11.34H5.79V8.48H4.5ZM6.44,13.8H5.79v-.65H4.5v1.94H6.44ZM17,15.09V13.8H14.55v1.29H17Zm-3.52,0V13.8H11v1.29h2.47Zm-3.53,0V13.8H7.5v1.29H10ZM20,13.16H18.72v.65h-.65V15.1H20Zm-1.29-1.82H20V8.48h-1.3v2.86Z" transform="translate(-4.41 -4.73)"/></g></svg>',
        edit:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.74 15.73"><g><path d="M7.51,5.68h6l1.52-1.57H6.94a2.4,2.4,0,0,0-1.79.82A2.8,2.8,0,0,0,4.41,6.8V17a2.55,2.55,0,0,0,.75,1.8A2.48,2.48,0,0,0,7,19.5H17.22a2.57,2.57,0,0,0,1.83-.74,2.52,2.52,0,0,0,.77-1.8V8.83l-1.58,1.54v6a1.54,1.54,0,0,1-1.53,1.53H7.51A1.54,1.54,0,0,1,6,16.41V7.21A1.52,1.52,0,0,1,7.51,5.68Zm5.63,7.47h0L10.7,10.74l-1,3.38,1.71-.48,1.7-.49Zm.34-.34h0l5.36-5.32L16.4,5.08,11,10.4l1.23,1.21,1.21,1.2ZM19.93,6.4a.82.82,0,0,0,.22-.48A.54.54,0,0,0,20,5.47L18.45,4A.67.67,0,0,0,18,3.77a.7.7,0,0,0-.48.21l-.74.72,2.44,2.43.37-.37.35-.36Z" transform="translate(-4.41 -3.77)"/></g></svg>',
        delete:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.73 15.74"><g><path d="M19.16,6.71a.94.94,0,0,0,.69-.28.91.91,0,0,0,.29-.68A1,1,0,0,0,19.85,5a.93.93,0,0,0-.69-.3H14.24A.94.94,0,0,0,14,4.06a.92.92,0,0,0-.7-.3h-2a1,1,0,0,0-.7.3.93.93,0,0,0-.28.68H5.39A.92.92,0,0,0,4.7,5a1,1,0,0,0-.29.71.91.91,0,0,0,.29.68,1,1,0,0,0,.69.28H19.16Zm-12.79,1a1,1,0,0,0-.7.3.94.94,0,0,0-.28.69v8.85A1.88,1.88,0,0,0,6,18.93a1.9,1.9,0,0,0,1.39.57H17.2a1.87,1.87,0,0,0,1.39-.58,1.91,1.91,0,0,0,.58-1.39V8.68A1,1,0,0,0,18.88,8a.89.89,0,0,0-.7-.29,1,1,0,0,0-.69.29.92.92,0,0,0-.29.68v7.87a1,1,0,0,1-1,1H8.34a.94.94,0,0,1-.69-.28,1,1,0,0,1-.29-.71V8.68a1,1,0,0,0-1-1Z" transform="translate(-4.41 -3.76)"/></g></svg>',
        modify:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.7 15.74"><g><path d="M19.79,15.23a.66.66,0,0,1,.3.38.59.59,0,0,1-.07.48l-.8,1.38a.66.66,0,0,1-.38.3.59.59,0,0,1-.48-.07l-.68-.38a4.55,4.55,0,0,1-1.34.77v.78a.64.64,0,0,1-.18.45.61.61,0,0,1-.45.18h-1.6a.6.6,0,0,1-.44-.18.66.66,0,0,1-.19-.45v-.78a4.36,4.36,0,0,1-1.32-.77l-.69.38a.58.58,0,0,1-.48.07.66.66,0,0,1-.38-.3l-.38-.66h.83a1.77,1.77,0,0,0,1.23-.52,1.72,1.72,0,0,0,.51-1.23v-.18a3,3,0,0,0,.49-.28l.15.09a1.83,1.83,0,0,0,.88.23A1.75,1.75,0,0,0,15.84,14l.88-1.52a1.7,1.7,0,0,0,.17-1.32,1.66,1.66,0,0,0-.3-.61,1.84,1.84,0,0,0-.51-.45l-.15-.09,0-.29,0-.28.15-.09a1,1,0,0,0,.26-.18l0,.06v.78a4.34,4.34,0,0,1,1.34.77l.68-.38a.68.68,0,0,1,.48-.06.64.64,0,0,1,.38.29l.8,1.38a.58.58,0,0,1,.07.48.63.63,0,0,1-.3.38l-.68.4a3.84,3.84,0,0,1,.08.76,4.13,4.13,0,0,1-.08.78l.34.18.32.2ZM10.17,7.86a1.9,1.9,0,0,1,1.35,3.23,1.85,1.85,0,0,1-1.35.55A1.9,1.9,0,0,1,8.83,8.41a1.92,1.92,0,0,1,1.34-.55Zm1.58,7.2a.73.73,0,0,1-.21.49.66.66,0,0,1-.48.2H9.29a.68.68,0,0,1-.69-.69V14.2a4.75,4.75,0,0,1-1.48-.86l-.75.45a.73.73,0,0,1-.7,0,.63.63,0,0,1-.25-.26L4.54,12a.67.67,0,0,1-.08-.53.71.71,0,0,1,.32-.42l.75-.43a4.8,4.8,0,0,1-.08-.85,4.71,4.71,0,0,1,.08-.85l-.74-.44a.71.71,0,0,1-.32-.42.65.65,0,0,1,.07-.54L5.42,6a.66.66,0,0,1,.42-.32l.18,0a.73.73,0,0,1,.35.09l.75.43A4.68,4.68,0,0,1,8.6,5.33V4.45a.68.68,0,0,1,.69-.69h1.77a.64.64,0,0,1,.48.2.73.73,0,0,1,.21.49v.88a4.75,4.75,0,0,1,1.48.85L14,5.75a.67.67,0,0,1,.34-.09l.18,0a.71.71,0,0,1,.42.32l.89,1.54a.67.67,0,0,1,.06.52.73.73,0,0,1-.32.43l-.75.42a4.8,4.8,0,0,1,.08.85,4.71,4.71,0,0,1-.08.85l.75.43a.66.66,0,0,1,.32.42.73.73,0,0,1-.06.54l-.89,1.52a.69.69,0,0,1-.25.26.7.7,0,0,1-.35.09.64.64,0,0,1-.34-.09l-.75-.45a4.87,4.87,0,0,1-1.48.86v.87ZM7.23,9.75a3,3,0,0,0,.86,2.08,2.94,2.94,0,1,0,4.16-4.16,3,3,0,0,0-2.08-.85A2.94,2.94,0,0,0,7.23,9.75Z" transform="translate(-4.44 -3.76)"/></g></svg>',
        revert:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.76 14.69"><g><path d="M18.26,15V12.3l1.89-2V15a2.58,2.58,0,0,1-.24,1c-.2.58-.75.92-1.65,1H7.56v2L4.41,15.63,7.56,13v2h10.7ZM6.3,8.28V11L4.41,13V8.28a2.58,2.58,0,0,1,.24-1c.2-.58.75-.92,1.65-1H17v-2l3.15,3.34L17,10.3v-2H6.3Z" transform="translate(-4.4 -4.28)"/></g></svg>',
        auto_size:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.74 15.74"><g><path d="M6.71,17.19,6.89,16l1.21-.15A6,6,0,0,1,6.81,13.9a5.78,5.78,0,0,1-.45-2.27A6,6,0,0,1,8.1,7.45a5.83,5.83,0,0,1,4.17-1.73l1-1-1-1A7.89,7.89,0,0,0,5,14.64a7.73,7.73,0,0,0,1.71,2.55Zm5.57,2.31h0A7.86,7.86,0,0,0,17.85,6.07L17.67,7.3l-1.21.15a5.9,5.9,0,0,1,1.29,1.92,5.81,5.81,0,0,1,.45,2.26,5.91,5.91,0,0,1-5.9,5.9l-1,1,.49.49.47.5Z" transform="translate(-4.41 -3.76)"/></g></svg>',
        insert_row_below:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M15.7,1.3c-0.1-0.1-0.1-0.2-0.2-0.2L15.3,1H0.4L0.3,1.1c0,0-0.1,0.1-0.1,0.1c0,0-0.1,0.1-0.1,0.1L0,1.4v7.7l0.1,0.1c0,0.1,0.1,0.1,0.2,0.2l0.1,0.1h2.3V9.3l0.1-0.5L3,8.5l0.1-0.2c-0.1,0-0.2,0-0.3,0H1.2v-6h13.3v6h-1.6c-0.1,0-0.2,0-0.3,0l0.1,0.2l0.2,0.4C12.9,9,13,9.2,13,9.3v0.1h2.3l0.2-0.1c0.1,0,0.1-0.1,0.2-0.2l0.1-0.1V1.4L15.7,1.3z"/><path d="M10.5,7.5C9.9,7.1,9.3,6.8,8.6,6.7c-0.2,0-0.5-0.1-0.7,0c-0.2,0-0.5,0-0.7,0C6.6,6.7,6.1,6.9,5.6,7.3C5.2,7.6,4.7,8,4.4,8.4C4.3,8.6,4.2,8.8,4.2,8.9C4.1,9.1,4,9.3,3.9,9.4C3.9,9.6,3.8,9.7,3.8,9.9c0,0.2-0.1,0.3-0.1,0.5v-0.1c-0.1,0.8,0.1,1.6,0.5,2.4c0.4,0.7,1,1.3,1.7,1.7c0.3,0.2,0.6,0.3,0.9,0.3c0.3,0.1,0.7,0.1,1,0.1c0.3,0,0.7,0,1-0.1c0.3-0.1,0.6-0.2,0.9-0.3c0.5-0.3,0.9-0.6,1.3-1c0.3-0.4,0.6-0.8,0.8-1.3c0.1-0.4,0.2-0.9,0.2-1.4c0-0.5-0.1-1-0.3-1.4C11.5,8.6,11.1,8,10.5,7.5z M10.1,11.3H8.5v1.6H8H7.9H7.3v0v-0.1v-1.4H5.7v-0.4v-0.2v-0.6h0h1.5V8.5h1.2v1.6h1.6V11.3z"/></g></svg>',
        insert_row_above:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M0.1,14.5c0.1,0.1,0.1,0.2,0.2,0.2l0.1,0.1h14.9l0.1-0.1c0,0,0.1-0.1,0.1-0.1c0,0,0.1-0.1,0.1-0.1l0.1-0.1V6.7l-0.1-0.1c0-0.1-0.1-0.1-0.2-0.2l-0.1-0.1h-2.3v0.1l-0.1,0.5l-0.2,0.4l-0.1,0.2c0.1,0,0.2,0,0.3,0h1.6v6H1.3v-6h1.6c0.1,0,0.2,0,0.3,0L3.1,7.3L2.9,6.9C2.8,6.8,2.8,6.6,2.7,6.5V6.3H0.4L0.3,6.4c-0.1,0-0.1,0.1-0.2,0.2L0,6.7v7.7L0.1,14.5z"/><path d="M5.3,8.3c0.6,0.5,1.2,0.8,1.9,0.9c0.2,0,0.5,0.1,0.7,0c0.2,0,0.5,0,0.7,0c0.6-0.1,1.1-0.3,1.6-0.6c0.5-0.3,0.9-0.7,1.2-1.2c0.1-0.2,0.2-0.3,0.3-0.5c0.1-0.2,0.2-0.4,0.2-0.5c0.1-0.1,0.1-0.3,0.1-0.4C12,5.8,12,5.6,12,5.4v0.1c0.1-0.8-0.1-1.6-0.5-2.4c-0.4-0.7-1-1.3-1.7-1.7C9.5,1.3,9.2,1.2,8.9,1.1C8.5,1,8.2,1,7.9,1c-0.3,0-0.7,0-1,0.1C6.6,1.2,6.3,1.3,6,1.4C5.5,1.7,5.1,2,4.7,2.4C4.4,2.8,4.1,3.3,3.9,3.8C3.8,4.2,3.7,4.7,3.7,5.2c0,0.5,0.1,1,0.3,1.4C4.3,7.2,4.7,7.8,5.3,8.3z M5.7,4.5h1.6V2.9h0.5h0.1h0.6v0v0.1v1.4H10v0.4v0.2v0.6h0H8.5v1.6H7.3V5.7H5.7V4.5z"/></g></svg>',
        insert_column_left:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M14.5,15.7c0.1-0.1,0.2-0.1,0.2-0.2l0.1-0.1V0.4l-0.1-0.1c0,0-0.1-0.1-0.1-0.1c0,0-0.1-0.1-0.1-0.1L14.4,0H6.7L6.6,0.1c-0.1,0-0.1,0.1-0.2,0.2L6.3,0.4v2.3h0.1l0.5,0.1L7.3,3l0.2,0.1c0-0.1,0-0.2,0-0.3V1.2h6v13.3h-6v-1.6c0-0.1,0-0.2,0-0.3l-0.2,0.1l-0.4,0.2C6.7,12.9,6.6,13,6.4,13H6.3v2.3l0.1,0.2c0,0.1,0.1,0.1,0.2,0.2l0.1,0.1h7.7L14.5,15.7z"/><path d="M8.3,10.5C8.7,10,9,9.3,9.1,8.6c0-0.2,0.1-0.5,0-0.7c0-0.2,0-0.5,0-0.7C9,6.7,8.8,6.1,8.5,5.7C8.2,5.2,7.8,4.8,7.3,4.5C7.2,4.4,7,4.3,6.9,4.2C6.7,4.1,6.5,4,6.4,4C6.2,3.9,6.1,3.9,5.9,3.8c-0.2,0-0.3-0.1-0.5-0.1h0.1C4.7,3.7,3.8,3.9,3.1,4.3C2.4,4.7,1.8,5.3,1.4,6C1.3,6.3,1.2,6.6,1.1,6.9C1,7.2,1,7.6,1,7.9c0,0.3,0,0.7,0.1,1c0.1,0.3,0.2,0.6,0.3,0.9c0.3,0.5,0.6,0.9,1,1.3c0.4,0.3,0.8,0.6,1.3,0.8C4.2,12,4.7,12.1,5.1,12c0.5,0,1-0.1,1.4-0.3C7.2,11.5,7.8,11.1,8.3,10.5zM4.5,10.1V8.5H2.9V8V7.9V7.3h0H3h1.4V5.7h0.4h0.2h0.6v0v1.5h1.6v1.2H5.7v1.6H4.5z"/></g></svg>',
        insert_column_right:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M1.3,0.1C1.2,0.2,1.1,0.2,1.1,0.3L1,0.4v14.9l0.1,0.1c0,0,0.1,0.1,0.1,0.1c0,0,0.1,0.1,0.1,0.1l0.1,0.1h7.7l0.1-0.1c0.1,0,0.1-0.1,0.2-0.2l0.1-0.1v-2.3H9.3l-0.5-0.1l-0.4-0.2l-0.2-0.1c0,0.1,0,0.2,0,0.3v1.6h-6V1.3h6v1.6c0,0.1,0,0.2,0,0.3l0.2-0.1l0.4-0.2C9,2.9,9.2,2.8,9.3,2.8h0.1V0.5L9.4,0.3c0-0.1-0.1-0.1-0.2-0.2L9.1,0H1.4L1.3,0.1z"/><path d="M7.5,5.3C7,5.8,6.7,6.5,6.6,7.2c0,0.2-0.1,0.5,0,0.7c0,0.2,0,0.5,0,0.7c0.1,0.6,0.3,1.1,0.6,1.6c0.3,0.5,0.7,0.9,1.2,1.2c0.2,0.1,0.3,0.2,0.5,0.3c0.2,0.1,0.4,0.2,0.5,0.2c0.1,0.1,0.3,0.1,0.4,0.1c0.2,0,0.3,0.1,0.5,0.1h-0.1c0.8,0.1,1.6-0.1,2.4-0.5c0.7-0.4,1.3-1,1.7-1.7c0.2-0.3,0.3-0.6,0.3-0.9c0.1-0.3,0.1-0.7,0.1-1c0-0.3,0-0.7-0.1-1c-0.1-0.3-0.2-0.6-0.3-0.9c-0.3-0.5-0.6-0.9-1-1.3C13,4.4,12.5,4.2,12,4c-0.4-0.1-0.9-0.2-1.4-0.2c-0.5,0-1,0.1-1.4,0.2C8.5,4.3,7.9,4.7,7.5,5.3z M11.3,5.7v1.6h1.6v0.5v0.1v0.6h0h-0.1h-1.4v1.6h-0.4h-0.2h-0.6v0V8.5H8.5V7.3h1.6V5.7H11.3z"/></g></svg>',
        delete_row:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.75 13.83"><g><path d="M4.7,18.46l.12.08H19.73l.12-.08a.58.58,0,0,0,.22-.22l.08-.12,0-7.69-.08-.11a.77.77,0,0,0-.18-.18l-.11-.08-2.31,0-.08.28-.1.29a1.58,1.58,0,0,1-.12.29l-.14.34s0,0,.18,0H18.9v6H5.64v-6H7.35c.14,0,.2,0,.18,0l-.14-.34a2.85,2.85,0,0,1-.12-.29l-.1-.29-.07-.27-2.31,0-.11.08a.77.77,0,0,0-.18.18l-.08.11,0,7.69.08.12a.47.47,0,0,0,.09.12l.13.09ZM12.11,13a4,4,0,0,0,1.46-.21,4.51,4.51,0,0,0,1.31-.71A4,4,0,0,0,16.26,10a4.32,4.32,0,0,0-.08-2.54,4.34,4.34,0,0,0-1-1.52,4.15,4.15,0,0,0-1.54-1,4.34,4.34,0,0,0-1.35-.22A4.07,4.07,0,0,0,11,4.93,3.94,3.94,0,0,0,9.24,6.07,3.92,3.92,0,0,0,8.15,8.88a3.91,3.91,0,0,0,.12.95A4.16,4.16,0,0,0,12.11,13Zm2.35-4.14v.58H10.09V8.27h4.37v.58Z" transform="translate(-4.4 -4.71)"/></g></svg>',
        delete_column:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 13.81 15.74"><g><path d="M5.66,19.42l.12.08,7.69,0,.11-.08a.77.77,0,0,0,.18-.18l.08-.11,0-2.32-.15,0-.45-.15-.42-.18-.17-.07a1,1,0,0,0,0,.27v1.63h-6V5h6V6.62a.9.9,0,0,0,0,.26l.17-.07.42-.17a3.91,3.91,0,0,1,.45-.15l.15,0,0-2.32L13.75,4a.77.77,0,0,0-.18-.18l-.11-.08H5.79l-.13.07a.63.63,0,0,0-.21.22l-.08.12V19.08l.08.12a.47.47,0,0,0,.09.12.35.35,0,0,0,.12.1Zm9-3.67a4.16,4.16,0,0,0,2.36-.51,4.08,4.08,0,0,0,1.67-1.72,4,4,0,0,0,.35-.91,3.79,3.79,0,0,0,.1-1,4.71,4.71,0,0,0-.11-1,5,5,0,0,0-.3-.87,4.25,4.25,0,0,0-1-1.25,4.49,4.49,0,0,0-1.34-.81A4.26,4.26,0,0,0,15,7.48a3.88,3.88,0,0,0-1.41.25A4.32,4.32,0,0,0,11.86,9,4,4,0,0,0,11,10.94a4.4,4.4,0,0,0-.05.68,4.5,4.5,0,0,0,.05.68,3.93,3.93,0,0,0,.61,1.57,4.22,4.22,0,0,0,1.18,1.2,4.59,4.59,0,0,0,.48.27c.2.1.37.17.5.22a2.44,2.44,0,0,0,.45.12,4.61,4.61,0,0,0,.5.07Zm2.54-4.12v.58H12.87V11h4.37v.59Z" transform="translate(-5.37 -3.76)"/></g></svg>',
        fixed_column_width:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 24 24"><path d="M6,5H18A1,1 0 0,1 19,6A1,1 0 0,1 18,7H6A1,1 0 0,1 5,6A1,1 0 0,1 6,5M21,2V4H3V2H21M15,8H17V22H15V8M7,8H9V22H7V8M11,8H13V22H11V8Z" /></svg>',
        rotate_left:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M0.5,10.2c0,0.1,0,0.2,0,0.3v0.2l0,0c0.1,0.3,0.3,0.6,0.4,0.9l0,0C1,11.8,1.3,12,1.5,11.9h0.1h0.2h0.1c0.1-0.1,0.3-0.3,0.4-0.5v-0.2c0-0.1,0-0.2-0.1-0.3l0,0c-0.2-0.2-0.3-0.4-0.3-0.7l0,0C1.8,10,1.7,9.9,1.5,9.8c-0.1,0-0.2,0-0.3,0H0.9C0.7,9.9,0.6,10,0.5,10.2L0.5,10.2z"/><path d="M2.2,11.5L2.2,11.5L2.2,11.5z"/><path d="M5.9,3.6L5.9,3.6L5.9,3.6z"/><path d="M0.1,7.9c0,0.3,0,0.6,0,0.9l0,0l0,0l0,0l0,0c0,0.2,0.1,0.3,0.2,0.4l0,0c0.2,0.1,0.3,0.2,0.5,0.2l0,0l0,0c0.2,0,0.4-0.1,0.5-0.3l0,0c0-0.1,0.1-0.3,0.1-0.4V8.6l0,0c0-0.2,0-0.5,0-0.7l0,0c0-0.2-0.1-0.4-0.2-0.5C1.1,7.3,0.9,7.2,0.7,7.2S0.3,7.3,0.2,7.4C0.1,7.5,0,7.7,0.1,7.9z"/><path d="M1.9,12.7L1.9,12.7c0,0.2,0,0.4,0.2,0.5l0,0l0.2,0.3l0,0c0.2,0.1,0.3,0.2,0.5,0.4l0,0l0,0l0,0l0,0C2.9,14,3,14.1,3.2,14.1s0.4-0.1,0.5-0.2c0.1-0.2,0.2-0.3,0.2-0.5v-0.1c0-0.2-0.1-0.4-0.2-0.5l0,0l-0.4-0.4l-0.2-0.2l0,0C3,12.1,2.8,12,2.6,12l0,0c-0.2,0-0.4,0.1-0.5,0.2l0,0C2,12.3,1.9,12.5,1.9,12.7z"/><path d="M6.6,15c0,0.2,0.1,0.4,0.2,0.5c0.1,0.1,0.2,0.2,0.4,0.3l0,0c0.3,0,0.5,0,0.7,0h0.3l0,0c0.2,0,0.4-0.1,0.5-0.2c0.1-0.2,0.2-0.3,0.2-0.5l0,0l0,0c0-0.2-0.1-0.4-0.2-0.5l0,0c-0.1-0.1-0.3-0.2-0.5-0.2l0,0H7.9c-0.1,0-0.3,0-0.5,0l0,0H7.3c-0.2-0.1-0.3,0-0.5,0.1l0,0C6.7,14.6,6.6,14.8,6.6,15L6.6,15L6.6,15L6.6,15z"/><path d="M4.2,7.4C4,7.5,4,7.7,4,7.9c0,0.2,0,0.4,0.2,0.5l0,0l3.2,3.2l0,0c0.1,0.1,0.3,0.2,0.5,0.2s0.3-0.1,0.5-0.2l0,0l3.2-3.2l0,0c0.1-0.1,0.2-0.3,0.2-0.5c0-0.2-0.1-0.4-0.2-0.5l0,0C11.5,7.3,11,6.7,10,5.8l0,0L8.4,4.2l0,0C8.3,4.1,8.1,4,7.9,4S7.5,4.1,7.4,4.2L4.2,7.4L4.2,7.4z M6.8,9L5.7,7.9l2.2-2.2l2.3,2.2l-2.3,2.2C7.7,9.9,7.3,9.5,6.8,9L6.8,9z"/><path d="M4.1,14.1C4,14.2,4,14.3,4,14.4v0.2l0,0c0.1,0.1,0.2,0.3,0.4,0.4l0,0c0.3,0.1,0.6,0.2,0.9,0.4h0.1h0.1l0,0c0.2,0,0.3-0.1,0.5-0.1l0,0c0.2-0.1,0.3-0.3,0.3-0.4l0,0l0,0l0,0l0,0v-0.2c0-0.1-0.1-0.2-0.1-0.3l0,0C6.1,14.2,6,14.1,5.8,14l0,0c-0.3-0.1-0.5-0.2-0.8-0.2l0,0c-0.1-0.1-0.2-0.1-0.3-0.1H4.5C4.3,13.7,4.2,13.9,4.1,14.1z"/><path d="M9.3,14.4c0,0.1-0.1,0.3,0,0.4V15l0,0c0,0.1,0.1,0.3,0.5,0.4c0.1,0.1,0.3,0.1,0.4,0.1l0,0h0.1l0,0c0.3-0.1,0.6-0.2,0.9-0.3l0,0c0.1-0.1,0.2-0.2,0.3-0.4l0.1-0.3c0-0.1-0.1-0.2-0.1-0.3l0,0c-0.1-0.2-0.2-0.3-0.4-0.4l0,0h-0.3c-0.1,0-0.2,0-0.3,0l0,0c-0.2,0.1-0.5,0.2-0.8,0.3l0,0C9.5,14.1,9.4,14.2,9.3,14.4L9.3,14.4z"/><path d="M11.4,14.7L11.4,14.7L11.4,14.7z"/><path d="M9.5,15.3L9.5,15.3L9.5,15.3z"/><path d="M15.9,7.9c0-1-0.2-2-0.6-3l0,0c-0.4-1-1-1.9-1.7-2.6C12.8,1.6,12,1,11,0.6l0,0C10.1,0.2,9,0,8,0C7.3,0,6.5,0.1,5.8,0.3l0,0C5.2,0.5,4.6,0.8,4,1.1L3.1,0.2l0,0C2.9,0.1,2.8,0,2.6,0H2.4l0,0C2.2,0,2,0.2,1.9,0.4l0,0L0.1,4.9l0,0C0,5,0,5.1,0,5.2c0,0.2,0.1,0.4,0.2,0.5l0,0c0.2,0.1,0.3,0.2,0.5,0.2h0.1H1l0,0l4.7-1.8l0,0C5.9,4,6.1,3.8,6.1,3.6V3.4C6.1,3.2,6,3,5.9,2.9l0,0L5.1,2.1c0.4-0.2,0.8-0.4,1.3-0.5c0.5-0.1,1.1-0.2,1.7-0.2c0.9,0,1.7,0.2,2.5,0.5l0,0c0.8,0.3,1.5,0.8,2.1,1.4c0.6,0.6,1.1,1.3,1.4,2.1l0,0c0.3,0.8,0.5,1.6,0.5,2.5s-0.2,1.7-0.5,2.5l0,0c-0.3,0.8-0.8,1.5-1.4,2.1c-0.2,0.2-0.4,0.3-0.6,0.5l0,0c-0.2,0.1-0.3,0.3-0.3,0.5v0.1c0,0.1,0,0.3,0.1,0.4l0,0c0.1,0.2,0.3,0.3,0.5,0.3l0,0c0.1,0,0.3-0.1,0.4-0.2l0,0l0,0l0,0l0,0c0.2-0.2,0.5-0.4,0.7-0.6l0,0l0,0l0,0l0,0c0.7-0.8,1.3-1.6,1.7-2.6C15.6,10,15.8,9,15.9,7.9z M1.9,4C2,3.8,2.1,3.5,2.3,3.1l0,0L2.7,2l1.2,1.2L1.9,4z"/><path d="M6.8,15.5L6.8,15.5L6.8,15.5z"/></g></svg>',
        rotate_right:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.8 15.8"><g><path d="M9.9,15.3L9.9,15.3L9.9,15.3z"/><path d="M6.9,15.1L6.9,15.1c0,0.1,0.1,0.3,0.2,0.4l0,0c0.1,0.2,0.3,0.3,0.5,0.3l0,0h0.3c0.2,0,0.4,0,0.7,0l0,0c0.2-0.1,0.3-0.2,0.4-0.3c0.1-0.1,0.2-0.2,0.2-0.4V15c0-0.2-0.1-0.4-0.2-0.4c-0.2-0.1-0.3-0.2-0.5-0.2H8.4l0,0c-0.1,0-0.3,0-0.5,0H7.6l0,0c-0.2,0-0.4,0.1-0.5,0.2C7,14.7,6.9,14.9,6.9,15.1z"/><path d="M6.5,14.4L6.5,14.4L6.5,14.4z"/><path d="M5.8,5.8L5.8,5.8c-1,0.9-1.5,1.5-1.7,1.6l0,0C4,7.5,4,7.7,4,7.9c0,0.2,0,0.4,0.2,0.5l0,0l3.2,3.2l0,0c0.2,0.1,0.3,0.2,0.5,0.2s0.4-0.1,0.5-0.2l0,0l3.2-3.2l0,0c0.1-0.1,0.2-0.3,0.2-0.5c0-0.2-0.1-0.4-0.2-0.5l0,0L8.4,4.2C8.3,4.1,8.1,4,7.9,4C7.7,4,7.5,4.1,7.4,4.2l0,0L5.8,5.8z M5.6,7.9l2.3-2.2l2.2,2.2L9,9l0,0l0,0l0,0l0,0c-0.5,0.6-0.9,0.9-1.1,1.1L5.6,7.9z"/><path d="M9,15.5L9,15.5L9,15.5z"/><path d="M9.6,14.7v0.2l0,0l0,0l0,0l0,0c0.1,0.2,0.1,0.3,0.3,0.3c0.1,0.1,0.3,0.1,0.4,0.1l0,0h0.1h0.1c0.3-0.1,0.6-0.3,0.9-0.4l0,0c0.1-0.1,0.2-0.2,0.3-0.4l0,0v-0.2c0-0.1,0-0.2-0.1-0.3c-0.1-0.2-0.2-0.3-0.4-0.4H11c-0.1,0-0.2,0.1-0.3,0.1l0,0c-0.2,0.1-0.4,0.2-0.7,0.3l0,0l0,0c-0.1,0.1-0.3,0.2-0.4,0.4C9.6,14.5,9.6,14.6,9.6,14.7z"/><path d="M9,14.5L9,14.5L9,14.5z"/><path d="M9.6,14.4L9.6,14.4L9.6,14.4z"/><path d="M11.7,14L11.7,14L11.7,14z"/><path d="M15.6,7.4L15.6,7.4L15.6,7.4z"/><path d="M15,9.4c0.2,0,0.4,0,0.6-0.2l0,0c0.1-0.1,0.2-0.2,0.2-0.4l0,0l0,0l0,0l0,0c0-0.3,0-0.6,0-0.9c0-0.2-0.1-0.4-0.2-0.5c-0.1-0.1-0.3-0.2-0.5-0.2s-0.4,0.1-0.5,0.2c-0.1,0.1-0.2,0.3-0.2,0.5l0,0c0,0.2,0,0.4,0,0.7l0,0v0.1c0,0.1,0,0.3,0.1,0.4l0,0C14.6,9.3,14.8,9.4,15,9.4L15,9.4L15,9.4z"/><path d="M14,12h0.1h0.2h0.1c0.2,0,0.5-0.2,0.6-0.4l0,0c0.2-0.3,0.3-0.6,0.4-0.9l0,0v-0.2c0-0.1-0.1-0.2-0.1-0.3c-0.1-0.2-0.2-0.3-0.4-0.4h-0.3c-0.1,0-0.2,0-0.3,0C14.2,9.9,14,10,14,10.3l0,0c-0.1,0.2-0.2,0.5-0.3,0.7l0,0c-0.1,0.1-0.1,0.2-0.1,0.3v0.2l0,0l0,0C13.6,11.6,13.8,11.8,14,12z"/><path d="M14.6,7.4L14.6,7.4L14.6,7.4z"/><path d="M4.4,14.2c-0.1,0.1-0.1,0.2-0.1,0.3l0.1,0.2c0,0.2,0.2,0.3,0.3,0.4l0,0c0.3,0.1,0.6,0.3,1.1,0.4l0,0h0.1l0,0c0.1,0,0.2-0.1,0.4-0.2c0.1,0,0.2-0.2,0.3-0.3l0,0v-0.2c0-0.1-0.1-0.3-0.2-0.4c-0.1-0.1-0.2-0.2-0.4-0.3l0,0c-0.2-0.1-0.5-0.2-0.7-0.3l0,0c-0.1,0-0.2,0-0.3,0H4.7l0,0C4.6,13.9,4.4,14,4.4,14.2L4.4,14.2z"/><path d="M11.9,13.3c0,0.2,0.1,0.4,0.2,0.6c0.1,0.1,0.3,0.2,0.5,0.2s0.4-0.1,0.5-0.2l0,0l0,0l0,0l0,0c0.1-0.1,0.3-0.3,0.4-0.4l0,0l0.2-0.3l0,0c0.1-0.2,0.2-0.3,0.2-0.5l0,0c0-0.2-0.1-0.4-0.2-0.5l0,0c-0.1-0.1-0.3-0.2-0.5-0.2l0,0c-0.2,0-0.4,0.1-0.5,0.2l0,0l-0.2,0.2l-0.4,0.4l0,0C12,13,11.9,13.1,11.9,13.3L11.9,13.3z"/><path d="M12.1,13.8L12.1,13.8L12.1,13.8z"/><path d="M11.9,13.3L11.9,13.3L11.9,13.3z"/><path d="M15.9,5.2c0-0.1-0.1-0.2-0.1-0.3l0,0L14,0.4l0,0C13.9,0.2,13.7,0,13.5,0l0,0l0,0h-0.2c-0.2,0-0.4,0.1-0.5,0.2l0,0l-0.9,0.9c-0.5-0.3-1.1-0.6-1.8-0.8l0,0C9.4,0.1,8.7,0,7.9,0c-1,0-2,0.2-3,0.6S3,1.6,2.3,2.3C1.6,3.1,1,3.9,0.6,4.9l0,0C0.2,5.8,0,6.8,0,7.9c0,1,0.2,2,0.6,3s0.9,1.8,1.7,2.6l0,0l0,0l0,0l0,0c0.2,0.2,0.5,0.4,0.7,0.6l0,0l0,0l0,0l0,0c0.2,0.1,0.3,0.2,0.5,0.2l0,0c0.2,0,0.4-0.1,0.6-0.3l0,0c0.1-0.1,0.1-0.3,0.1-0.4v-0.1l0,0C4.1,13.3,4,13.1,3.9,13l0,0c-0.2-0.1-0.4-0.3-0.6-0.5c-0.6-0.6-1.1-1.3-1.4-2.1l0,0C1.6,9.6,1.4,8.8,1.4,7.9s0.2-1.7,0.5-2.5l0,0c0.3-0.8,0.8-1.5,1.4-2.1c0.6-0.6,1.3-1.1,2.1-1.4l0,0C6.2,1.6,7,1.4,7.9,1.4c0.6,0,1.1,0.1,1.7,0.2c0.5,0.1,0.9,0.3,1.3,0.5l-0.8,0.8l0,0C10,3.1,9.9,3.2,9.9,3.4v0.2l0,0l0,0c0,0.2,0.2,0.4,0.4,0.5l0,0l4.5,1.8l0,0H15h0.1c0.2,0,0.4-0.1,0.5-0.2l0,0C15.7,5.6,15.8,5.4,15.9,5.2z M11.8,3.2L13,2l0.4,1.1l0,0c0.2,0.4,0.3,0.7,0.4,0.9L11.8,3.2z"/></g></svg>',
        mirror_horizontal:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 14.75 15.74"><g><path d="M13.75,3.76l5.9,15.74h-5.9V3.76ZM4.9,19.5,10.8,3.76V19.5H4.9Z" transform="translate(-4.9 -3.76)"/></g></svg>',
        mirror_vertical:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.74 14.75"><g><path d="M20.15,13.1,4.41,19V13.1H20.15ZM4.41,4.25l15.74,5.9H4.41V4.25Z" transform="translate(-4.41 -4.25)"/></g></svg>',
        checked:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.75 12.1"><g><path d="M4.59,12.23l.12.18L9.43,17.5a.58.58,0,0,0,.84,0L20,7.45h0a.58.58,0,0,0,0-.84l-.85-.85a.58.58,0,0,0-.84,0H18.2l-8.12,8.41a.29.29,0,0,1-.42,0l-3.4-3.63a.58.58,0,0,0-.84,0l-.85.85a.6.6,0,0,0-.14.21.51.51,0,0,0,0,.44c.05.06.1.13.16.19Z" transform="translate(-4.38 -5.58)"/></g></svg>',
        line_break:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 24 24"><path d="M19,6a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H7.41l1.3-1.29A1,1,0,0,0,7.29,9.29l-3,3a1,1,0,0,0-.21.33,1,1,0,0,0,0,.76,1,1,0,0,0,.21.33l3,3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L7.41,14H17a3,3,0,0,0,3-3V7A1,1,0,0,0,19,6Z"/></svg>',
        image_gallery:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="30 30 150 150"><g><path d="M152.775,120.548V51.651c0-12.271-9.984-22.254-22.254-22.254H43.727c-12.271,0-22.254,9.983-22.254,22.254v68.896c0,12.27,9.983,22.254,22.254,22.254h86.795C142.791,142.802,152.775,132.817,152.775,120.548z M36.394,51.651c0-4.042,3.291-7.333,7.333-7.333h86.795c4.042,0,7.332,3.291,7.332,7.333v23.917l-14.938-17.767c-1.41-1.678-3.487-2.649-5.68-2.658h-0.029c-2.184,0-4.255,0.954-5.674,2.613L76.709,98.519l-9.096-9.398c-1.427-1.474-3.392-2.291-5.448-2.273c-2.052,0.025-4.004,0.893-5.396,2.4L36.394,111.32V51.651z M41.684,127.585l20.697-22.416l9.312,9.622c1.461,1.511,3.489,2.334,5.592,2.27c2.101-0.066,4.075-1.013,5.44-2.612l34.436-40.308l20.693,24.613v21.794c0,4.042-3.29,7.332-7.332,7.332H43.727C43.018,127.88,42.334,127.775,41.684,127.585z M182.616,152.5V75.657c0-4.12-3.34-7.46-7.461-7.46c-4.119,0-7.46,3.34-7.46,7.46V152.5c0,4.112-3.347,7.46-7.461,7.46h-94c-4.119,0-7.46,3.339-7.46,7.459c0,4.123,3.341,7.462,7.46,7.462h94C172.576,174.881,182.616,164.841,182.616,152.5z"/></g></svg>',
        more_text:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="10 10 180 180"><g><path d="M49.711,142.188h49.027c2.328,0.002,4.394,1.492,5.129,3.699l9.742,29.252c0.363,1.092,1.385,1.828,2.537,1.83l15.883,0.01c0.859,0,1.667-0.412,2.17-1.109s0.641-1.594,0.37-2.41l-16.625-50.045L86.503,28.953c-0.36-1.097-1.383-1.839-2.537-1.842H64.532c-1.153-0.001-2.178,0.736-2.542,1.831L13.847,173.457c-0.271,0.816-0.135,1.713,0.369,2.412c0.503,0.697,1.311,1.109,2.171,1.109h15.872c1.151,0,2.173-0.736,2.537-1.828l9.793-29.287C45.325,143.66,47.39,142.18,49.711,142.188L49.711,142.188z M53.493,119.098l15.607-46.9c0.744-2.196,2.806-3.674,5.125-3.674s4.381,1.478,5.125,3.674l15.607,46.904c0.537,1.621,0.263,3.402-0.736,4.789c-1.018,1.408-2.649,2.24-4.386,2.24H58.615c-1.736,0-3.368-0.832-4.386-2.24C53.23,122.504,52.956,120.721,53.493,119.098L53.493,119.098z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.633,190.465,66.178,190.465,63.32L190.465,63.32z M190.465,101.994c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.887,1.026,5.352,3.056,7.395c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.994L190.465,101.994z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',
        more_paragraph:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="10 10 180 180"><g><path d="M128.39,28.499H63.493c-25.558,0-46.354,20.796-46.354,46.354c0,25.559,20.796,46.353,46.354,46.353h9.271v55.625h18.542V47.04h9.271V176.83h18.543V47.04h9.271V28.499z M72.764,102.664h-9.271c-15.337,0-27.813-12.475-27.813-27.812c0-15.336,12.476-27.813,27.813-27.813h9.271V102.664z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.633,190.465,66.178,190.465,63.32L190.465,63.32z M190.465,101.994c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.887,1.026,5.352,3.056,7.395c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.994L190.465,101.994z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',
        more_plus:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="35 30 140 140"><g><path d="M137.215,102.045c0,3.498-2.835,6.332-6.333,6.332H24.549c-3.498,0-6.334-2.834-6.334-6.332l0,0c0-3.498,2.836-6.333,6.334-6.333h106.333C134.38,95.711,137.215,98.547,137.215,102.045L137.215,102.045z M77.715,161.545c-3.498,0-6.333-2.836-6.333-6.334V48.878c0-3.498,2.836-6.333,6.333-6.333l0,0c3.498,0,6.334,2.835,6.334,6.333v106.333C84.049,158.709,81.213,161.545,77.715,161.545L77.715,161.545z M190.465,63.32c0-2.919-1.015-5.396-3.059-7.428c-2.029-2.031-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.016-7.388,3.047c-2.029,2.032-3.056,4.498-3.056,7.386c0,2.889,1.026,5.354,3.056,7.385c2.032,2.032,4.499,3.059,7.388,3.059c2.887,0,5.354-1.026,7.383-3.059C189.45,68.632,190.465,66.177,190.465,63.32L190.465,63.32z M190.465,101.993c0-2.858-1.015-5.313-3.059-7.333c-2.029-2.042-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.005-7.388,3.047c-2.029,2.021-3.056,4.486-3.056,7.376c0,2.888,1.026,5.353,3.056,7.396c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,107.389,190.465,104.914,190.465,101.993L190.465,101.993z M190.465,140.76c0-2.918-1.015-5.395-3.059-7.438c-2.029-2.041-4.496-3.047-7.383-3.047c-2.889,0-5.355,1.006-7.388,3.047c-2.029,2.043-3.056,4.52-3.056,7.438c0,2.922,1.026,5.398,3.056,7.439c2.032,2.021,4.499,3.047,7.388,3.047c2.887,0,5.354-1.025,7.383-3.047C189.45,146.158,190.465,143.682,190.465,140.76L190.465,140.76z"/></g></svg>',
        more_horizontal:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.76 3.58"><g><path d="M4.64,10.73a1.84,1.84,0,0,1,.65-.65,1.76,1.76,0,0,1,1.79,0A1.79,1.79,0,0,1,8,11.63a1.84,1.84,0,0,1-.25.9,1.69,1.69,0,0,1-.65.65,1.8,1.8,0,0,1-2.69-1.55A2.08,2.08,0,0,1,4.64,10.73Zm6.09,0a1.84,1.84,0,0,1,.65-.65,1.78,1.78,0,0,1,2.67,1.55,1.73,1.73,0,0,1-.24.9,1.84,1.84,0,0,1-.65.65,1.76,1.76,0,0,1-1.79,0,1.79,1.79,0,0,1-.64-2.44Zm6.08,0a1.69,1.69,0,0,1,.65-.65,1.76,1.76,0,0,1,1.79,0,1.79,1.79,0,0,1,.9,1.54,1.73,1.73,0,0,1-.24.9,1.84,1.84,0,0,1-.65.65,1.8,1.8,0,0,1-2.69-1.55A2,2,0,0,1,16.81,10.73Z" transform="translate(-4.39 -9.84)"/></g></svg>',
        more_vertical:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 3.94 15.75"><g><path d="M12.28,7.69a1.92,1.92,0,0,1-1.39-.58,2,2,0,0,1-.58-1.39,1.92,1.92,0,0,1,.58-1.39,2,2,0,0,1,1.39-.58,1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39,1.92,1.92,0,0,1-.58,1.39,2,2,0,0,1-1.39.58Zm0,2a1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39A1.92,1.92,0,0,1,13.67,13a2,2,0,0,1-1.39.58A1.92,1.92,0,0,1,10.89,13a2,2,0,0,1-.58-1.39,2,2,0,0,1,2-2Zm0,5.9a1.92,1.92,0,0,1,1.39.58,2,2,0,0,1,.58,1.39,1.92,1.92,0,0,1-.58,1.39,2,2,0,0,1-1.39.58,1.92,1.92,0,0,1-1.39-.58,2,2,0,0,1-.58-1.39,1.92,1.92,0,0,1,.58-1.39,1.94,1.94,0,0,1,1.39-.58Z" transform="translate(-10.31 -3.75)"/></g></svg>',
        attachment:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 8.38 15.68"><g><path d="M15.23,6h1v9.78a3.88,3.88,0,0,1-1.31,2.45,4,4,0,0,1-6.57-2.45V7A3,3,0,0,1,9.2,4.89a3,3,0,0,1,5,2.09v8.31a1.92,1.92,0,0,1-.58,1.39,2,2,0,0,1-1.39.58,1.92,1.92,0,0,1-1.39-.58,2,2,0,0,1-.58-1.39V8h1v7.32a1,1,0,0,0,.29.69,1,1,0,0,0,.69.28A.9.9,0,0,0,13,16a1,1,0,0,0,.29-.69V7a1.92,1.92,0,0,0-.58-1.39A2,2,0,0,0,11.27,5a1.92,1.92,0,0,0-1.39.58A2,2,0,0,0,9.33,7v8.31a3,3,0,1,0,5.9,0V6Z" transform="translate(-8.08 -3.78)"/></g></svg>',
        map:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 11.7 15.62"><g><path d="M12.05,12.42a2.93,2.93,0,1,1,2.07-5A2.88,2.88,0,0,1,15,9.49a3,3,0,0,1-.86,2.07,2.89,2.89,0,0,1-2.07.86Zm0-5.36a2.43,2.43,0,0,0-1.72,4.16,2.48,2.48,0,0,0,1.72.72,2.44,2.44,0,0,0,0-4.88Zm0-3.3A5.84,5.84,0,0,1,17.9,9.62a9.94,9.94,0,0,1-1.73,5A33.59,33.59,0,0,1,12.84,19a1.52,1.52,0,0,1-.23.2,1,1,0,0,1-.55.2h0a1,1,0,0,1-.55-.2,1.52,1.52,0,0,1-.23-.2,33.59,33.59,0,0,1-3.33-4.32,9.93,9.93,0,0,1-1.72-5,5.84,5.84,0,0,1,5.85-5.86ZM12,18.34l.08.05.06-.06a35.58,35.58,0,0,0,3.06-3.93,9.35,9.35,0,0,0,1.74-4.77,4.88,4.88,0,0,0-4.88-4.88A4.79,4.79,0,0,0,8.6,6.17,4.84,4.84,0,0,0,7.17,9.62,9.29,9.29,0,0,0,8.91,14.4,36,36,0,0,0,12,18.34Z" transform="translate(-6.2 -3.76)"/></g></svg>',
        magic_stick:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 15.73 15.75"><g><path d="M19.86,19.21a1,1,0,0,0,.28-.68,1,1,0,0,0-.28-.7L13,10.93a1,1,0,0,0-.7-.28,1,1,0,0,0-.68,1.65l6.9,6.9a1,1,0,0,0,.69.29.93.93,0,0,0,.69-.28ZM9.19,8.55a3,3,0,0,0,1.68,0,14.12,14.12,0,0,0,1.41-.32A11.26,11.26,0,0,0,10.8,7.06c-.56-.36-.86-.56-.91-.58S10,5.91,10,5.11s0-1.26-.15-1.37a4.35,4.35,0,0,0-1.19.71c-.53.4-.81.62-.87.68a9,9,0,0,0-2-.6,6.84,6.84,0,0,0-.76-.09s0,.27.08.77a8.6,8.6,0,0,0,.61,2q-.09.09-.69.87a3.59,3.59,0,0,0-.68,1.17c.12.17.57.23,1.36.15S7,9.26,7.15,9.23s.21.36.57.91a10.49,10.49,0,0,0,1.14,1.48c0-.1.14-.57.31-1.4a3,3,0,0,0,0-1.67Z" transform="translate(-4.41 -3.74)"/></g></svg>',
        empty_file:
          '<svg xmlns="http://www.w3.org/2000/svg" width="1rem" height="1rem" viewBox ="0 0 12.78 15.75"><g><path d="M14.73,3.76,18.67,7.7v9.84a2,2,0,0,1-2,2H7.84a1.89,1.89,0,0,1-1.38-.58,2,2,0,0,1-.57-1.39V5.73a1.93,1.93,0,0,1,.57-1.38,2,2,0,0,1,1.38-.58h6.62l.26,0v0Zm2.95,4.92h-2a1.93,1.93,0,0,1-1.38-.57,2,2,0,0,1-.58-1.4V6.17c0-.36,0-.84,0-1.43H7.85a1,1,0,0,0-.7.29,1,1,0,0,0-.29.7V17.54a1,1,0,0,0,.29.69,1,1,0,0,0,.69.29h8.85a1,1,0,0,0,.71-.29.92.92,0,0,0,.28-.69Zm0-1L14.73,4.74v2A1,1,0,0,0,15,7.4a1,1,0,0,0,.69.29Z" transform="translate(-5.89 -3.76)"/></g></svg>',
      },
      N = i("P6u4"),
      T = i.n(N),
      L = {
        _d: null,
        _w: null,
        isIE: null,
        isIE_Edge: null,
        isOSX_IOS: null,
        _propertiesInit: function () {
          this._d ||
            ((this._d = document),
            (this._w = window),
            (this.isIE = -1 < navigator.userAgent.indexOf("Trident")),
            (this.isIE_Edge =
              -1 < navigator.userAgent.indexOf("Trident") ||
              -1 < navigator.appVersion.indexOf("Edge")),
            (this.isOSX_IOS = /(Mac|iPhone|iPod|iPad)/.test(
              navigator.platform
            )));
        },
        _HTMLConvertor: function (e) {
          var t = {
            "&": "&amp;",
            "\xa0": "&nbsp;",
            "'": "&apos;",
            '"': "&quot;",
            "<": "&lt;",
            ">": "&gt;",
          };
          return e.replace(/&|\u00A0|'|"|<|>/g, function (e) {
            return "string" == typeof t[e] ? t[e] : e;
          });
        },
        zeroWidthSpace: String.fromCharCode(8203),
        zeroWidthRegExp: new RegExp(String.fromCharCode(8203), "g"),
        onlyZeroWidthRegExp: new RegExp("^" + String.fromCharCode(8203) + "+$"),
        onlyZeroWidthSpace: function (e) {
          return (
            "string" != typeof e && (e = e.textContent),
            "" === e || this.onlyZeroWidthRegExp.test(e)
          );
        },
        getXMLHttpRequest: function () {
          if (!this._w.ActiveXObject)
            return this._w.XMLHttpRequest ? new XMLHttpRequest() : null;
          try {
            return new Window.ActiveXObject("Msxml2.XMLHTTP");
          } catch (e) {
            try {
              return new Window.ActiveXObject("Microsoft.XMLHTTP");
            } catch (e) {
              return null;
            }
          }
        },
        createElement: function (e) {
          return this._d.createElement(e);
        },
        createTextNode: function (e) {
          return this._d.createTextNode(e || "");
        },
        HTMLEncoder: function (e) {
          var t = { "<": "$lt;", ">": "$gt;" };
          return e.replace(/<|>/g, function (e) {
            return "string" == typeof t[e] ? t[e] : e;
          });
        },
        HTMLDecoder: function (e) {
          var t = { "$lt;": "<", "$gt;": ">" };
          return e.replace(/\$lt;|\$gt;/g, function (e) {
            return "string" == typeof t[e] ? t[e] : e;
          });
        },
        hasOwn: function (e, t) {
          return this._hasOwn.call(e, t);
        },
        _hasOwn: Object.prototype.hasOwnProperty,
        getIncludePath: function (e, t) {
          for (
            var i = "",
              n = [],
              l = "js" === t ? "script" : "link",
              o = "js" === t ? "src" : "href",
              s = "(?:",
              a = 0,
              r = e.length;
            a < r;
            a++
          )
            s += e[a] + (a < r - 1 ? "|" : ")");
          for (
            var c = new this._w.RegExp(
                "(^|.*[\\/])" + s + "(\\.[^\\/]+)?." + t + "(?:\\?.*|;.*)?$",
                "i"
              ),
              d = new this._w.RegExp(".+\\." + t + "(?:\\?.*|;.*)?$", "i"),
              u = this._d.getElementsByTagName(l),
              h = 0;
            h < u.length;
            h++
          )
            d.test(u[h][o]) && n.push(u[h]);
          for (var g = 0; g < n.length; g++) {
            var p = n[g][o].match(c);
            if (p) {
              i = p[0];
              break;
            }
          }
          if (
            ("" === i && (i = 0 < n.length ? n[0][o] : ""),
            -1 === i.indexOf(":/") &&
              "//" !== i.slice(0, 2) &&
              (i =
                0 === i.indexOf("/")
                  ? window.location.href.match(/^.*?:\/\/[^\/]*/)[0] + i
                  : window.location.href.match(/^[^\?]*\/(?:)/)[0] + i),
            !i)
          )
            throw Error(
              "[KothingEditor.util.getIncludePath.fail] The KothingEditor installation path could not be automatically detected. (name: +" +
                i +
                ", extension: " +
                t +
                ")"
            );
          return i;
        },
        getPageStyle: function (e) {
          for (
            var t, i = "", n = (e || this._d).styleSheets, l = 0, o = n.length;
            l < o;
            l++
          ) {
            try {
              t = n[l].cssRules;
            } catch (e) {
              continue;
            }
            for (var s = 0, a = t.length; s < a; s++) i += t[s].cssText;
          }
          return i;
        },
        getIframeDocument: function (e) {
          var t = e.contentWindow || e.contentDocument;
          return t.document && (t = t.document), t;
        },
        getAttributesToString: function (e, t) {
          if (!e.attributes) return "";
          for (var i = e.attributes, n = "", l = 0, o = i.length; l < o; l++)
            (t && -1 < t.indexOf(i[l].name)) ||
              (n += i[l].name + '="' + i[l].value + '" ');
          return n;
        },
        getByteLength: function (e) {
          var t,
            i,
            n = this._w.encodeURIComponent;
          return (
            (i = this.isIE_Edge
              ? this._w.unescape(n(e.toString())).length
              : new this._w.TextEncoder("utf-8").encode(e.toString()).length),
            (t = 0),
            null !== n(e.toString()).match(/(%0A|%0D)/gi) &&
              (t = n(e.toString()).match(/(%0A|%0D)/gi).length),
            i + t
          );
        },
        isWysiwygDiv: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (this.hasClass(e, "ke-wrapper-wysiwyg") ||
              /^BODY$/i.test(e.nodeName))
          );
        },
        isNonEditable: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            "false" === e.getAttribute("contenteditable")
          );
        },
        isTextStyleElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            /^(strong|span|font|b|var|i|em|u|ins|s|strike|del|sub|sup|mark|a|label|code)$/i.test(
              e.nodeName
            )
          );
        },
        isFormatElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (/^(P|DIV|H[1-6]|PRE|LI|TH|TD)$/i.test(e.nodeName) ||
              this.hasClass(
                e,
                "(\\s|^)__ke__format__replace_.+(\\s|$)|(\\s|^)__ke__format__free_.+(\\s|$)"
              )) &&
            !this.isComponent(e) &&
            !this.isWysiwygDiv(e)
          );
        },
        isRangeFormatElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (/^(BLOCKQUOTE|OL|UL|FIGCAPTION|TABLE|THEAD|TBODY|TR|TH|TD)$/i.test(
              e.nodeName
            ) ||
              this.hasClass(e, "(\\s|^)__ke__format__range_.+(\\s|$)"))
          );
        },
        isClosureRangeFormatElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (/^(TH|TD)$/i.test(e.nodeName) ||
              this.hasClass(e, "(\\s|^)__ke__format__range__closure_.+(\\s|$)"))
          );
        },
        isFreeFormatElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (/^PRE$/i.test(e.nodeName) ||
              this.hasClass(e, "(\\s|^)__ke__format__free_.+(\\s|$)")) &&
            !this.isComponent(e) &&
            !this.isWysiwygDiv(e)
          );
        },
        isClosureFreeFormatElement: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            this.hasClass(e, "(\\s|^)__ke__format__free__closure_.+(\\s|$)")
          );
        },
        isComponent: function (e) {
          return (
            e &&
            (/ke-component/.test(e.className) ||
              /^(TABLE|HR)$/.test(e.nodeName))
          );
        },
        isMediaComponent: function (e) {
          return e && /ke-component/.test(e.className);
        },
        isNotCheckingNode: function (e) {
          return e && /katex|__ke__tag/.test(e.className);
        },
        getFormatElement: function (e, t) {
          if (!e) return null;
          for (
            t =
              t ||
              function () {
                return !0;
              };
            e;

          ) {
            if (this.isWysiwygDiv(e)) return null;
            if (this.isRangeFormatElement(e)) return e.firstElementChild;
            if (this.isFormatElement(e) && t(e)) return e;
            e = e.parentNode;
          }
          return null;
        },
        getRangeFormatElement: function (e, t) {
          if (!e) return null;
          for (
            t =
              t ||
              function () {
                return !0;
              };
            e;

          ) {
            if (this.isWysiwygDiv(e)) return null;
            if (
              this.isRangeFormatElement(e) &&
              !/^(THEAD|TBODY|TR)$/i.test(e.nodeName) &&
              t(e)
            )
              return e;
            e = e.parentNode;
          }
          return null;
        },
        getFreeFormatElement: function (e, t) {
          if (!e) return null;
          for (
            t =
              t ||
              function () {
                return !0;
              };
            e;

          ) {
            if (this.isWysiwygDiv(e)) return null;
            if (this.isFreeFormatElement(e) && t(e)) return e;
            e = e.parentNode;
          }
          return null;
        },
        getClosureFreeFormatElement: function (e, t) {
          if (!e) return null;
          for (
            t =
              t ||
              function () {
                return !0;
              };
            e;

          ) {
            if (this.isWysiwygDiv(e)) return null;
            if (this.isClosureFreeFormatElement(e) && t(e)) return e;
            e = e.parentNode;
          }
          return null;
        },
        copyTagAttributes: function (e, t) {
          t.style.cssText && (e.style.cssText += t.style.cssText);
          for (var i = t.classList, n = 0, l = i.length; n < l; n++)
            this.addClass(e, i[n]);
          e.style.cssText || e.removeAttribute("style"),
            e.className.trim() || e.removeAttribute("class");
        },
        copyFormatAttributes: function (e, t) {
          ((t = t.cloneNode(!1)).className = t.className.replace(
            /(\s|^)__ke__format__[^\s]+/g,
            ""
          )),
            this.copyTagAttributes(e, t);
        },
        getArrayItem: function (e, t, i) {
          if (!e || 0 === e.length) return null;
          t =
            t ||
            function () {
              return !0;
            };
          for (var n, l = [], o = 0, s = e.length; o < s; o++)
            if (t((n = e[o]))) {
              if (!i) return n;
              l.push(n);
            }
          return i ? l : null;
        },
        getArrayIndex: function (e, t) {
          for (var i = -1, n = 0, l = e.length; n < l; n++)
            if (e[n] === t) {
              i = n;
              break;
            }
          return i;
        },
        nextIdx: function (e, t) {
          var i = this.getArrayIndex(e, t);
          return -1 === i ? -1 : i + 1;
        },
        prevIdx: function (e, t) {
          var i = this.getArrayIndex(e, t);
          return -1 === i ? -1 : i - 1;
        },
        getPositionIndex: function (e) {
          for (var t = 0; (e = e.previousSibling); ) t += 1;
          return t;
        },
        getNodePath: function (e, t, i) {
          var n = [],
            l = !0;
          return (
            this.getParentElement(
              e,
              function (e) {
                if ((e === t && (l = !1), l && !this.isWysiwygDiv(e))) {
                  if (i && 3 === e.nodeType) {
                    var o = null,
                      s = null;
                    i.s = i.e = 0;
                    for (var a = e.previousSibling; a && 3 === a.nodeType; )
                      (s = a.textContent.replace(this.zeroWidthRegExp, "")),
                        (i.s += s.length),
                        (e.textContent = s + e.textContent),
                        (a = (o = a).previousSibling),
                        this.removeItem(o);
                    for (var r = e.nextSibling; r && 3 === r.nodeType; )
                      (s = r.textContent.replace(this.zeroWidthRegExp, "")),
                        (i.e += s.length),
                        (e.textContent += s),
                        (r = (o = r).nextSibling),
                        this.removeItem(o);
                  }
                  n.push(e);
                }
                return !1;
              }.bind(this)
            ),
            n.map(this.getPositionIndex).reverse()
          );
        },
        getNodeFromPath: function (e, t) {
          for (
            var i, n = t, l = 0, o = e.length;
            l < o && 0 !== (i = n.childNodes).length;
            l++
          )
            n = i.length <= e[l] ? i[i.length - 1] : i[e[l]];
          return n;
        },
        isSameAttributes: function (e, t) {
          if (3 === e.nodeType && 3 === t.nodeType) return !0;
          if (3 === e.nodeType || 3 === t.nodeType) return !1;
          for (
            var i = e.style, n = t.style, l = 0, o = 0, s = i.length;
            o < s;
            o++
          )
            i[i[o]] === n[i[o]] && l++;
          for (
            var a = e.classList,
              r = t.classList,
              c = this._w.RegExp,
              d = 0,
              u = 0,
              h = a.length;
            u < h;
            u++
          )
            c("(s|^)" + a[u] + "(s|$)").test(r.value) && d++;
          return (
            l === n.length && l === i.length && d === r.length && d === a.length
          );
        },
        isList: function (e) {
          return e && /^(OL|UL)$/i.test("string" == typeof e ? e : e.nodeName);
        },
        isListCell: function (e) {
          return e && /^LI$/i.test("string" == typeof e ? e : e.nodeName);
        },
        isTable: function (e) {
          return (
            e &&
            /^(TABLE|THEAD|TBODY|TR|TH|TD)$/i.test(
              "string" == typeof e ? e : e.nodeName
            )
          );
        },
        isCell: function (e) {
          return e && /^(TD|TH)$/i.test("string" == typeof e ? e : e.nodeName);
        },
        isBreak: function (e) {
          return e && /^BR$/i.test("string" == typeof e ? e : e.nodeName);
        },
        isAnchor: function (e) {
          return e && /^A$/i.test("string" == typeof e ? e : e.nodeName);
        },
        isMedia: function (e) {
          return (
            e &&
            /^(IMG|IFRAME|AUDIO|VIDEO|CANVAS)$/i.test(
              "string" == typeof e ? e : e.nodeName
            )
          );
        },
        isNumber: function (e) {
          return !!e && /^-?\d+(\.\d+)?$/.test(e + "");
        },
        getNumber: function (e, t) {
          if (!e) return 0;
          var i = (e + "").match(/-?\d+(\.\d+)?/);
          return i && i[0]
            ? ((i = i[0]),
              t < 0 ? +i : 0 === t ? this._w.Math.round(+i) : +(+i).toFixed(t))
            : 0;
        },
        getListChildren: function (e, t) {
          var i = [];
          return (
            e &&
              e.children &&
              0 !== e.children.length &&
              ((t =
                t ||
                function () {
                  return !0;
                }),
              (function n(l) {
                e !== l && t(l) && i.push(l);
                for (var o = 0, s = l.children.length; o < s; o++)
                  n(l.children[o]);
              })(e)),
            i
          );
        },
        getListChildNodes: function (e, t) {
          var i = [];
          return (
            e &&
              0 !== e.childNodes.length &&
              ((t =
                t ||
                function () {
                  return !0;
                }),
              (function n(l) {
                e !== l && t(l) && i.push(l);
                for (var o = 0, s = l.childNodes.length; o < s; o++)
                  n(l.childNodes[o]);
              })(e)),
            i
          );
        },
        getElementDepth: function (e) {
          if (!e || this.isWysiwygDiv(e)) return -1;
          var t = 0;
          for (e = e.parentNode; e && !this.isWysiwygDiv(e); )
            (t += 1), (e = e.parentNode);
          return t;
        },
        compareElements: function (e, t) {
          for (var i = e, n = t; i && n && i.parentNode !== n.parentNode; )
            (i = i.parentNode), (n = n.parentNode);
          if (!i || !n) return { ancestor: null, a: e, b: t, result: 0 };
          var l = i.parentNode.childNodes,
            o = this.getArrayIndex(l, i),
            s = this.getArrayIndex(l, n);
          return {
            ancestor: i.parentNode,
            a: i,
            b: n,
            result: s < o ? 1 : o < s ? -1 : 0,
          };
        },
        getParentElement: function (e, t) {
          var i, n, l;
          for (
            l =
              "function" == typeof t
                ? t
                : ((t = /^\./.test(t)
                    ? ((i = "className"), t.split(".")[1])
                    : /^#/.test(t)
                    ? ((i = "id"), "^" + t.split("#")[1] + "$")
                    : /^:/.test(t)
                    ? ((i = "name"), "^" + t.split(":")[1] + "$")
                    : ((i = "nodeName"), "^" + t + "$")),
                  (n = new this._w.RegExp(t, "i")),
                  function (e) {
                    return n.test(e[i]);
                  });
            e && !l(e);

          ) {
            if (this.isWysiwygDiv(e)) return null;
            e = e.parentNode;
          }
          return e;
        },
        getChildElement: function (e, t, i) {
          var n, l, o;
          o =
            "function" == typeof t
              ? t
              : ((t = /^\./.test(t)
                  ? ((n = "className"), t.split(".")[1])
                  : /^#/.test(t)
                  ? ((n = "id"), "^" + t.split("#")[1] + "$")
                  : /^:/.test(t)
                  ? ((n = "name"), "^" + t.split(":")[1] + "$")
                  : ((n = "nodeName"),
                    "^" + ("text" === t ? "#" + t : t) + "$")),
                (l = new this._w.RegExp(t, "i")),
                function (e) {
                  return l.test(e[n]);
                });
          var s = this.getListChildNodes(e, function (e) {
            return o(e);
          });
          return s[i ? s.length - 1 : 0];
        },
        getEdgeChildNodes: function (e, t) {
          if (e) {
            for (
              t = t || e;
              e &&
              1 === e.nodeType &&
              0 < e.childNodes.length &&
              !this.isBreak(e);

            )
              e = e.firstChild;
            for (
              ;
              t &&
              1 === t.nodeType &&
              0 < t.childNodes.length &&
              !this.isBreak(t);

            )
              t = t.lastChild;
            return { sc: e, ec: t || e };
          }
        },
        getOffset: function (e, t) {
          for (
            var i = 0,
              n = 0,
              l = 3 === e.nodeType ? e.parentElement : e,
              o = this.getParentElement(e, this.isWysiwygDiv.bind(this));
            l && !this.hasClass(l, "ke-container") && l !== o;

          )
            (i += l.offsetLeft), (n += l.offsetTop), (l = l.offsetParent);
          var s = t && /iframe/i.test(t.nodeName);
          return {
            left: i + (s ? t.parentElement.offsetLeft : 0),
            top: n - o.scrollTop + (s ? t.parentElement.offsetTop : 0),
          };
        },
        getOverlapRangeAtIndex: function (e, t, i, n) {
          if (e <= n ? t < i : i < t) return 0;
          var l = (i < e ? e : i) - (t < n ? t : n);
          return 1 + (l < 0 ? -1 * l : l);
        },
        changeTxt: function (e, t) {
          e && t && (e.textContent = t);
        },
        changeElement: function (e, t) {
          var i;
          "string" == typeof t
            ? e.outerHTML
              ? (e.outerHTML = t)
              : (((i = this.createElement("DIV")).innerHTML = t),
                (t = i.firstChild),
                e.parentNode.replaceChild(t, e))
            : 1 === t.nodeType && e.parentNode.replaceChild(t, e);
        },
        setStyle: function (e, t, i) {
          (e.style[t] = i) || e.style.cssText || e.removeAttribute("style");
        },
        hasClass: function (e, t) {
          if (e) return new this._w.RegExp(t).test(e.className);
        },
        addClass: function (e, t) {
          e &&
            (new this._w.RegExp("(\\s|^)" + t + "(\\s|$)").test(e.className) ||
              (e.className += (0 < e.className.length ? " " : "") + t));
        },
        removeClass: function (e, t) {
          var i;
          e &&
            ((i = new this._w.RegExp("(\\s|^)" + t + "(\\s|$)")),
            (e.className = e.className.replace(i, " ").trim()),
            e.className.trim() || e.removeAttribute("class"));
        },
        toggleClass: function (e, t) {
          var i;
          e &&
            ((i = new this._w.RegExp("(\\s|^)" + t + "(\\s|$)")).test(
              e.className
            )
              ? (e.className = e.className.replace(i, " ").trim())
              : (e.className += " " + t),
            e.className.trim() || e.removeAttribute("class"));
        },
        setDisabledButtons: function (e, t) {
          for (var i = 0, n = t.length; i < n; i++) t[i].disabled = e;
        },
        removeItem: function (t) {
          if (t)
            try {
              t.remove();
            } catch (e) {
              t.parentNode && t.parentNode.removeChild(t);
            }
        },
        removeItemAllParents: function (e, t, i) {
          if (!e) return null;
          var n = null;
          return (
            (t =
              t ||
              function (e) {
                if (e === i || this.isComponent(e)) return !1;
                var t = e.textContent.trim();
                return 0 === t.length || /^(\n|\u200B)+$/.test(t);
              }.bind(this)),
            (function e(i) {
              var l;
              L.isWysiwygDiv(i) ||
                ((l = i.parentNode) &&
                  t(i) &&
                  ((n = {
                    sc: i.previousElementSibling,
                    ec: i.nextElementSibling,
                  }),
                  L.removeItem(i),
                  e(l)));
            })(e),
            n
          );
        },
        detachNestedList: function (e, t) {
          var i,
            n,
            l,
            o,
            s = this._deleteNestedList(e);
          if (s) {
            (i = s.cloneNode(!1)), (n = s.childNodes);
            for (var a = this.getPositionIndex(e); n[a]; ) i.appendChild(n[a]);
          } else i = e;
          for (
            var r = 0,
              c = (o = t
                ? this.getListChildren(
                    i,
                    function (e) {
                      return this.isListCell(e) && !e.previousElementSibling;
                    }.bind(this)
                  )
                : ((l = this.getElementDepth(e) + 2),
                  this.getListChildren(
                    e,
                    function (e) {
                      return (
                        this.isListCell(e) &&
                        !e.previousElementSibling &&
                        this.getElementDepth(e) === l
                      );
                    }.bind(this)
                  ))).length;
            r < c;
            r++
          )
            this._deleteNestedList(o[r]);
          return (
            s &&
              (s.parentNode.insertBefore(i, s.nextSibling),
              n && 0 === n.length && this.removeItem(s)),
            i === e ? i.parentNode : i
          );
        },
        _deleteNestedList: function (e) {
          for (
            var t, i, n, l, o, s = e.parentNode, a = s, r = a.parentNode;
            this.isListCell(r);

          ) {
            for (
              l = this.getPositionIndex(e),
                t = r.nextElementSibling,
                i = r.parentNode,
                n = a;
              n;

            ) {
              if (((a = a.nextSibling), this.isList(n))) {
                for (o = n.childNodes; o[l]; ) i.insertBefore(o[l], t);
                0 === o.length && this.removeItem(n);
              } else i.appendChild(n);
              n = a;
            }
            r = (a = i).parentNode;
          }
          return 0 === s.children.length && this.removeItem(s), i;
        },
        splitElement: function (e, t, i) {
          var n,
            l,
            o,
            s,
            a = e.parentNode,
            r = 0,
            c = !0;
          (!i || i < 0) && (i = 0),
            3 === e.nodeType
              ? ((r = this.getPositionIndex(e)),
                0 <= t &&
                  (e.splitText(t),
                  (s = this.getNodeFromPath([r + 1], a)),
                  this.onlyZeroWidthSpace(s) && (s.data = this.zeroWidthSpace)))
              : 1 === e.nodeType &&
                (e.previousSibling
                  ? (e = e.previousSibling)
                  : this.getElementDepth(e) === i && (c = !1));
          for (var d = e; this.getElementDepth(d) > i; )
            for (
              r = this.getPositionIndex(d) + 1,
                o = n,
                n = (d = d.parentNode).cloneNode(!1),
                l = d.childNodes,
                o &&
                  (this.isListCell(n) && this.isList(o) && o.firstElementChild
                    ? ((n.innerHTML = o.firstElementChild.innerHTML),
                      L.removeItem(o.firstElementChild),
                      0 < o.children.length && n.appendChild(o))
                    : n.appendChild(o));
              l[r];

            )
              n.appendChild(l[r]);
          d.childNodes.length <= 1 &&
            (!d.firstChild || 0 === d.firstChild.textContent.length) &&
            (d.innerHTML = "<br>");
          var u = d.parentNode;
          return (
            c && (d = d.nextSibling),
            n
              ? (this.mergeSameTags(n, null, !1),
                this.mergeNestedTags(
                  n,
                  function (e) {
                    return this.isList(e);
                  }.bind(this)
                ),
                0 < n.childNodes.length ? u.insertBefore(n, d) : (n = d),
                0 === a.childNodes.length && this.removeItem(a),
                n)
              : d
          );
        },
        mergeSameTags: function (e, t, i) {
          var n = this,
            l = t ? t.length : 0,
            o = null;
          return (
            l &&
              (o = this._w.Array.apply(null, new this._w.Array(l)).map(
                this._w.Number.prototype.valueOf,
                0
              )),
            (function e(s, a, r) {
              for (
                var c, d, u = s.childNodes, h = 0, g = u.length;
                h < g && ((c = u[h]), (d = u[h + 1]), c);
                h++
              )
                if (
                  (i && n._isIgnoreNodeChange(c)) ||
                  (!i &&
                    (n.isTable(c) ||
                      n.isListCell(c) ||
                      (n.isFormatElement(c) && !n.isFreeFormatElement(c))))
                )
                  (n.isTable(c) || n.isListCell(c)) && e(c, a + 1, h);
                else {
                  if (1 === g && s.nodeName === c.nodeName && s.parentNode) {
                    if (l)
                      for (
                        var p = void 0,
                          m = void 0,
                          f = void 0,
                          v = void 0,
                          _ = void 0,
                          b = 0;
                        b < l;
                        b++
                      )
                        if ((p = t[b]) && p[a] === h) {
                          for (m = c, f = s, v = a, _ = !0; 0 <= v; ) {
                            if (n.getArrayIndex(f.childNodes, m) !== p[v]) {
                              _ = !1;
                              break;
                            }
                            (f = (m = c.parentNode).parentNode), v--;
                          }
                          _ && (p.splice(a, 1), (p[a] = h));
                        }
                    n.copyTagAttributes(c, s),
                      s.parentNode.insertBefore(c, s),
                      n.removeItem(s);
                  }
                  if (!d) {
                    1 === c.nodeType && e(c, a + 1, h);
                    break;
                  }
                  if (
                    c.nodeName === d.nodeName &&
                    n.isSameAttributes(c, d) &&
                    c.href === d.href
                  ) {
                    for (
                      var y = c.childNodes, w = 0, C = 0, k = y.length;
                      C < k;
                      C++
                    )
                      0 < y[C].textContent.length && w++;
                    var x = c.lastChild,
                      E = d.firstChild,
                      S = 0;
                    if (x && E) {
                      for (
                        var N = 3 === x.nodeType && 3 === E.nodeType,
                          T = ((S = x.textContent.length), x.previousSibling);
                        T && 3 === T.nodeType;

                      )
                        (S += T.textContent.length), (T = T.previousSibling);
                      if (
                        (0 < w &&
                          3 === x.nodeType &&
                          3 === E.nodeType &&
                          (0 < x.textContent.length ||
                            0 < E.textContent.length) &&
                          w--,
                        l)
                      )
                        for (var L = null, z = 0; z < l; z++)
                          if ((L = t[z]) && L[a] > h) {
                            if (0 < a && L[a - 1] !== r) continue;
                            --L[a],
                              0 <= L[a + 1] &&
                                L[a] === h &&
                                ((L[a + 1] += w),
                                N &&
                                  x &&
                                  3 === x.nodeType &&
                                  E &&
                                  3 === E.nodeType &&
                                  (o[z] += S));
                          }
                    }
                    if (3 === c.nodeType) {
                      if (
                        ((S = c.textContent.length),
                        (c.textContent += d.textContent),
                        l)
                      )
                        for (var B = null, A = 0; A < l; A++)
                          if ((B = t[A]) && B[a] > h) {
                            if (0 < a && B[a - 1] !== r) continue;
                            --B[a],
                              0 <= B[a + 1] &&
                                B[a] === h &&
                                ((B[a + 1] += w), (o[A] += S));
                          }
                    } else c.innerHTML += d.innerHTML;
                    n.removeItem(d), h--;
                  } else 1 === c.nodeType && e(c, a + 1, h);
                }
            })(e, 0, 0),
            o
          );
        },
        mergeNestedTags: function (e, t) {
          "string" == typeof t
            ? (t = function (e) {
                return this.test(e.tagName);
              }.bind(new this._w.RegExp("^(" + (t || ".+") + ")$", "i")))
            : "function" != typeof t &&
              (t = function () {
                return !0;
              }),
            (function e(i) {
              if (
                1 === (l = i.children).length &&
                l[0].nodeName === i.nodeName &&
                t(i)
              ) {
                for (var n = l[0], l = n.children; l[0]; ) i.appendChild(l[0]);
                i.removeChild(n);
              }
              for (var o = 0, s = i.children.length; o < s; o++)
                e(i.children[o]);
            })(e);
        },
        removeEmptyNode: function (e, t) {
          var i = this;
          (t =
            t &&
            i.getParentElement(t, function (t) {
              return e === t.parentElement;
            })),
            (function n(l) {
              if (i._notTextNode(l) || l === t || i.isNonEditable(l)) return 0;
              if (
                l === e ||
                !i.onlyZeroWidthSpace(l.textContent) ||
                (l.firstChild && i.isBreak(l.firstChild))
              )
                for (var o = l.children, s = 0, a = o.length, r = 0; s < a; s++)
                  o[s + r] && !i.isComponent(o[s + r]) && (r += n(o[s + r]));
              else if (l.parentNode) return l.parentNode.removeChild(l), -1;
              return 0;
            })(e),
            0 === e.childNodes.length && (e.innerHTML = "<br>");
        },
        htmlRemoveWhiteSpace: function (e) {
          return e
            ? e
                .trim()
                .replace(
                  /<\/?(?!strong|span|font|b|var|i|em|u|ins|s|strike|del|sub|sup|mark|a|label|code)[^>^<]+>\s+(?=<)/gi,
                  function (e) {
                    return e.trim();
                  }
                )
            : "";
        },
        sortByDepth: function (e, t) {
          var i = t ? 1 : -1,
            n = -1 * i;
          e.sort(
            function (e, t) {
              return this.isListCell(e) && this.isListCell(t)
                ? ((e = this.getElementDepth(e)),
                  (t = this.getElementDepth(t)) < e ? i : e < t ? n : 0)
                : 0;
            }.bind(this)
          );
        },
        _isIgnoreNodeChange: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            (this.isNonEditable(e) || !this.isTextStyleElement(e))
          );
        },
        _isMaintainedNode: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            /^(a|label|code)$/i.test("string" == typeof e ? e : e.nodeName)
          );
        },
        _isSizeNode: function (e) {
          return (
            e &&
            1 === e.nodeType &&
            this.isTextStyleElement(e) &&
            !!e.style.fontSize
          );
        },
        _notTextNode: function (e) {
          return (
            1 === e.nodeType &&
            (this.isComponent(e) ||
              /^(br|input|select|canvas|img|iframe|audio|video)$/i.test(
                "string" == typeof e ? e : e.nodeName
              ))
          );
        },
        _disallowedTags: function (e) {
          return /^(meta|script|link|style|[a-z]+\:[a-z]+)$/i.test(e.nodeName);
        },
        createTagsWhitelist: function (e) {
          for (
            var t = e.split("|"), i = "<\\/?(", n = 0, l = t.length;
            n < l;
            n++
          )
            i += "(?!\\b" + t[n] + "\\b)";
          return (i += ")[^>]>"), new RegExp(i, "g");
        },
        _consistencyCheckOfHTML: function (e, t) {
          for (
            var i = [],
              n = [],
              l = [],
              o = [],
              s = this.getListChildNodes(
                e,
                function (s) {
                  if (1 !== s.nodeType) return !1;
                  if (
                    !t.test(s.nodeName) &&
                    0 === s.childNodes.length &&
                    this.isNotCheckingNode(s)
                  )
                    return i.push(s), !1;
                  var a = !this.getParentElement(s, this.isNotCheckingNode);
                  if (
                    !this.isTable(s) &&
                    !this.isListCell(s) &&
                    (this.isFormatElement(s) ||
                      this.isRangeFormatElement(s) ||
                      this.isTextStyleElement(s)) &&
                    0 === s.childNodes.length &&
                    a
                  )
                    return n.push(s), !1;
                  if (
                    this.isList(s.parentNode) &&
                    !this.isList(s) &&
                    !this.isListCell(s)
                  )
                    return l.push(s), !1;
                  if (this.isCell(s)) {
                    var r = s.firstElementChild;
                    if (
                      !this.isFormatElement(r) &&
                      !this.isRangeFormatElement(r) &&
                      !this.isComponent(r)
                    )
                      return o.push(s), !1;
                  }
                  return (
                    s.parentNode !== e &&
                    (this.isFormatElement(s) ||
                      this.isComponent(s) ||
                      this.isList(s)) &&
                    !this.isRangeFormatElement(s.parentNode) &&
                    !this.isListCell(s.parentNode) &&
                    !this.getParentElement(s, this.isComponent) &&
                    a
                  );
                }.bind(this)
              ),
              a = 0,
              r = i.length;
            a < r;
            a++
          )
            this.removeItem(i[a]);
          for (var c, d, u = [], h = 0, g = s.length; h < g; h++)
            (d = (c = s[h]).parentNode) &&
              d.parentNode &&
              (d.parentNode.insertBefore(c, d), u.push(d));
          for (var p, m = 0, f = u.length; m < f; m++)
            (p = u[m]),
              this.onlyZeroWidthSpace(p.textContent.trim()) &&
                this.removeItem(p);
          for (var v = 0, _ = n.length; v < _; v++) this.removeItem(n[v]);
          for (var b, y, w, C, k = 0, x = l.length; k < x; k++) {
            for (
              b = l[k], y = this.createElement("LI"), w = b.childNodes;
              w[0];

            )
              y.appendChild(w[0]);
            (C = b.parentNode) && (C.insertBefore(y, b), this.removeItem(b));
          }
          for (var E, S, N = 0, T = o.length; N < T; N++)
            (E = o[N]),
              ((S = this.createElement("DIV")).innerHTML =
                0 === E.textContent.trim().length ? "<br>" : E.innerHTML),
              (E.innerHTML = S.outerHTML);
        },
        _setDefaultOptionStyle: function (e, t) {
          var i = "";
          e.height && (i += "height:" + e.height + ";"),
            e.minHeight && (i += "min-height:" + e.minHeight + ";"),
            e.maxHeight && (i += "max-height:" + e.maxHeight + ";"),
            e.position && (i += "position:" + e.position + ";"),
            e.width && (i += "width:" + e.width + ";"),
            e.minWidth && (i += "min-width:" + e.minWidth + ";"),
            e.maxWidth && (i += "max-width:" + e.maxWidth + ";");
          for (
            var n,
              l = "",
              o = "",
              s = "",
              a = (t = i + t).split(";"),
              r = 0,
              c = a.length;
            r < c;
            r++
          )
            (n = a[r].trim()) &&
              (/^(min-|max-)?width\s*:/.test(n)
                ? (l += n + ";")
                : /^(min-|max-)?height\s*:/.test(n)
                ? (/^height/.test(n) &&
                    "auto" === n.split(":")[1].trim() &&
                    (e.height = "auto"),
                  (o += n + ";"))
                : (s += n + ";"));
          return { top: l, frame: o, editor: s };
        },
        _setIframeDocument: function (e, t) {
          e.setAttribute("scrolling", "auto"),
            (e.contentDocument.head.innerHTML =
              '<meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1"><title></title>' +
              this._setIframeCssTags(t)),
            (e.contentDocument.body.className = "kothing-editor-editable"),
            e.contentDocument.body.setAttribute("contenteditable", !0);
        },
        _setIframeCssTags: function (e) {
          for (
            var t,
              i = e.iframeCSSFileName,
              n = this._w.RegExp,
              l = "",
              o = 0,
              s = i.length;
            o < s;
            o++
          ) {
            if (((t = []), /(^https?:\/\/)|(^data:text\/css,)/.test(i[o])))
              t.push(i[o]);
            else
              for (
                var a,
                  r = new n(
                    "(^|.*[\\/])" + i[o] + "(\\..+)?\\.css(?:\\?.*|;.*)?$",
                    "i"
                  ),
                  c = document.getElementsByTagName("link"),
                  d = 0,
                  u = c.length;
                d < u;
                d++
              )
                (a = c[d].href.match(r)) && t.push(a[0]);
            if (!t || 0 === t.length)
              throw Error(
                '[KothingEditor.constructor.iframe.fail] The kothingEditor CSS files installation path could not be automatically detected. Please set the option property "iframeCSSFileName" before creating editor instances.'
              );
            for (var h = 0, g = t.length; h < g; h++)
              l += '<link href="' + t[h] + '" rel="stylesheet">';
          }
          return (
            l +
            ("auto" === e.height
              ? "<style>\n/** Iframe height auto */\nbody{height: min-content; overflow: hidden;}\n</style>"
              : "")
          );
        },
      },
      z = L;
    function B(e) {
      return (B =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    var A = {
        init: function (e, t) {
          "object" !== B(t) && (t = {});
          var i = document;
          this._initOptions(e, t);
          var n = i.createElement("DIV");
          (n.className = "kothing-editor"),
            e.id && (n.id = "kothing-editor_" + e.id);
          var l = i.createElement("DIV");
          l.className = "ke-container";
          var o = this._createToolBar(i, t.toolbarItem, t.plugins, t);
          (o.element.style.visibility = "hidden"),
            o.pluginCallButtons.math && this._checkKatexMath(t.katex);
          var s = i.createElement("DIV");
          s.className = "ke-arrow";
          var a = i.createElement("DIV");
          a.className = "ke-toolbar-sticky-dummy";
          var r = i.createElement("DIV");
          r.className = "ke-wrapper";
          var c = this._initElements(t, n, o.element, s),
            d = c.bottomBar,
            u = c.wysiwygFrame,
            h = c.placeholder,
            g = c.codeView,
            p = d.resizingBar,
            m = d.navigation,
            f = d.charWrapper,
            v = d.charCounter,
            _ = i.createElement("DIV");
          (_.className = "ke-loading-box kothing-editor-common"),
            (_.innerHTML = '<div class="ke-loading-effect"></div>');
          var b = i.createElement("DIV");
          (b.className = "ke-line-breaker"),
            (b.innerHTML =
              '<button class="ke-btn">' + t.icons.line_break + "</button>");
          var y = i.createElement("DIV");
          y.className += "ke-line-breaker-component";
          var w = y.cloneNode(!0);
          y.innerHTML = w.innerHTML = t.icons.line_break;
          var C = i.createElement("DIV");
          C.className = "ke-resizing-back";
          var k = t.toolbarContainer;
          return (
            k && k.appendChild(o.element),
            r.appendChild(g),
            h && r.appendChild(h),
            k || l.appendChild(o.element),
            l.appendChild(a),
            l.appendChild(r),
            l.appendChild(C),
            l.appendChild(_),
            l.appendChild(b),
            l.appendChild(y),
            l.appendChild(w),
            p && l.appendChild(p),
            n.appendChild(l),
            (g = this._checkCodeMirror(t, g)),
            {
              constructed: {
                _top: n,
                _relative: l,
                _toolBar: o.element,
                _menuTray: o._menuTray,
                _editorArea: r,
                _wysiwygArea: u,
                _codeArea: g,
                _placeholder: h,
                _resizingBar: p,
                _navigation: m,
                _charWrapper: f,
                _charCounter: v,
                _loading: _,
                _lineBreaker: b,
                _lineBreaker_t: y,
                _lineBreaker_b: w,
                _resizeBack: C,
                _stickyDummy: a,
                _arrow: s,
              },
              options: t,
              plugins: o.plugins,
              pluginCallButtons: o.pluginCallButtons,
              _responsiveButtons: o.responsiveButtons,
            }
          );
        },
        _checkCodeMirror: function (e, t) {
          var i, n;
          return (
            e.codeMirror &&
              ((i = [
                {
                  mode: "htmlmixed",
                  htmlMode: !0,
                  lineNumbers: !0,
                  lineWrapping: !0,
                },
                e.codeMirror.options || {},
              ].reduce(function (e, t) {
                for (var i in t) z.hasOwn(t, i) && (e[i] = t[i]);
                return e;
              }, {})),
              "auto" === e.height &&
                ((i.viewportMargin = 1 / 0), (i.height = "auto")),
              ((n = e.codeMirror.src.fromTextArea(
                t,
                i
              )).display.wrapper.style.cssText = t.style.cssText),
              ((t = (e.codeMirrorEditor = n).display.wrapper).className +=
                " ke-wrapper-code-mirror")),
            t
          );
        },
        _checkKatexMath: function (e) {
          if (!e)
            throw Error(
              '[KothingEditor.create.fail] To use the math button you need to add a "katex" object to the options.'
            );
          var t = [{ throwOnError: !1 }, e.options || {}].reduce(function (
            e,
            t
          ) {
            for (var i in t) z.hasOwn(t, i) && (e[i] = t[i]);
            return e;
          },
          {});
          e.options = t;
        },
        _setOptions: function (e, t, i, n) {
          this._initOptions(t.element.originElement, e);
          var l = t.element,
            o = l.relative,
            s = l.editorArea,
            a = e.toolbarContainer && e.toolbarContainer !== n.toolbarContainer,
            r = !!e.toolbarItem || e.mode !== n.mode || a,
            c = !!e.plugins,
            d = this._createToolBar(
              document,
              r ? e.toolbarItem : n.toolbarItem,
              c ? e.plugins : i,
              e
            );
          d.pluginCallButtons.math && this._checkKatexMath(e.katex);
          var u = document.createElement("DIV");
          (u.className = "ke-arrow"),
            r &&
              ((d.element.style.visibility = "hidden"),
              a
                ? (e.toolbarContainer.appendChild(d.element),
                  l.toolbar.parentElement.removeChild(l.toolbar))
                : l.toolbar.parentElement.replaceChild(d.element, l.toolbar),
              (l.toolbar = d.element),
              (l._menuTray = d._menuTray),
              (l._arrow = u));
          var h = this._initElements(
              e,
              l.topArea,
              r ? d.element : l.toolbar,
              u
            ),
            g = h.bottomBar,
            p = h.wysiwygFrame,
            m = h.placeholder,
            f = h.codeView;
          return (
            l.resizingBar && o.removeChild(l.resizingBar),
            g.resizingBar && o.appendChild(g.resizingBar),
            (s.innerHTML = ""),
            s.appendChild(f),
            m && s.appendChild(m),
            (f = this._checkCodeMirror(e, f)),
            (l.resizingBar = g.resizingBar),
            (l.navigation = g.navigation),
            (l.charWrapper = g.charWrapper),
            (l.charCounter = g.charCounter),
            (l.wysiwygFrame = p),
            (l.code = f),
            (l.placeholder = m),
            {
              callButtons: r ? d.pluginCallButtons : null,
              plugins: r || c ? d.plugins : null,
              toolbar: d,
            }
          );
        },
        _initElements: function (e, t, i, n) {
          (t.style.cssText = e._editorStyles.top),
            /inline/i.test(e.mode)
              ? ((i.className += " ke-toolbar-inline"),
                (i.style.width = e.toolbarWidth))
              : /balloon/i.test(e.mode) &&
                ((i.className += " ke-toolbar-balloon"),
                (i.style.width = e.toolbarWidth),
                i.appendChild(n));
          var l = document.createElement(e.iframe ? "IFRAME" : "DIV");
          (l.className = "ke-wrapper-inner ke-wrapper-wysiwyg"),
            e.iframe
              ? ((l.allowFullscreen = !0),
                (l.frameBorder = 0),
                (l.style.cssText = e._editorStyles.frame))
              : (l.setAttribute("contenteditable", !0),
                l.setAttribute("scrolling", "auto"),
                (l.className += " kothing-editor-editable"),
                (l.style.cssText =
                  e._editorStyles.frame + e._editorStyles.editor));
          var o = document.createElement("TEXTAREA");
          (o.className = "ke-wrapper-inner ke-wrapper-code"),
            (o.style.cssText = e._editorStyles.frame),
            (o.style.display = "none"),
            "auto" === e.height && (o.style.overflow = "hidden");
          var s,
            a,
            r = null,
            c = null,
            d = null,
            u = null,
            h = null;
          e.resizingBar &&
            (((r = document.createElement("DIV")).className =
              "ke-resizing-bar kothing-editor-common"),
            ((c = document.createElement("DIV")).className =
              "ke-navigation kothing-editor-common"),
            r.appendChild(c),
            e.charCounter &&
              (((d = document.createElement("DIV")).className =
                "ke-char-counter-wrapper"),
              e.charCounterLabel &&
                (((s = document.createElement("SPAN")).className =
                  "ke-char-label"),
                (s.textContent = e.charCounterLabel),
                d.appendChild(s)),
              ((u = document.createElement("SPAN")).className =
                "ke-char-counter"),
              (u.textContent = "0"),
              d.appendChild(u),
              0 < e.maxCharCount &&
                (((a = document.createElement("SPAN")).textContent =
                  " / " + e.maxCharCount),
                d.appendChild(a)),
              r.appendChild(d)));
          var g = null;
          return (
            e.placeholder &&
              (((g = document.createElement("SPAN")).className =
                "ke-placeholder"),
              (g.innerText = e.placeholder)),
            ((h = document.createElement("DIV")).className = "ke-powered-by"),
            (h.innerHTML =
              '<a href="https://github.com/kothing/kothing-editor" target="_blank" title="Kothing-Editor">Powered By Kothing</a>'),
            r.appendChild(h),
            {
              bottomBar: {
                resizingBar: r,
                navigation: c,
                charWrapper: d,
                charCounter: u,
              },
              wysiwygFrame: l,
              codeView: o,
              placeholder: g,
            }
          );
        },
        _initOptions: function (e, t) {
          (t.lang = t.lang || T.a),
            (t.value = "string" == typeof t.value ? t.value : null),
            (t.historyStackDelayTime =
              "number" == typeof t.historyStackDelayTime
                ? t.historyStackDelayTime
                : 400),
            (t._defaultTagsWhitelist =
              "string" == typeof t._defaultTagsWhitelist
                ? t._defaultTagsWhitelist
                : "br|p|div|pre|blockquote|h[1-6]|ol|ul|li|hr|figure|figcaption|img|iframe|audio|video|source|table|thead|tbody|tr|th|td|a|b|strong|var|i|em|u|ins|s|span|strike|del|sub|sup|code"),
            (t._editorTagsWhitelist =
              t._defaultTagsWhitelist +
              ("string" == typeof t.addTagsWhitelist &&
              0 < t.addTagsWhitelist.length
                ? "|" + t.addTagsWhitelist
                : "")),
            (t.pasteTagsWhitelist =
              "string" == typeof t.pasteTagsWhitelist
                ? t.pasteTagsWhitelist
                : t._editorTagsWhitelist),
            (t.attributesWhitelist =
              t.attributesWhitelist && "object" === B(t.attributesWhitelist)
                ? t.attributesWhitelist
                : null),
            (t.mode = t.mode || "classic"),
            (t.toolbarWidth = t.toolbarWidth
              ? z.isNumber(t.toolbarWidth)
                ? t.toolbarWidth + "px"
                : t.toolbarWidth
              : "auto"),
            (t.toolbarContainer = /balloon/i.test(t.mode)
              ? null
              : "string" == typeof t.toolbarContainer
              ? document.querySelector(t.toolbarContainer)
              : t.toolbarContainer),
            (t.stickyToolbar =
              /balloon/i.test(t.mode) || t.toolbarContainer
                ? -1
                : void 0 === t.stickyToolbar
                ? 0
                : /^\d+/.test(t.stickyToolbar)
                ? z.getNumber(t.stickyToolbar, 0)
                : -1),
            (t.fullPage = !!t.fullPage),
            (t.iframe = t.fullPage || t.iframe),
            (t.iframeCSSFileName = t.iframe
              ? "string" == typeof t.iframeCSSFileName
                ? [t.iframeCSSFileName]
                : t.iframeCSSFileName || ["kothing-editor"]
              : null),
            (t.codeMirror = t.codeMirror
              ? t.codeMirror.src
                ? t.codeMirror
                : { src: t.codeMirror }
              : null),
            (t.position = "string" == typeof t.position ? t.position : null),
            (t.display =
              t.display ||
              ("none" !== e.style.display && e.style.display
                ? e.style.display
                : "block")),
            (t.popupDisplay = t.popupDisplay || "full"),
            (t.resizingBar =
              void 0 === t.resizingBar
                ? !/inline|balloon/i.test(t.mode)
                : t.resizingBar),
            (t.showPathLabel =
              !!t.resizingBar &&
              ("boolean" != typeof t.showPathLabel || t.showPathLabel)),
            (t.charCounter =
              0 < t.maxCharCount ||
              ("boolean" == typeof t.charCounter && t.charCounter)),
            (t.charCounterType =
              "string" == typeof t.charCounterType
                ? t.charCounterType
                : "char"),
            (t.charCounterLabel =
              "string" == typeof t.charCounterLabel
                ? t.charCounterLabel.trim()
                : null),
            (t.maxCharCount =
              z.isNumber(t.maxCharCount) && -1 < t.maxCharCount
                ? +t.maxCharCount
                : null),
            (t.width = t.width
              ? z.isNumber(t.width)
                ? t.width + "px"
                : t.width
              : e.clientWidth
              ? e.clientWidth + "px"
              : "100%"),
            (t.minWidth =
              (z.isNumber(t.minWidth) ? t.minWidth + "px" : t.minWidth) || ""),
            (t.maxWidth =
              (z.isNumber(t.maxWidth) ? t.maxWidth + "px" : t.maxWidth) || ""),
            (t.height = t.height
              ? z.isNumber(t.height)
                ? t.height + "px"
                : t.height
              : e.clientHeight
              ? e.clientHeight + "px"
              : "auto"),
            (t.minHeight =
              (z.isNumber(t.minHeight) ? t.minHeight + "px" : t.minHeight) ||
              ""),
            (t.maxHeight =
              (z.isNumber(t.maxHeight) ? t.maxHeight + "px" : t.maxHeight) ||
              ""),
            (t.defaultStyle =
              "string" == typeof t.defaultStyle ? t.defaultStyle : ""),
            (t.font = t.font ? t.font : null),
            (t.fontSize = t.fontSize ? t.fontSize : null),
            (t.formats = t.formats ? t.formats : null),
            (t.colorList = t.colorList ? t.colorList : null),
            (t.lineHeights = t.lineHeights ? t.lineHeights : null),
            (t.paragraphStyles = t.paragraphStyles ? t.paragraphStyles : null),
            (t.textStyles = t.textStyles ? t.textStyles : null),
            (t.fontSizeUnit =
              ("string" == typeof t.fontSizeUnit && t.fontSizeUnit.trim()) ||
              "px"),
            (t.imageResizing = void 0 === t.imageResizing || t.imageResizing),
            (t.imageHeightShow =
              void 0 === t.imageHeightShow || !!t.imageHeightShow),
            (t.imageWidth = t.imageWidth
              ? z.isNumber(t.imageWidth)
                ? t.imageWidth + "px"
                : t.imageWidth
              : "auto"),
            (t.imageHeight = t.imageHeight
              ? z.isNumber(t.imageHeight)
                ? t.imageHeight + "px"
                : t.imageHeight
              : "auto"),
            (t.imageSizeOnlyPercentage = !!t.imageSizeOnlyPercentage),
            (t._imageSizeUnit = t.imageSizeOnlyPercentage ? "%" : "px"),
            (t.imageRotation =
              void 0 !== t.imageRotation
                ? t.imageRotation
                : !(t.imageSizeOnlyPercentage || !t.imageHeightShow)),
            (t.imageFileInput =
              void 0 === t.imageFileInput || t.imageFileInput),
            (t.imageUrlInput =
              void 0 === t.imageUrlInput ||
              !t.imageFileInput ||
              t.imageUrlInput),
            (t.imageUploadHeader = t.imageUploadHeader || null),
            (t.imageUploadUrl =
              "string" == typeof t.imageUploadUrl ? t.imageUploadUrl : null),
            (t.imageUploadSizeLimit = /\d+/.test(t.imageUploadSizeLimit)
              ? z.getNumber(t.imageUploadSizeLimit, 0)
              : null),
            (t.imageMultipleFile = !!t.imageMultipleFile),
            (t.imageAccept =
              ("string" == typeof t.imageAccept && t.imageAccept.trim()) ||
              "*"),
            (t.imageGalleryUrl =
              "string" == typeof t.imageGalleryUrl ? t.imageGalleryUrl : null),
            (t.videoResizing = void 0 === t.videoResizing || t.videoResizing),
            (t.videoHeightShow =
              void 0 === t.videoHeightShow || !!t.videoHeightShow),
            (t.videoRatioShow =
              void 0 === t.videoRatioShow || !!t.videoRatioShow),
            (t.videoWidth =
              t.videoWidth && z.getNumber(t.videoWidth, 0)
                ? z.isNumber(t.videoWidth)
                  ? t.videoWidth + "px"
                  : t.videoWidth
                : ""),
            (t.videoHeight =
              t.videoHeight && z.getNumber(t.videoHeight, 0)
                ? z.isNumber(t.videoHeight)
                  ? t.videoHeight + "px"
                  : t.videoHeight
                : ""),
            (t.videoSizeOnlyPercentage = !!t.videoSizeOnlyPercentage),
            (t._videoSizeUnit = t.videoSizeOnlyPercentage ? "%" : "px"),
            (t.videoRotation =
              void 0 !== t.videoRotation
                ? t.videoRotation
                : !(t.videoSizeOnlyPercentage || !t.videoHeightShow)),
            (t.videoRatio = z.getNumber(t.videoRatio, 4) || 0.5625),
            (t.videoRatioList = t.videoRatioList ? t.videoRatioList : null),
            (t.youtubeQuery = (t.youtubeQuery || "").replace("?", "")),
            (t.videoFileInput = !!t.videoFileInput),
            (t.videoUrlInput =
              void 0 === t.videoUrlInput ||
              !t.videoFileInput ||
              t.videoUrlInput),
            (t.videoUploadHeader = t.videoUploadHeader || null),
            (t.videoUploadUrl =
              "string" == typeof t.videoUploadUrl ? t.videoUploadUrl : null),
            (t.videoUploadSizeLimit = /\d+/.test(t.videoUploadSizeLimit)
              ? z.getNumber(t.videoUploadSizeLimit, 0)
              : null),
            (t.videoMultipleFile = !!t.videoMultipleFile),
            (t.videoTagAttrs = t.videoTagAttrs || null),
            (t.videoIframeAttrs = t.videoIframeAttrs || null),
            (t.videoAccept =
              ("string" == typeof t.videoAccept && t.videoAccept.trim()) ||
              "*"),
            (t.audioWidth = t.audioWidth
              ? z.isNumber(t.audioWidth)
                ? t.audioWidth + "px"
                : t.audioWidth
              : ""),
            (t.audioHeight = t.audioHeight
              ? z.isNumber(t.audioHeight)
                ? t.audioHeight + "px"
                : t.audioHeight
              : ""),
            (t.audioFileInput = !!t.audioFileInput),
            (t.audioUrlInput =
              void 0 === t.audioUrlInput ||
              !t.audioFileInput ||
              t.audioUrlInput),
            (t.audioUploadHeader = t.audioUploadHeader || null),
            (t.audioUploadUrl =
              "string" == typeof t.audioUploadUrl ? t.audioUploadUrl : null),
            (t.audioUploadSizeLimit = /\d+/.test(t.audioUploadSizeLimit)
              ? z.getNumber(t.audioUploadSizeLimit, 0)
              : null),
            (t.audioMultipleFile = !!t.audioMultipleFile),
            (t.audioTagAttrs = t.audioTagAttrs || null),
            (t.audioAccept =
              ("string" == typeof t.audioAccept && t.audioAccept.trim()) ||
              "*"),
            (t.tableCellControllerPosition =
              "string" == typeof t.tableCellControllerPosition
                ? t.tableCellControllerPosition.toLowerCase()
                : "cell"),
            (t.tabDisable = !!t.tabDisable),
            (t.shortcutsDisable =
              Array.isArray(t.shortcutsDisable) && 0 < t.shortcutsDisable.length
                ? t.shortcutsDisable.map(function (e) {
                    return e.toLowerCase();
                  })
                : []),
            (t.shortcutsHint = void 0 === t.shortcutsHint || !!t.shortcutsHint),
            (t.callBackSave = t.callBackSave ? t.callBackSave : null),
            (t.templates = t.templates ? t.templates : null),
            (t.placeholder =
              "string" == typeof t.placeholder ? t.placeholder : null),
            (t.linkProtocol =
              "string" == typeof t.linkProtocol ? t.linkProtocol : null),
            (t.katex = t.katex
              ? t.katex.src
                ? t.katex
                : { src: t.katex }
              : null),
            (t.toolbarItem = t.toolbarItem || [
              ["undo", "redo"],
              [
                "bold",
                "underline",
                "italic",
                "strike",
                "subscript",
                "superscript",
              ],
              ["removeFormat"],
              ["outdent", "indent"],
              ["fullScreen", "showBlocks", "codeView"],
              ["preview", "print"],
            ]),
            (t.icons =
              t.icons && "object" === B(t.icons)
                ? [S, t.icons].reduce(function (e, t) {
                    for (var i in t) z.hasOwn(t, i) && (e[i] = t[i]);
                    return e;
                  }, {})
                : S),
            (t._editorStyles = z._setDefaultOptionStyle(t, t.defaultStyle));
        },
        _defaultButtons: function (e) {
          var t = e.icons,
            i = e.lang,
            n = z.isOSX_IOS ? "\u2318" : "CTRL",
            l = e.shortcutsHint
              ? e.shortcutsDisable
              : ["bold", "strike", "underline", "italic", "undo", "indent"];
          return {
            bold: [
              "_ke_command_bold",
              i.toolbar.bold + (-1 < l.indexOf("bold") ? "" : " (" + n + "+B)"),
              "STRONG",
              "",
              t.bold,
            ],
            underline: [
              "_ke_command_underline",
              i.toolbar.underline +
                (-1 < l.indexOf("underline") ? "" : " (" + n + "+U)"),
              "U",
              "",
              t.underline,
            ],
            italic: [
              "_ke_command_italic",
              i.toolbar.italic +
                (-1 < l.indexOf("italic") ? "" : " (" + n + "+I)"),
              "EM",
              "",
              t.italic,
            ],
            strike: [
              "_ke_command_strike",
              i.toolbar.strike +
                (-1 < l.indexOf("strike") ? "" : " (" + n + "+SHIFT+S)"),
              "DEL",
              "",
              t.strike,
            ],
            subscript: [
              "_ke_command_subscript",
              i.toolbar.subscript,
              "SUB",
              "",
              t.subscript,
            ],
            superscript: [
              "_ke_command_superscript",
              i.toolbar.superscript,
              "SUP",
              "",
              t.superscript,
            ],
            removeFormat: [
              "",
              i.toolbar.removeFormat,
              "removeFormat",
              "",
              t.erase,
            ],
            indent: [
              "_ke_command_indent",
              i.toolbar.indent +
                (-1 < l.indexOf("indent") ? "" : " (" + n + "+])"),
              "indent",
              "",
              t.outdent,
            ],
            outdent: [
              "_ke_command_outdent",
              i.toolbar.outdent +
                (-1 < l.indexOf("indent") ? "" : " (" + n + "+[)"),
              "outdent",
              "",
              t.indent,
            ],
            fullScreen: [
              "ke-code-view-enabled ke-resizing-enabled _ke_command_fullScreen",
              i.toolbar.fullScreen,
              "fullScreen",
              "",
              t.expansion,
            ],
            showBlocks: [
              "_ke_command_showBlocks",
              i.toolbar.showBlocks,
              "showBlocks",
              "",
              t.show_blocks,
            ],
            codeView: [
              "ke-code-view-enabled ke-resizing-enabled _ke_command_codeView",
              i.toolbar.codeView,
              "codeView",
              "",
              t.code_view,
            ],
            undo: [
              "_ke_command_undo ke-resizing-enabled",
              i.toolbar.undo + (-1 < l.indexOf("undo") ? "" : " (" + n + "+Z)"),
              "undo",
              "",
              t.undo,
            ],
            redo: [
              "_ke_command_redo ke-resizing-enabled",
              i.toolbar.redo +
                (-1 < l.indexOf("undo")
                  ? ""
                  : " (" + n + "+Y / " + n + "+SHIFT+Z)"),
              "redo",
              "",
              t.redo,
            ],
            preview: [
              "ke-resizing-enabled",
              i.toolbar.preview,
              "preview",
              "",
              t.preview,
            ],
            print: [
              "ke-resizing-enabled",
              i.toolbar.print,
              "print",
              "",
              t.print,
            ],
            save: [
              "_ke_command_save ke-resizing-enabled",
              i.toolbar.save,
              "save",
              "",
              t.save,
            ],
            blockquote: [
              "",
              i.toolbar.tag_blockquote,
              "blockquote",
              "command",
              t.blockquote,
            ],
            font: [
              "ke-btn-select ke-btn-tool-font",
              i.toolbar.font,
              "font",
              "submenu",
              '<span class="txt">' + i.toolbar.font + "</span>" + t.arrow_down,
            ],
            formatBlock: [
              "ke-btn-select ke-btn-tool-format",
              i.toolbar.formats,
              "formatBlock",
              "submenu",
              '<span class="txt">' +
                i.toolbar.formats +
                "</span>" +
                t.arrow_down,
            ],
            fontSize: [
              "ke-btn-select ke-btn-tool-size",
              i.toolbar.fontSize,
              "fontSize",
              "submenu",
              '<span class="txt">' +
                i.toolbar.fontSize +
                "</span>" +
                t.arrow_down,
            ],
            fontColor: [
              "",
              i.toolbar.fontColor,
              "fontColor",
              "submenu",
              t.font_color,
            ],
            hiliteColor: [
              "",
              i.toolbar.hiliteColor,
              "hiliteColor",
              "submenu",
              t.highlight_color,
            ],
            align: [
              "ke-btn-align",
              i.toolbar.align,
              "align",
              "submenu",
              t.align_left,
            ],
            list: ["", i.toolbar.list, "list", "submenu", t.list_number],
            horizontalRule: [
              "btn_line",
              i.toolbar.horizontalRule,
              "horizontalRule",
              "submenu",
              t.horizontal_rule,
            ],
            table: ["", i.toolbar.table, "table", "submenu", t.table],
            lineHeight: [
              "",
              i.toolbar.lineHeight,
              "lineHeight",
              "submenu",
              t.line_height,
            ],
            template: [
              "",
              i.toolbar.template,
              "template",
              "submenu",
              t.template,
            ],
            paragraphStyle: [
              "",
              i.toolbar.paragraphStyle,
              "paragraphStyle",
              "submenu",
              t.paragraph_style,
            ],
            textStyle: [
              "",
              i.toolbar.textStyle,
              "textStyle",
              "submenu",
              t.text_style,
            ],
            link: ["", i.toolbar.link, "link", "dialog", t.link],
            image: ["", i.toolbar.image, "image", "dialog", t.image],
            video: ["", i.toolbar.video, "video", "dialog", t.video],
            audio: ["", i.toolbar.audio, "audio", "dialog", t.audio],
            math: ["", i.toolbar.math, "math", "dialog", t.math],
            imageGallery: [
              "",
              i.toolbar.imageGallery,
              "imageGallery",
              "fileBrowser",
              t.image_gallery,
            ],
          };
        },
        _createModuleGroup: function () {
          var e = z.createElement("DIV");
          e.className = "ke-btn-module ke-btn-module-border";
          var t = z.createElement("UL");
          return (
            (t.className = "ke-menu-list"), e.appendChild(t), { div: e, ul: t }
          );
        },
        _createButton: function (e, t, i, n, l, o, s) {
          var a = z.createElement("LI"),
            r = z.createElement("BUTTON");
          return (
            r.setAttribute("type", "button"),
            r.setAttribute(
              "class",
              "ke-btn" + (e ? " " + e : "") + " ke-tooltip"
            ),
            r.setAttribute("data-command", i),
            r.setAttribute("data-display", n),
            r.setAttribute("tabindex", "-1"),
            /^default\./i.test(
              (l = l || '<span class="ke-icon-text">!</span>')
            ) && (l = s[l.replace(/^default\./i, "")]),
            /^text\./i.test(l) &&
              ((l = l.replace(/^text\./i, "")),
              (r.className += " ke-btn-more-text")),
            (l +=
              '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
              (t || i) +
              "</span></span>"),
            o && r.setAttribute("disabled", !0),
            (r.innerHTML = l),
            a.appendChild(r),
            { li: a, button: r }
          );
        },
        _createToolBar: function (e, t, i, n) {
          var l = e.createElement("DIV");
          l.className = "ke-toolbar-separator-vertical";
          var o = e.createElement("DIV");
          o.className = "ke-toolbar kothing-editor-common";
          var s = e.createElement("DIV");
          (s.className = "ke-btn-tray"), o.appendChild(s);
          var a = n.icons,
            r = this._defaultButtons(n),
            c = {},
            d = [],
            u = {};
          if (i)
            for (
              var h,
                g = i.length
                  ? i
                  : Object.keys(i).map(function (e) {
                      return i[e];
                    }),
                p = 0,
                m = g.length;
              p < m;
              p++
            )
              u[(h = g[p].default || g[p]).name] = h;
          var f,
            v,
            _ = null,
            b = null,
            y = null,
            w = "",
            C = !1,
            k = z.createElement("DIV");
          k.className = "ke-toolbar-more-layer";
          e: for (var x, E, S, N, T = 0; T < t.length; T++)
            if (
              ((x = !1),
              (N = ""),
              (S = t[T]),
              (y = this._createModuleGroup()),
              "object" === B(S))
            ) {
              for (var L, A, M, H, I = 0; I < S.length; I++) {
                if (((b = S[I]), (L = !1), /^\%\d+/.test(b) && 0 === I)) {
                  (S[0] = b.replace(/[^\d]/g, "")), d.push(S), t.splice(T--, 1);
                  continue e;
                }
                if ("object" === B(b))
                  "function" == typeof b.add
                    ? ((_ = r[(w = b.name)]), (u[w] = b))
                    : ((w = b.name),
                      (_ = [
                        b.buttonClass,
                        b.title,
                        b.name,
                        b.dataDisplay,
                        b.innerHTML,
                        b._disabled,
                      ]));
                else {
                  if (/^\-/.test(b)) {
                    (N = b.substr(1)), (y.div.style.float = N);
                    continue;
                  }
                  if (
                    ((_ = /^\:/.test(b)
                      ? ((L = !0),
                        (M =
                          "__ke__" +
                          (A = b.match(
                            /^\:([^\-]+)\-([^\-]+)\-([^\-]+)/
                          ))[1].trim()),
                        ["ke-btn-more", A[2].trim(), M, "MORE", A[3].trim()])
                      : r[b]),
                    (w = b),
                    !_)
                  ) {
                    var F = u[w];
                    if (!F)
                      throw Error(
                        "[KothingEditor.create.toolbar.fail] The button name of a plugin that does not exist. [" +
                          w +
                          "]"
                      );
                    _ = [
                      F.buttonClass,
                      F.title,
                      F.name,
                      F.display,
                      F.innerHTML,
                      F._disabled,
                    ];
                  }
                }
                (f = this._createButton(_[0], _[1], _[2], _[3], _[4], _[5], a)),
                  (x ? E : y.ul).appendChild(f.li),
                  u[w] && (c[w] = f.button),
                  L &&
                    ((x = !0),
                    ((E = z.createElement("DIV")).className =
                      "ke-more-layer " + M),
                    (E.innerHTML =
                      '<div class="ke-more-form"><ul class="ke-menu-list"' +
                      (N ? ' style="float: ' + N + ';"' : "") +
                      "></ul></div>"),
                    k.appendChild(E),
                    (E = E.firstElementChild.firstElementChild));
              }
              C &&
                ((H = l.cloneNode(!1)),
                N && (H.style.float = N),
                s.appendChild(H)),
                s.appendChild(y.div),
                (C = !0);
            } else
              /^\/$/.test(S) &&
                (((v = e.createElement("DIV")).className =
                  "ke-btn-module-enter"),
                s.appendChild(v),
                (C = !1));
          1 === s.children.length &&
            z.removeClass(s.firstElementChild, "ke-btn-module-border"),
            0 < d.length && d.unshift(t),
            0 < k.children.length && s.appendChild(k);
          var D = e.createElement("DIV");
          (D.className = "ke-menu-tray"), o.appendChild(D);
          var R = e.createElement("DIV");
          return (
            (R.className = "ke-toolbar-cover"),
            o.appendChild(R),
            {
              element: o,
              plugins: u,
              pluginCallButtons: c,
              responsiveButtons: d,
              _menuTray: D,
              _buttonTray: s,
            }
          );
        },
      },
      M = function (e, t, i) {
        return {
          element: {
            originElement: e,
            topArea: t._top,
            relative: t._relative,
            toolbar: t._toolBar,
            _buttonTray: t._toolBar.querySelector(".ke-btn-tray"),
            _menuTray: t._menuTray,
            resizingBar: t._resizingBar,
            navigation: t._navigation,
            charWrapper: t._charWrapper,
            charCounter: t._charCounter,
            editorArea: t._editorArea,
            wysiwygFrame: t._wysiwygArea,
            wysiwyg: t._wysiwygArea,
            code: t._codeArea,
            placeholder: t._placeholder,
            loading: t._loading,
            lineBreaker: t._lineBreaker,
            lineBreaker_t: t._lineBreaker_t,
            lineBreaker_b: t._lineBreaker_b,
            resizeBackground: t._resizeBack,
            _stickyDummy: t._stickyDummy,
            _arrow: t._arrow,
          },
          tool: {
            cover: t._toolBar.querySelector(".ke-toolbar-cover"),
            bold: t._toolBar.querySelector("._ke_command_bold"),
            underline: t._toolBar.querySelector("._ke_command_underline"),
            italic: t._toolBar.querySelector("._ke_command_italic"),
            strike: t._toolBar.querySelector("._ke_command_strike"),
            subscript: t._toolBar.querySelector("._ke_command_subscript"),
            superscript: t._toolBar.querySelector("._ke_command_superscript"),
            undo: t._toolBar.querySelector("._ke_command_undo"),
            redo: t._toolBar.querySelector("._ke_command_redo"),
            save: t._toolBar.querySelector("._ke_command_save"),
            outdent: t._toolBar.querySelector("._ke_command_outdent"),
            indent: t._toolBar.querySelector("._ke_command_indent"),
            fullScreen: t._toolBar.querySelector("._ke_command_fullScreen"),
            showBlocks: t._toolBar.querySelector("._ke_command_showBlocks"),
            codeView: t._toolBar.querySelector("._ke_command_codeView"),
          },
          options: i,
          option: i,
        };
      },
      H = {
        name: "notice",
        add: function (e) {
          var t = e.context;
          t.notice = {};
          var i = e.util.createElement("DIV"),
            n = e.util.createElement("SPAN"),
            l = e.util.createElement("BUTTON");
          (i.className = "ke-notice"),
            (l.className = "close"),
            l.setAttribute("aria-label", "Close"),
            l.setAttribute("title", e.lang.dialogBox.close),
            (l.innerHTML = e.icons.cancel),
            i.appendChild(n),
            i.appendChild(l),
            (t.notice.modal = i),
            (t.notice.message = n),
            l.addEventListener("click", this.onClick_cancel.bind(e)),
            t.element.editorArea.appendChild(i),
            (i = null);
        },
        onClick_cancel: function (e) {
          e.preventDefault(),
            e.stopPropagation(),
            this.plugins.notice.close.call(this);
        },
        open: function (e) {
          (this.context.notice.message.textContent = e),
            (this.context.notice.modal.style.display = "block");
        },
        close: function () {
          this.context.notice.modal.style.display = "none";
        },
      };
    function I(e) {
      return (I =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    function F(e) {
      return (F =
        "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
          ? function (e) {
              return typeof e;
            }
          : function (e) {
              return e &&
                "function" == typeof Symbol &&
                e.constructor === Symbol &&
                e !== Symbol.prototype
                ? "symbol"
                : typeof e;
            })(e);
    }
    var D = {
      init: function (e) {
        return {
          create: function (t, i) {
            return this.create(t, i, e);
          }.bind(this),
        };
      },
      create: function (e, t, i) {
        z._propertiesInit(),
          "object" !== F(t) && (t = {}),
          i &&
            (t = [i, t].reduce(function (e, t) {
              for (var i in t)
                z.hasOwn(t, i) &&
                  ("plugins" === i && t[i] && e[i]
                    ? (function () {
                        var n = e[i],
                          l = t[i];
                        (n = n.length
                          ? n
                          : Object.keys(n).map(function (e) {
                              return n[e];
                            })),
                          (l = l.length
                            ? l
                            : Object.keys(l).map(function (e) {
                                return l[e];
                              }));
                        e[i] = l
                          .filter(function (e) {
                            return -1 === n.indexOf(e);
                          })
                          .concat(n);
                      })()
                    : (e[i] = t[i]));
              return e;
            }, {}));
        var n = "string" == typeof e ? document.getElementById(e) : e;
        if (!n) {
          if ("string" == typeof e)
            throw Error(
              '[KothingEditor.create.fail] The element for that id was not found (ID:"' +
                e +
                '")'
            );
          throw Error(
            "[KothingEditor.create.fail] kothingEditor requires textarea's element or id value"
          );
        }
        var l = A.init(n, t);
        if (
          l.constructed._top.id &&
          document.getElementById(l.constructed._top.id)
        )
          throw Error(
            '[KothingEditor.create.fail] The ID of the kothingEditor you are trying to create already exists (ID:"' +
              l.constructed._top.id +
              '")'
          );
        return (function (e, t, i, n, l, o) {
          var s = e.element.originElement.ownerDocument || document,
            a = s.defaultView || window,
            r = z,
            c = l.icons,
            d = {
              _d: s,
              _w: a,
              _parser: new a.DOMParser(),
              _wd: null,
              _ww: null,
              _shadowRoot: null,
              util: r,
              functions: null,
              notice: H,
              icons: c,
              history: null,
              context: e,
              pluginCallButtons: t,
              plugins: i || {},
              initPlugins: {},
              _targetPlugins: {},
              _menuTray: {},
              lang: n,
              effectNode: null,
              submenu: null,
              container: null,
              _submenuName: "",
              _bindedSubmenuOff: null,
              _bindedContainerOff: null,
              submenuActiveButton: null,
              containerActiveButton: null,
              controllerArray: [],
              currentControllerName: "",
              currentControllerTarget: null,
              currentFileComponentInfo: null,
              codeViewDisabledButtons: null,
              resizingDisabledButtons: null,
              _moreLayerActiveButton: null,
              _htmlCheckWhitelistRegExp: null,
              _disallowedTextTagsRegExp: null,
              editorTagsWhitelistRegExp: null,
              pasteTagsWhitelistRegExp: null,
              hasFocus: !1,
              isDisabled: !1,
              _attributesWhitelistRegExp: null,
              _attributesTagsWhitelist: null,
              _bindControllersOff: null,
              _isInline: null,
              _isBalloon: null,
              _isBalloonAlways: null,
              _inlineToolbarAttr: { top: "", width: "", isShow: !1 },
              _notHideToolbar: !1,
              _sticky: !1,
              _antiBlur: !1,
              _lineBreaker: null,
              _lineBreakerButton: null,
              _componentsInfoInit: !0,
              _componentsInfoReset: !1,
              activePlugins: null,
              managedTagsInfo: null,
              _charTypeHTML: !1,
              _fileInfoPluginsCheck: null,
              _fileInfoPluginsReset: null,
              _fileManager: {
                tags: null,
                regExp: null,
                queryString: null,
                pluginRegExp: null,
                pluginMap: null,
              },
              commandMap: null,
              _styleCommandMap: null,
              _defaultCommand: {
                bold: "STRONG",
                underline: "U",
                italic: "EM",
                strike: "DEL",
                subscript: "SUB",
                superscript: "SUP",
              },
              _variable: {
                isCodeView: !1,
                isFullScreen: !1,
                innerHeight_fullScreen: 0,
                resizeClientY: 0,
                tabSize: 4,
                codeIndent: 4,
                minResizingSize: r.getNumber(
                  e.element.wysiwygFrame.style.minHeight || "65",
                  0
                ),
                currentNodes: [],
                currentNodesMap: [],
                _range: null,
                _selectionNode: null,
                _originCssText: e.element.topArea.style.cssText,
                _bodyOverflow: "",
                _editorAreaOriginCssText: "",
                _wysiwygOriginCssText: "",
                _codeOriginCssText: "",
                _fullScreenAttrs: { sticky: !1, balloon: !1, inline: !1 },
                _lineBreakComp: null,
                _lineBreakDir: "",
              },
              callPlugin: function (e, i, n) {
                if (((n = n || t[e]), !this.plugins[e]))
                  throw Error(
                    '[KothingEditor.core.callPlugin.fail] The called plugin does not exist or is in an invalid format. (pluginName:"' +
                      e +
                      '")'
                  );
                this.initPlugins[e]
                  ? "object" === I(this._targetPlugins[e]) &&
                    n &&
                    this.initMenuTarget(e, n, this._targetPlugins[e])
                  : (this.plugins[e].add(this, n), (this.initPlugins[e] = !0)),
                  this.plugins[e].active &&
                    !this.commandMap[e] &&
                    n &&
                    ((this.commandMap[e] = n), this.activePlugins.push(e)),
                  "function" == typeof i && i();
              },
              addModule: function (e) {
                for (var t, i = 0, n = e.length; i < n; i++)
                  (t = e[i].name),
                    this.plugins[t] || (this.plugins[t] = e[i]),
                    this.initPlugins[t] ||
                      ((this.initPlugins[t] = !0),
                      "function" == typeof this.plugins[t].add &&
                        this.plugins[t].add(this));
              },
              initMenuTarget: function (t, i, n) {
                i
                  ? (e.element._menuTray.appendChild(n),
                    (this._targetPlugins[t] = !0),
                    (this._menuTray[i.getAttribute("data-command")] = n))
                  : (this._targetPlugins[t] = n);
              },
              submenuOn: function (e) {
                this._bindedSubmenuOff && this._bindedSubmenuOff(),
                  this._bindControllersOff && this.controllersOff();
                var t = (this._submenuName = e.getAttribute("data-command")),
                  i = (this.submenu = this._menuTray[t]);
                (this.submenuActiveButton = e),
                  this._setMenuPosition(e, i),
                  (this._bindedSubmenuOff = this.submenuOff.bind(this)),
                  this.addDocEvent("mousedown", this._bindedSubmenuOff, !1),
                  this.plugins[t].on && this.plugins[t].on.call(this),
                  (this._antiBlur = !0);
              },
              submenuOff: function () {
                this.removeDocEvent("mousedown", this._bindedSubmenuOff),
                  (this._bindedSubmenuOff = null),
                  this.submenu &&
                    ((this._submenuName = ""),
                    (this.submenu.style.display = "none"),
                    (this.submenu = null),
                    r.removeClass(this.submenuActiveButton, "on"),
                    (this.submenuActiveButton = null),
                    (this._notHideToolbar = !1)),
                  (this._antiBlur = !1);
              },
              containerOn: function (e) {
                this._bindedContainerOff && this._bindedContainerOff();
                var t = (this._containerName = e.getAttribute("data-command")),
                  i = (this.container = this._menuTray[t]);
                (this.containerActiveButton = e),
                  this._setMenuPosition(e, i),
                  (this._bindedContainerOff = this.containerOff.bind(this)),
                  this.addDocEvent("mousedown", this._bindedContainerOff, !1),
                  this.plugins[t].on && this.plugins[t].on.call(this),
                  (this._antiBlur = !0);
              },
              containerOff: function () {
                this.removeDocEvent("mousedown", this._bindedContainerOff),
                  (this._bindedContainerOff = null),
                  this.container &&
                    ((this._containerName = ""),
                    (this.container.style.display = "none"),
                    (this.container = null),
                    r.removeClass(this.containerActiveButton, "on"),
                    (this.containerActiveButton = null),
                    (this._notHideToolbar = !1)),
                  (this._antiBlur = !1);
              },
              _setMenuPosition: function (t, i) {
                (i.style.top = "-10000px"),
                  (i.style.visibility = "hidden"),
                  (i.style.display = "block"),
                  (i.style.height = ""),
                  r.addClass(t, "on");
                var n = this.context.element.toolbar,
                  l = n.offsetWidth,
                  o = i.offsetWidth,
                  s = t.parentElement.offsetLeft + 3,
                  c = l <= o ? 0 : l - (s + o);
                i.style.left = c < 0 ? s + c + "px" : s + "px";
                for (var d = 0, h = t; h && h !== n; )
                  (d += h.offsetTop), (h = h.offsetParent);
                var g = d;
                this._isBalloon
                  ? (d += n.offsetTop + t.offsetHeight)
                  : (d -= t.offsetHeight);
                for (
                  var p = u._getEditorOffsets(e.element.toolbar).top,
                    m = i.offsetHeight,
                    f = e.element.topArea,
                    v = 0;
                  f;

                )
                  (v += f.scrollTop), (f = f.parentElement);
                var _,
                  b,
                  y,
                  w =
                    a.innerHeight - (p - v + g + t.parentElement.offsetHeight);
                w < m
                  ? ((y =
                      w <
                      (b =
                        m + ((_ = p - v + (y = -1 * (m - g + 3))) < 0 ? _ : 0))
                        ? ((i.style.height = b + "px"), -1 * (b - g + 3))
                        : ((i.style.height = w + "px"),
                          g + t.parentElement.offsetHeight)),
                    (i.style.top = y + "px"))
                  : (i.style.top = g + t.parentElement.offsetHeight + "px"),
                  (i.style.visibility = "");
              },
              controllersOn: function () {
                this._bindControllersOff && this._bindControllersOff(),
                  (this.controllerArray = []);
                for (var e, t = 0; t < arguments.length; t++)
                  (e = arguments[t]) &&
                    ("string" != typeof e
                      ? "function" != typeof e
                        ? r.hasClass(e, "ke-controller")
                          ? (e.style && (e.style.display = "block"),
                            this.controllerArray.push(e))
                          : ((this.currentControllerTarget = e),
                            (this.currentFileComponentInfo = this.getFileComponent(
                              e
                            )))
                        : this.controllerArray.push(e)
                      : (this.currentControllerName = e));
                (this._bindControllersOff = this.controllersOff.bind(this)),
                  this.addDocEvent("mousedown", this._bindControllersOff, !1),
                  this.addDocEvent("keydown", this._bindControllersOff, !1),
                  (this._antiBlur = !0),
                  "function" == typeof h.showController &&
                    h.showController(
                      this.currentControllerName,
                      this.controllerArray,
                      this
                    );
              },
              controllersOff: function (t) {
                if (
                  (!this._fileManager.pluginRegExp.test(
                    this.currentControllerName
                  ) ||
                    !t ||
                    "keydown" !== t.type ||
                    27 === t.keyCode) &&
                  ((e.element.lineBreaker_t.style.display = "none"),
                  (e.element.lineBreaker_b.style.display = "none"),
                  (this._variable._lineBreakComp = null),
                  (this.currentControllerName = ""),
                  (this.currentControllerTarget = null),
                  (this.currentFileComponentInfo = null),
                  (this.effectNode = null),
                  this._bindControllersOff)
                ) {
                  this.removeDocEvent("mousedown", this._bindControllersOff),
                    this.removeDocEvent("keydown", this._bindControllersOff),
                    (this._bindControllersOff = null);
                  var i = this.controllerArray.length;
                  if (0 < i) {
                    for (var n = 0; n < i; n++)
                      "function" == typeof this.controllerArray[n]
                        ? this.controllerArray[n]()
                        : (this.controllerArray[n].style.display = "none");
                    this.controllerArray = [];
                  }
                  this._antiBlur = !1;
                }
              },
              eventStop: function (e) {
                e.stopPropagation(), e.preventDefault();
              },
              execCommand: function (e, t, i) {
                this._wd.execCommand(
                  e,
                  t,
                  "formatBlock" === e ? "<" + i + ">" : i
                ),
                  this.history.push(!0);
              },
              nativeFocus: function () {
                var t = r.getParentElement(
                  this.getSelectionNode(),
                  "figcaption"
                );
                t ? t.focus() : e.element.wysiwyg.focus(), this._editorRange();
              },
              focus: function () {
                if ("none" !== e.element.wysiwygFrame.style.display) {
                  if (l.iframe) this.nativeFocus();
                  else
                    try {
                      var t,
                        i,
                        n = this.getRange();
                      n.startContainer === n.endContainer &&
                      r.isWysiwygDiv(n.startContainer)
                        ? ((t = r.createElement("P")),
                          (i = r.createElement("BR")),
                          t.appendChild(i),
                          e.element.wysiwyg.appendChild(t),
                          this.setRange(i, 0, i, 0))
                        : this.setRange(
                            n.startContainer,
                            n.startOffset,
                            n.endContainer,
                            n.endOffset
                          );
                    } catch (t) {
                      this.nativeFocus();
                    }
                  u._applyTagEffects(),
                    this._isBalloon && u._toggleToolbarBalloon();
                }
              },
              focusEdge: function (t) {
                t = t || e.element.wysiwyg.lastElementChild;
                var i = this.getFileComponent(t);
                i
                  ? this.selectComponent(i.target, i.pluginName)
                  : t
                  ? (t = r.getChildElement(
                      t,
                      function (e) {
                        return 0 === e.childNodes.length || 3 === e.nodeType;
                      },
                      !0
                    ))
                    ? this.setRange(
                        t,
                        t.textContent.length,
                        t,
                        t.textContent.length
                      )
                    : this.nativeFocus()
                  : this.focus();
              },
              setRange: function (e, t, i, n) {
                if (e && i) {
                  t > e.textContent.length && (t = e.textContent.length),
                    n > i.textContent.length && (n = i.textContent.length);
                  var o = this._wd.createRange();
                  try {
                    o.setStart(e, t), o.setEnd(i, n);
                  } catch (e) {
                    return (
                      console.warn("[KothingEditor.core.focus.error] " + e),
                      void this.nativeFocus()
                    );
                  }
                  var s = this.getSelection();
                  return (
                    s.removeAllRanges && s.removeAllRanges(),
                    s.addRange(o),
                    this._editorRange(),
                    l.iframe && this.nativeFocus(),
                    o
                  );
                }
              },
              removeRange: function () {
                (this._variable._range = null),
                  (this._variable._selectionNode = null),
                  this.getSelection().removeAllRanges();
                var e,
                  t = this.commandMap,
                  n = this.activePlugins;
                for (e in t)
                  r.hasOwn(t, e) &&
                    (-1 < n.indexOf(e)
                      ? i[e].active.call(this, null)
                      : t.OUTDENT && /^OUTDENT$/i.test(e)
                      ? t.OUTDENT.setAttribute("disabled", !0)
                      : t.INDENT && /^INDENT$/i.test(e)
                      ? t.INDENT.removeAttribute("disabled")
                      : r.removeClass(t[e], "active"));
              },
              getRange: function () {
                var t = this._variable._range || this._createDefaultRange(),
                  i = this.getSelection();
                if (
                  t.collapsed === i.isCollapsed ||
                  !e.element.wysiwyg.contains(i.focusNode)
                )
                  return t;
                if (0 < i.rangeCount)
                  return (
                    (this._variable._range = i.getRangeAt(0)),
                    this._variable._range
                  );
                var n = i.anchorNode,
                  l = i.focusNode,
                  o = i.anchorOffset,
                  s = i.focusOffset,
                  a = r.compareElements(n, l),
                  c = a.ancestor && (0 === a.result ? o <= s : 1 < a.result);
                return this.setRange(
                  c ? n : l,
                  c ? o : s,
                  c ? l : n,
                  c ? s : o
                );
              },
              getRange_addLine: function (t) {
                var i, n;
                return (
                  this._selectionVoid(t) &&
                    ((i = e.element.wysiwyg),
                    ((n = r.createElement("P")).innerHTML = "<br>"),
                    i.insertBefore(n, i.firstElementChild),
                    this.setRange(
                      n.firstElementChild,
                      0,
                      n.firstElementChild,
                      1
                    ),
                    (t = this._variable._range)),
                  t
                );
              },
              getSelection: function () {
                return this._shadowRoot && this._shadowRoot.getSelection
                  ? this._shadowRoot.getSelection()
                  : this._ww.getSelection();
              },
              getSelectionNode: function () {
                if (
                  (r.isWysiwygDiv(this._variable._selectionNode) &&
                    this._editorRange(),
                  !this._variable._selectionNode)
                ) {
                  var t = r.getChildElement(
                    e.element.wysiwyg.firstChild,
                    function (e) {
                      return 0 === e.childNodes.length || 3 === e.nodeType;
                    },
                    !1
                  );
                  if (t) return (this._variable._selectionNode = t);
                  this._editorRange();
                }
                return this._variable._selectionNode;
              },
              _editorRange: function () {
                var e = this.getSelection();
                if (!e) return null;
                var t =
                    0 < e.rangeCount
                      ? e.getRangeAt(0)
                      : this._createDefaultRange(),
                  i = (this._variable._range = t).collapsed
                    ? t.commonAncestorContainer
                    : e.extentNode || e.anchorNode;
                this._variable._selectionNode = i;
              },
              _createDefaultRange: function () {
                var t = e.element.wysiwyg;
                t.focus();
                var i = this._wd.createRange(),
                  n = t.firstElementChild;
                return (
                  n ||
                    (((n = r.createElement("P")).innerHTML = "<br>"),
                    t.appendChild(n)),
                  i.setStart(n, 0),
                  i.setEnd(n, 0),
                  i
                );
              },
              _selectionVoid: function (e) {
                var t = e.commonAncestorContainer;
                return (
                  (r.isWysiwygDiv(e.startContainer) &&
                    r.isWysiwygDiv(e.endContainer)) ||
                  /FIGURE/i.test(t.nodeName) ||
                  this._fileManager.regExp.test(t.nodeName) ||
                  r.isMediaComponent(t)
                );
              },
              _resetRangeToTextNode: function () {
                var t = this.getRange();
                if (this._selectionVoid(t)) return !1;
                var i,
                  n,
                  l,
                  o = t.startContainer,
                  s = t.startOffset,
                  a = t.endContainer,
                  c = t.endOffset;
                if (
                  (r.isFormatElement(o) &&
                    (s = (o = o.childNodes[s] || o.lastChild).textContent
                      .length),
                  r.isFormatElement(a) &&
                    (c = (a = a.childNodes[c] || a.lastChild).textContent
                      .length),
                  (i = r.isWysiwygDiv(o) ? e.element.wysiwyg.firstChild : o),
                  (n = s),
                  r.isBreak(i) || (1 === i.nodeType && 0 < i.childNodes.length))
                ) {
                  var d,
                    u = r.isBreak(i);
                  if (!u) {
                    for (; i && !r.isBreak(i) && 1 === i.nodeType; )
                      (i =
                        i.childNodes[n] ||
                        i.nextElementSibling ||
                        i.nextSibling),
                        (n = 0);
                    var h = r.getFormatElement(i, null);
                    h === r.getRangeFormatElement(h, null) &&
                      ((h = r.createElement(
                        r.getParentElement(i, r.isCell) ? "DIV" : "P"
                      )),
                      i.parentNode.insertBefore(h, i),
                      h.appendChild(i));
                  }
                  r.isBreak(i) &&
                    ((d = r.createTextNode(r.zeroWidthSpace)),
                    i.parentNode.insertBefore(d, i),
                    (i = d),
                    u && o === a && ((a = i), (c = 1)));
                }
                if (
                  ((o = i),
                  (s = n),
                  (i = r.isWysiwygDiv(a) ? e.element.wysiwyg.lastChild : a),
                  (n = c),
                  r.isBreak(i) || (1 === i.nodeType && 0 < i.childNodes.length))
                ) {
                  var g,
                    p = r.isBreak(i);
                  if (!p) {
                    for (
                      ;
                      i &&
                      !r.isBreak(i) &&
                      1 === i.nodeType &&
                      0 !== (l = i.childNodes).length;

                    )
                      (i =
                        l[0 < n ? n - 1 : n] || !/FIGURE/i.test(l[0].nodeName)
                          ? l[0]
                          : i.previousElementSibling || i.previousSibling || o),
                        (n = 0 < n ? i.textContent.length : n);
                    var m = r.getFormatElement(i, null);
                    m === r.getRangeFormatElement(m, null) &&
                      ((m = r.createElement(r.isCell(m) ? "DIV" : "P")),
                      i.parentNode.insertBefore(m, i),
                      m.appendChild(i));
                  }
                  r.isBreak(i) &&
                    ((g = r.createTextNode(r.zeroWidthSpace)),
                    i.parentNode.insertBefore(g, i),
                    (i = g),
                    (n = 1),
                    p && !i.previousSibling && r.removeItem(a));
                }
                return (a = i), (c = n), this.setRange(o, s, a, c), !0;
              },
              getSelectedElements: function (t) {
                if (!this._resetRangeToTextNode()) return [];
                var i = this.getRange();
                if (r.isWysiwygDiv(i.startContainer)) {
                  var n = e.element.wysiwyg.children;
                  if (0 === n.length) return [];
                  this.setRange(
                    n[0],
                    0,
                    n[n.length - 1],
                    n[n.length - 1].textContent.trim().length
                  ),
                    (i = this.getRange());
                }
                var l = i.startContainer,
                  o = i.endContainer,
                  s = i.commonAncestorContainer,
                  a = r.getListChildren(s, function (e) {
                    return t ? t(e) : r.isFormatElement(e);
                  });
                if (
                  (r.isWysiwygDiv(s) ||
                    r.isRangeFormatElement(s) ||
                    a.unshift(r.getFormatElement(s, null)),
                  l === o || 1 === a.length)
                )
                  return a;
                function c(e) {
                  return !r.isTable(e) || /^TABLE$/i.test(e.nodeName);
                }
                var d = r.getFormatElement(l, null),
                  u = r.getFormatElement(o, null),
                  h = null,
                  g = null,
                  p = r.getRangeFormatElement(d, c),
                  m = r.getRangeFormatElement(u, c);
                r.isTable(p) &&
                  r.isListCell(p.parentNode) &&
                  (p = p.parentNode),
                  r.isTable(m) &&
                    r.isListCell(m.parentNode) &&
                    (m = m.parentNode);
                for (var f, v = p === m, _ = 0, b = a.length; _ < b; _++)
                  if (d === (f = a[_]) || (!v && f === p)) h = _;
                  else if (u === f || (!v && f === m)) {
                    g = _;
                    break;
                  }
                return (
                  null === h && (h = 0),
                  null === g && (g = a.length - 1),
                  a.slice(h, g + 1)
                );
              },
              getSelectedElementsAndComponents: function (e) {
                var t = this.getRange().commonAncestorContainer,
                  i = r.getParentElement(t, r.isComponent),
                  n = r.isTable(t)
                    ? this.getSelectedElements(null)
                    : this.getSelectedElements(
                        function (e) {
                          var t = this.getParentElement(e, this.isComponent);
                          return (
                            (this.isFormatElement(e) && (!t || t === i)) ||
                            (this.isComponent(e) && !this.getFormatElement(e))
                          );
                        }.bind(r)
                      );
                if (e)
                  for (var l = 0, o = n.length; l < o; l++)
                    for (var s = l - 1; 0 <= s; s--)
                      if (n[s].contains(n[l])) {
                        n.splice(l, 1), l--, o--;
                        break;
                      }
                return n;
              },
              isEdgePoint: function (e, t) {
                return (
                  0 === t ||
                  (!e.nodeValue && 1 === t) ||
                  t === e.nodeValue.length
                );
              },
              showLoading: function () {
                e.element.loading.style.display = "block";
              },
              closeLoading: function () {
                e.element.loading.style.display = "none";
              },
              appendFormatTag: function (e, t) {
                var i = r.getFormatElement(this.getSelectionNode(), null),
                  n = t
                    ? "string" == typeof t
                      ? t
                      : t.nodeName
                    : r.isFormatElement(i) && !r.isFreeFormatElement(i)
                    ? i.nodeName
                    : "P",
                  l = r.createElement(n);
                return (
                  (l.innerHTML = "<br>"),
                  ((t && "string" != typeof t) ||
                    (!t && r.isFormatElement(i))) &&
                    r.copyTagAttributes(l, t || i),
                  r.isCell(e)
                    ? e.insertBefore(l, e.nextElementSibling)
                    : e.parentNode.insertBefore(l, e.nextElementSibling),
                  l
                );
              },
              insertComponent: function (e, t, i, n) {
                if (i && !this.checkCharCount(e, null)) return null;
                var l = this.removeNode();
                this.getRange_addLine(this.getRange());
                var o,
                  s,
                  a = null,
                  c = this.getSelectionNode(),
                  d = r.getFormatElement(c, null);
                return (
                  r.isListCell(d)
                    ? (this.insertNode(
                        e,
                        c === d ? null : l.container.nextSibling,
                        !1
                      ),
                      e.nextSibling ||
                        e.parentNode.appendChild(r.createElement("BR")))
                    : (this.getRange().collapsed &&
                        (3 === l.container.nodeType ||
                          r.isBreak(l.container)) &&
                        ((o = r.getParentElement(
                          l.container,
                          function (e) {
                            return this.isRangeFormatElement(e);
                          }.bind(r)
                        )),
                        (a = r.splitElement(
                          l.container,
                          l.offset,
                          o ? r.getElementDepth(o) + 1 : 0
                        )) && (d = a.previousSibling)),
                      this.insertNode(e, d, !1),
                      d && r.onlyZeroWidthSpace(d) && r.removeItem(d)),
                  n ||
                    ((s = this.getFileComponent(e))
                      ? this.selectComponent(s.target, s.pluginName)
                      : a &&
                        ((a = r.getEdgeChildNodes(a, null).sc || a),
                        this.setRange(a, 0, a, 0))),
                  t || this.history.push(1),
                  a || e
                );
              },
              getFileComponent: function (e) {
                return this._fileManager.queryString && e
                  ? ((/^FIGURE$/i.test(e.nodeName) ||
                      /ke-component/.test(e.className)) &&
                      (t = e.querySelector(this._fileManager.queryString)),
                    !t &&
                      e.nodeName &&
                      this._fileManager.regExp.test(e.nodeName) &&
                      (t = e),
                    t &&
                    (i = this._fileManager.pluginMap[t.nodeName.toLowerCase()])
                      ? {
                          target: t,
                          component: r.getParentElement(t, r.isComponent),
                          pluginName: i,
                        }
                      : null)
                  : null;
                var t, i;
              },
              selectComponent: function (e, t) {
                this.hasFocus || this.focus();
                var i = this.plugins[t];
                i &&
                  a.setTimeout(
                    function () {
                      "function" == typeof i.select &&
                        this.callPlugin(t, i.select.bind(this, e), null),
                        this._setComponentLineBreaker(e);
                    }.bind(this)
                  );
              },
              _setComponentLineBreaker: function (t) {
                this._lineBreaker.style.display = "none";
                var i,
                  n,
                  l,
                  o = r.getParentElement(t, r.isComponent),
                  s = e.element.lineBreaker_t.style,
                  a = e.element.lineBreaker_b.style,
                  c =
                    "block" ===
                    this.context.resizing.resizeContainer.style.display
                      ? this.context.resizing.resizeContainer
                      : t,
                  d = r.isListCell(o.parentNode);
                (
                  d
                    ? o.previousSibling
                    : r.isFormatElement(o.previousElementSibling)
                )
                  ? (s.display = "none")
                  : ((this._variable._lineBreakComp = o),
                    (n = e.element.wysiwyg.scrollTop),
                    (i = r.getOffset(t, e.element.wysiwygFrame).top + n),
                    (l = c.offsetWidth / 2 / 2),
                    (s.top = i - n - 12 + "px"),
                    (s.left = r.getOffset(c).left + l + "px"),
                    (s.display = "block")),
                  (d ? o.nextSibling : r.isFormatElement(o.nextElementSibling))
                    ? (a.display = "none")
                    : (i ||
                        ((this._variable._lineBreakComp = o),
                        (n = e.element.wysiwyg.scrollTop),
                        (i = r.getOffset(t, e.element.wysiwygFrame).top + n),
                        (l = c.offsetWidth / 2 / 2)),
                      (a.top = i + c.offsetHeight - n - 12 + "px"),
                      (a.left =
                        r.getOffset(c).left + c.offsetWidth - l - 24 + "px"),
                      (a.display = "block"));
              },
              insertNode: function (e, t, i) {
                if (i && !this.checkCharCount(e, null)) return null;
                var n,
                  l,
                  o = r.getFreeFormatElement(this.getSelectionNode(), null),
                  s =
                    (!o &&
                      (r.isFormatElement(e) || r.isRangeFormatElement(e))) ||
                    r.isComponent(e);
                !t &&
                  s &&
                  ((3 !== (n = this.removeNode()).container.nodeType &&
                    !r.isBreak(n.container)) ||
                    ((l = r.getParentElement(
                      n.container,
                      function (e) {
                        return (
                          this.isRangeFormatElement(e) || this.isListCell(e)
                        );
                      }.bind(r)
                    )),
                    (t =
                      (t = r.splitElement(
                        n.container,
                        n.offset,
                        l ? r.getElementDepth(l) + 1 : 0
                      )) && t.previousSibling)));
                var a,
                  c,
                  d,
                  u,
                  h =
                    t || s
                      ? this.getRange()
                      : this.getRange_addLine(this.getRange()),
                  g = h.commonAncestorContainer,
                  p = h.startOffset,
                  m = h.endOffset,
                  f = h.startContainer === g && r.isFormatElement(g),
                  v = f ? g.childNodes[p] : h.startContainer,
                  _ = f ? g.childNodes[m] : h.endContainer,
                  b = null;
                if (t) (C = t.parentNode), (t = t.nextSibling), (b = !0);
                else {
                  var y,
                    w,
                    C = v;
                  if ((3 === v.nodeType && (C = v.parentNode), h.collapsed))
                    3 === g.nodeType
                      ? (t =
                          g.textContent.length > m
                            ? g.splitText(m)
                            : g.nextSibling)
                      : r.isBreak(C)
                      ? (C = (t = C).parentNode)
                      : (t = (w =
                          (y = C.childNodes[p]) &&
                          3 === y.nodeType &&
                          r.onlyZeroWidthSpace(y) &&
                          r.isBreak(y.nextSibling)
                            ? y.nextSibling
                            : y)
                          ? w.nextSibling
                            ? r.isBreak(w) && !r.isBreak(e)
                              ? w
                              : w.nextSibling
                            : (C.removeChild(w), null)
                          : null);
                  else if (v === _) {
                    t = this.isEdgePoint(_, m) ? _.nextSibling : _.splitText(m);
                    var k = v;
                    this.isEdgePoint(v, p) || (k = v.splitText(p)),
                      C.removeChild(k),
                      0 === C.childNodes.length && s && (C.innerHTML = "<br>");
                  } else {
                    var x = this.removeNode(),
                      E = x.container,
                      S = x.prevContainer;
                    if (
                      (E &&
                        0 === E.childNodes.length &&
                        s &&
                        (r.isFormatElement(E)
                          ? (E.innerHTML = "<br>")
                          : r.isRangeFormatElement(E) &&
                            (E.innerHTML = "<p><br></p>")),
                      !s && S)
                    )
                      if ((C = 3 === S.nodeType ? S.parentNode : S).contains(E))
                        for (t = E; t.parentNode === C; ) t = t.parentNode;
                      else t = null;
                    else (C = s ? g : E), (t = s ? _ : null);
                    for (; t && !r.isFormatElement(t) && t.parentNode !== g; )
                      t = t.parentNode;
                  }
                }
                try {
                  (r.isFormatElement(e) ||
                    r.isRangeFormatElement(e) ||
                    (!r.isListCell(C) && r.isComponent(e))) &&
                    ((a = C),
                    r.isList(t)
                      ? ((C = t), (t = null))
                      : r.isListCell(t)
                      ? (C = t.previousElementSibling || t)
                      : b ||
                        t ||
                        ((d =
                          3 !== (c = this.removeNode()).container.nodeType ||
                          r.isListCell(r.getFormatElement(c.container, null))
                            ? c.container
                            : r.getFormatElement(c.container, null) ||
                              c.container.parentNode),
                        (C = (u =
                          r.isWysiwygDiv(d) || r.isRangeFormatElement(d))
                          ? d
                          : d.parentNode),
                        (t = u ? null : d.nextSibling)),
                    0 === a.childNodes.length && C !== a && r.removeItem(a)),
                    !s ||
                      o ||
                      r.isRangeFormatElement(C) ||
                      r.isListCell(C) ||
                      r.isWysiwygDiv(C) ||
                      ((t = C.nextElementSibling), (C = C.parentNode)),
                    C.insertBefore(e, C === t ? C.lastChild : t);
                } catch (t) {
                  C.appendChild(e);
                } finally {
                  if (
                    (o &&
                      (r.isFormatElement(e) || r.isRangeFormatElement(e)) &&
                      (e = this._setIntoFreeFormat(e)),
                    !r.isComponent(e))
                  ) {
                    var N,
                      T = 1;
                    if (3 === e.nodeType) {
                      var L = e.previousSibling,
                        z = e.nextSibling,
                        B =
                          !L || 1 === L.nodeType || r.onlyZeroWidthSpace(L)
                            ? ""
                            : L.textContent,
                        A =
                          !z || 1 === z.nodeType || r.onlyZeroWidthSpace(z)
                            ? ""
                            : z.textContent;
                      L &&
                        0 < B.length &&
                        ((e.textContent = B + e.textContent), r.removeItem(L)),
                        z &&
                          0 < z.length &&
                          ((e.textContent += A), r.removeItem(z));
                      var M = {
                        container: e,
                        startOffset: B.length,
                        endOffset: e.textContent.length - A.length,
                      };
                      return this.setRange(e, M.startOffset, e, M.endOffset), M;
                    }
                    !r.isBreak(e) &&
                      r.isFormatElement(C) &&
                      ((N = null),
                      e.previousSibling ||
                        ((N = r.createTextNode(r.zeroWidthSpace)),
                        e.parentNode.insertBefore(N, e)),
                      e.nextSibling ||
                        ((N = r.createTextNode(r.zeroWidthSpace)),
                        e.parentNode.appendChild(N)),
                      r._isIgnoreNodeChange(e) &&
                        ((e = e.nextSibling), (T = 0))),
                      this.setRange(e, T, e, T);
                  }
                  return this.history.push(!0), e;
                }
              },
              _setIntoFreeFormat: function (e) {
                for (
                  var t, i, n = e.parentNode;
                  r.isFormatElement(e) || r.isRangeFormatElement(e);

                ) {
                  for (t = e.childNodes, i = null; t[0]; )
                    if (
                      ((i = t[0]),
                      r.isFormatElement(i) || r.isRangeFormatElement(i))
                    ) {
                      if ((this._setIntoFreeFormat(i), !e.parentNode)) break;
                      t = e.childNodes;
                    } else n.insertBefore(i, e);
                  0 === e.childNodes.length && r.removeItem(e),
                    (e = r.createElement("BR")),
                    n.insertBefore(e, i.nextSibling);
                }
                return e;
              },
              removeNode: function () {
                this._resetRangeToTextNode() ||
                  console.warn(
                    '[KothingEditor.core.removeNode.exception] An exception occurred while resetting the "Range" object.'
                  );
                var t,
                  i = this.getRange(),
                  n = 0,
                  l = i.startContainer,
                  o = i.endContainer,
                  s = i.startOffset,
                  a = i.endOffset,
                  c = i.commonAncestorContainer,
                  d = null,
                  u = null,
                  h = r.getListChildNodes(c, null),
                  g = r.getArrayIndex(h, l),
                  p = r.getArrayIndex(h, o);
                if (0 < h.length && -1 < g && -1 < p) {
                  for (var m = g + 1, f = l; 0 <= m; m--)
                    h[m] === f.parentNode &&
                      h[m].firstChild === f &&
                      0 === s &&
                      ((g = m), (f = f.parentNode));
                  for (var v = p - 1, _ = o; g < v; v--)
                    h[v] === _.parentNode &&
                      1 === h[v].nodeType &&
                      (h.splice(v, 1), (_ = _.parentNode), --p);
                } else {
                  if (0 === h.length) {
                    if (
                      r.isFormatElement(c) ||
                      r.isRangeFormatElement(c) ||
                      r.isWysiwygDiv(c) ||
                      r.isBreak(c) ||
                      r.isMedia(c)
                    )
                      return { container: c, offset: 0 };
                    h.push(c), (l = o = c);
                  } else if (
                    ((l = o = h[0]), r.isBreak(l) || r.onlyZeroWidthSpace(l))
                  )
                    return { container: l, offset: 0 };
                  g = p = 0;
                }
                function b(e) {
                  var t = r.getFormatElement(e, null);
                  if ((r.removeItem(e), r.isListCell(t))) {
                    var i = r.getArrayItem(t.children, r.isList, !1);
                    if (i) {
                      for (
                        var n = i.firstElementChild, l = n.childNodes;
                        l[0];

                      )
                        t.insertBefore(l[0], i);
                      r.removeItemAllParents(n, null, null);
                    }
                  }
                }
                for (var y, w = g; w <= p; w++) {
                  var C = h[w];
                  if (0 === C.length || (3 === C.nodeType && void 0 === C.data))
                    b(C);
                  else if (C !== l)
                    C !== o
                      ? b(C)
                      : 0 <
                        (u =
                          1 === o.nodeType
                            ? r.createTextNode(o.textContent)
                            : r.createTextNode(
                                o.substringData(a, o.length - a)
                              )).length
                      ? (o.data = u.data)
                      : b(o);
                  else if (
                    (1 === l.nodeType
                      ? (d = r.createTextNode(l.textContent))
                      : C === o
                      ? ((d = r.createTextNode(
                          l.substringData(0, s) +
                            o.substringData(a, o.length - a)
                        )),
                        (n = s))
                      : (d = r.createTextNode(l.substringData(0, s))),
                    0 < d.length ? (l.data = d.data) : b(l),
                    C === o)
                  )
                    break;
                }
                return (
                  (t =
                    o && o.parentNode
                      ? o
                      : l && l.parentNode
                      ? l
                      : i.endContainer || i.startContainer),
                  r.isWysiwygDiv(t) ||
                    ((y = r.removeItemAllParents(
                      t,
                      function (e) {
                        if (this.isComponent(e)) return !1;
                        var t = e.textContent;
                        return 0 === t.length || /^(\n|\u200B)+$/.test(t);
                      }.bind(r),
                      null
                    )) &&
                      (t = y.sc || y.ec || e.element.wysiwyg)),
                  this.setRange(t, n, t, n),
                  this.history.push(!0),
                  {
                    container: t,
                    offset: n,
                    prevContainer: l && l.parentNode ? l : null,
                  }
                );
              },
              applyRangeFormatElement: function (e) {
                this.getRange_addLine(this.getRange());
                var t = this.getSelectedElementsAndComponents(!1);
                if (t && 0 !== t.length) {
                  e: for (var i, n, l, o, s, a, c = 0, d = t.length; c < d; c++)
                    if (
                      ((i = t[c]),
                      r.isListCell(i) &&
                        (n = i.lastElementChild) &&
                        r.isListCell(i.nextElementSibling) &&
                        -1 < t.indexOf(i.nextElementSibling) &&
                        ((o = n.lastElementChild), -1 < t.indexOf(o)))
                    ) {
                      for (var u; (u = o.lastElementChild); )
                        if (r.isList(u)) {
                          if (!(-1 < t.indexOf(u.lastElementChild))) continue e;
                          o = u.lastElementChild;
                        }
                      (l = n.firstElementChild),
                        (s = t.indexOf(l)),
                        (a = t.indexOf(o)),
                        t.splice(s, a - s + 1),
                        (d = t.length);
                    }
                  for (
                    var h,
                      g,
                      p,
                      m,
                      f,
                      v,
                      _,
                      b,
                      y,
                      w,
                      C = t[t.length - 1],
                      k =
                        r.isRangeFormatElement(C) || r.isFormatElement(C)
                          ? C
                          : r.getRangeFormatElement(C, null) ||
                            r.getFormatElement(C, null),
                      x = r.isCell(k)
                        ? ((h = null), k)
                        : ((h = k.nextSibling), k.parentNode),
                      E = r.getElementDepth(k),
                      S = null,
                      N = [],
                      T = function (e, t, i) {
                        var n = null;
                        if (e !== t && !r.isTable(t)) {
                          if (
                            t &&
                            r.getElementDepth(e) === r.getElementDepth(t)
                          )
                            return i;
                          n = r.removeItemAllParents(t, null, e);
                        }
                        return n ? n.ec : i;
                      },
                      L = 0,
                      z = t.length;
                    L < z;
                    L++
                  )
                    if ((p = (g = t[L]).parentNode) && !e.contains(p))
                      if (((m = r.getElementDepth(g)), r.isList(p))) {
                        if (
                          (null === S &&
                            (_
                              ? ((S = _), (b = !0), (_ = null))
                              : (S = p.cloneNode(!1))),
                          N.push(g),
                          (v = t[L + 1]),
                          L === z - 1 || (v && v.parentNode !== p))
                        ) {
                          v &&
                            g.contains(v.parentNode) &&
                            (_ = v.parentNode.cloneNode(!1));
                          for (var B = p.parentNode, A = void 0; r.isList(B); )
                            (A = r.createElement(B.nodeName)).appendChild(S),
                              (S = A),
                              (B = B.parentNode);
                          var M = this.detachRangeFormatElement(
                            p,
                            N,
                            null,
                            !0,
                            !0
                          );
                          m <= E
                            ? ((E = m),
                              (h = T((x = M.cc), p, M.ec)) &&
                                (x = h.parentNode))
                            : x === M.cc && (h = M.ec),
                            x !== M.cc &&
                              (h = void 0 !== (f = T(x, M.cc, f)) ? f : M.cc);
                          for (var H = 0, I = M.removeArray.length; H < I; H++)
                            S.appendChild(M.removeArray[H]);
                          b || e.appendChild(S),
                            _ &&
                              M.removeArray[
                                M.removeArray.length - 1
                              ].appendChild(_),
                            (S = null),
                            (b = !1);
                        }
                      } else
                        m <= E && ((E = m), (x = p), (h = g.nextSibling)),
                          e.appendChild(g),
                          x !== p && void 0 !== (f = T(x, p)) && (h = f);
                  (this.effectNode = null),
                    r.mergeSameTags(e, null, !1),
                    r.mergeNestedTags(
                      e,
                      function (e) {
                        return this.isList(e);
                      }.bind(r)
                    ),
                    h &&
                    0 < r.getElementDepth(h) &&
                    (r.isList(h.parentNode) ||
                      r.isList(h.parentNode.parentNode))
                      ? ((y = r.getParentElement(
                          h,
                          function (e) {
                            return (
                              this.isRangeFormatElement(e) && !this.isList(e)
                            );
                          }.bind(r)
                        )),
                        (w = r.splitElement(
                          h,
                          null,
                          y ? r.getElementDepth(y) + 1 : 0
                        )).parentNode.insertBefore(e, w))
                      : (x.insertBefore(e, h), T(e, h));
                  var F = r.getEdgeChildNodes(
                    e.firstElementChild,
                    e.lastElementChild
                  );
                  1 < t.length
                    ? this.setRange(F.sc, 0, F.ec, F.ec.textContent.length)
                    : this.setRange(
                        F.ec,
                        F.ec.textContent.length,
                        F.ec,
                        F.ec.textContent.length
                      ),
                    this.history.push(!1);
                }
              },
              detachRangeFormatElement: function (e, t, i, n, l) {
                var o = this.getRange(),
                  s = o.startOffset,
                  a = o.endOffset,
                  c = r.getListChildNodes(e, function (t) {
                    return t.parentNode === e;
                  }),
                  d = e.parentNode,
                  u = null,
                  h = null,
                  g = e.cloneNode(!1),
                  p = [],
                  m = r.isList(i),
                  f = !1,
                  v = !1,
                  _ = !1;
                function b(t, i, n, l) {
                  if (
                    (r.onlyZeroWidthSpace(i) &&
                      (i.innerHTML = r.zeroWidthSpace),
                    3 === i.nodeType)
                  )
                    return t.insertBefore(i, n), i;
                  for (
                    var o,
                      s = (_ ? i : l).childNodes,
                      a = i.cloneNode(!1),
                      c = null;
                    s[0];

                  )
                    (o = s[0]),
                      !r._notTextNode(o) || r.isBreak(o) || r.isListCell(a)
                        ? a.appendChild(o)
                        : (0 < a.childNodes.length &&
                            ((c = c || a),
                            t.insertBefore(a, n),
                            (a = i.cloneNode(!1))),
                          t.insertBefore(o, n),
                          (c = c || o));
                  if (0 < a.childNodes.length) {
                    if (r.isListCell(t) && r.isListCell(a) && r.isList(n))
                      if (m) {
                        for (c = n; n; ) a.appendChild(n), (n = n.nextSibling);
                        t.parentNode.insertBefore(a, t.nextElementSibling);
                      } else {
                        var d = l.nextElementSibling,
                          u = r.detachNestedList(l, !1);
                        if (e !== u || d !== l.nextElementSibling) {
                          for (var h = a.childNodes; h[0]; )
                            l.appendChild(h[0]);
                          (e = u), (v = !0);
                        }
                      }
                    else t.insertBefore(a, n);
                    c = c || a;
                  }
                  return c;
                }
                for (var y, w, C = 0, k = c.length; C < k; C++)
                  if (3 !== (N = c[C]).nodeType || !r.isList(g))
                    if (
                      ((_ = !1),
                      n &&
                        0 === C &&
                        (u =
                          t && t.length !== k && t[0] !== N
                            ? g
                            : e.previousSibling),
                      t && (y = t.indexOf(N)),
                      t && -1 === y)
                    )
                      (g = g || e.cloneNode(!1)).appendChild(N);
                    else {
                      if (
                        (t && (w = t[y + 1]),
                        g &&
                          0 < g.children.length &&
                          (d.insertBefore(g, e), (g = null)),
                        !m && r.isListCell(N))
                      )
                        if (
                          w &&
                          r.getElementDepth(N) !== r.getElementDepth(w) &&
                          (r.isListCell(d) ||
                            r.getArrayItem(N.children, r.isList, !1))
                        ) {
                          var x = N.nextElementSibling,
                            E = r.detachNestedList(N, !1);
                          (e === E && x === N.nextElementSibling) ||
                            ((e = E), (v = !0));
                        } else {
                          for (
                            var S = N,
                              N = r.createElement(
                                n
                                  ? S.nodeName
                                  : r.isList(e.parentNode) ||
                                    r.isListCell(e.parentNode)
                                  ? "LI"
                                  : r.isCell(e.parentNode)
                                  ? "DIV"
                                  : "P"
                              ),
                              T = r.isListCell(N),
                              L = S.childNodes;
                            L[0] && (!r.isList(L[0]) || T);

                          )
                            N.appendChild(L[0]);
                          r.copyFormatAttributes(N, S), (_ = !0);
                        }
                      else N = N.cloneNode(!1);
                      if (
                        !v &&
                        (n
                          ? (p.push(N), r.removeItem(c[C]))
                          : ((N = i
                              ? (f || (d.insertBefore(i, e), (f = !0)),
                                b(i, N, null, c[C]))
                              : b(d, N, e, c[C])),
                            v || (u = t ? ((h = N), u || N) : u || (h = N))),
                        v)
                      ) {
                        (v = _ = !1),
                          (c = r.getListChildNodes(e, function (t) {
                            return t.parentNode === e;
                          })),
                          (g = e.cloneNode(!1)),
                          (d = e.parentNode),
                          (C = -1),
                          (k = c.length);
                        continue;
                      }
                    }
                var z,
                  B,
                  A = e.parentNode,
                  M = e.nextSibling;
                if (
                  (g && 0 < g.children.length && A.insertBefore(g, M),
                  (u = i ? i.previousSibling : u || e.previousSibling),
                  (M = e.nextSibling),
                  0 === e.children.length || 0 === e.textContent.length
                    ? r.removeItem(e)
                    : r.removeEmptyNode(e, null),
                  (B = n
                    ? { cc: A, sc: u, ec: M, removeArray: p }
                    : ((u = u || h),
                      (h = h || u),
                      {
                        cc: (
                          (z = r.getEdgeChildNodes(u, h.parentNode ? u : h))
                            .sc || z.ec
                        ).parentNode,
                        sc: z.sc,
                        ec: z.ec,
                      })),
                  (this.effectNode = null),
                  l)
                )
                  return B;
                !n &&
                  B &&
                  (t
                    ? this.setRange(B.sc, s, B.ec, a)
                    : this.setRange(B.sc, 0, B.sc, 0)),
                  this.history.push(!1);
              },
              detachList: function (e, t) {
                for (
                  var i,
                    n,
                    l = {},
                    o = !1,
                    s = !1,
                    a = null,
                    c = null,
                    d = function (e) {
                      return !this.isComponent(e);
                    }.bind(r),
                    u = 0,
                    h = e.length;
                  u < h;
                  u++
                ) {
                  var g,
                    p,
                    m,
                    f = u === h - 1;
                  (p = r.getRangeFormatElement(e[u], d)),
                    (n = r.isList(p)),
                    !i && n
                      ? ((l = {
                          r: (i = p),
                          f: [r.getParentElement(e[u], "LI")],
                        }),
                        0 === u && (o = !0))
                      : i &&
                        n &&
                        (i !== p
                          ? ((g = this.detachRangeFormatElement(
                              l.f[0].parentNode,
                              l.f,
                              null,
                              t,
                              !0
                            )),
                            (p = e[u].parentNode),
                            o && ((a = g.sc), (o = !1)),
                            f && (c = g.ec),
                            n
                              ? ((l = {
                                  r: (i = p),
                                  f: [r.getParentElement(e[u], "LI")],
                                }),
                                f && (s = !0))
                              : (i = null))
                          : (l.f.push(r.getParentElement(e[u], "LI")),
                            f && (s = !0))),
                    f &&
                      r.isList(i) &&
                      ((m = this.detachRangeFormatElement(
                        l.f[0].parentNode,
                        l.f,
                        null,
                        t,
                        !0
                      )),
                      (!s && 1 !== h) || (c = m.ec),
                      o && (a = m.sc || c));
                }
                return { sc: a, ec: c };
              },
              nodeChange: function (e, t, i, n) {
                this._resetRangeToTextNode();
                var l = this.getRange_addLine(this.getRange());
                (t = !!(t && 0 < t.length) && t),
                  (i = !!(i && 0 < i.length) && i);
                var o,
                  s,
                  c,
                  d = !e,
                  u = d && !i && !t,
                  h = l.startContainer,
                  g = l.startOffset,
                  p = l.endContainer,
                  m = l.endOffset;
                if (
                  !(
                    (u &&
                      l.collapsed &&
                      r.isFormatElement(h.parentNode) &&
                      r.isFormatElement(p.parentNode)) ||
                    (h === p && 1 === h.nodeType && r.isNonEditable(h))
                  )
                ) {
                  l.collapsed &&
                    !u &&
                    (1 !== h.nodeType ||
                      r.isBreak(h) ||
                      r.isComponent(h) ||
                      ((o = null),
                      (s = h.childNodes[g]) &&
                        (o = s.nextSibling
                          ? r.isBreak(s)
                            ? s
                            : s.nextSibling
                          : null),
                      (c = r.createTextNode(r.zeroWidthSpace)),
                      h.insertBefore(c, o),
                      this.setRange(c, 1, c, 1),
                      (h = (l = this.getRange()).startContainer),
                      (g = l.startOffset),
                      (p = l.endContainer),
                      (m = l.endOffset))),
                    r.isFormatElement(h) &&
                      ((h = h.childNodes[g] || h.firstChild), (g = 0)),
                    r.isFormatElement(p) &&
                      (m = (p = p.childNodes[m] || p.lastChild).textContent
                        .length),
                    d && (e = r.createElement("DIV"));
                  var f = a.RegExp,
                    v = e.nodeName;
                  if (!u && h === p && !i && e) {
                    for (
                      var _ = h,
                        b = 0,
                        y = [],
                        w = e.style,
                        C = 0,
                        k = w.length;
                      C < k;
                      C++
                    )
                      y.push(w[C]);
                    for (var x = e.classList, E = 0, S = x.length; E < S; E++)
                      y.push("." + x[E]);
                    if (0 < y.length) {
                      for (; !r.isFormatElement(_) && !r.isWysiwygDiv(_); ) {
                        for (var N, T, L, z, B = 0; B < y.length; B++)
                          1 === _.nodeType &&
                            ((N = y[B]),
                            (T =
                              !!/^\./.test(N) &&
                              new f(
                                "\\s*" + N.replace(/^\./, "") + "(\\s+|$)",
                                "ig"
                              )),
                            (L = d
                              ? !!_.style[N]
                              : !!_.style[N] &&
                                !!e.style[N] &&
                                _.style[N] === e.style[N]),
                            (z =
                              !1 !== T &&
                              (d
                                ? !!_.className.match(T)
                                : !!_.className.match(T) &&
                                  !!e.className.match(T))),
                            (L || z) && b++);
                        _ = _.parentNode;
                      }
                      if (b >= y.length) return;
                    }
                  }
                  var A = {},
                    M = {},
                    H = "",
                    I = "",
                    F = "";
                  if (t) {
                    for (var D, R = 0, O = t.length; R < O; R++)
                      (D = t[R]),
                        /^\./.test(D)
                          ? (I += (I ? "|" : "\\s*(?:") + D.replace(/^\./, ""))
                          : (H += (H ? "|" : "(?:;|^|\\s)(?:") + D);
                    (H = H && new f((H += ")\\s*:[^;]*\\s*(?:;|$)"), "ig")),
                      (I = I && new f((I += ")(?=\\s+|$)"), "ig"));
                  }
                  if (i) {
                    F = "^(?:" + i[0];
                    for (var P = 1; P < i.length; P++) F += "|" + i[P];
                    F = new f((F += ")$"), "i");
                  }
                  var V = a.Boolean,
                    W = { v: !1 },
                    U = function (e) {
                      var t = e.cloneNode(!1);
                      if (3 === t.nodeType || r.isBreak(t)) return t;
                      if (u) return null;
                      var i = (!F && d) || (F && F.test(t.nodeName));
                      if (i && !n) return (W.v = !0), null;
                      var l = t.style.cssText,
                        o = "";
                      H &&
                        0 < l.length &&
                        (o = l.replace(H, "").trim()) !== l &&
                        (W.v = !0);
                      var s = t.className,
                        a = "";
                      return (
                        I &&
                          0 < s.length &&
                          (a = s.replace(I, "").trim()) !== s &&
                          (W.v = !0),
                        (!d || (!I && s) || (!H && l) || o || a || !i) &&
                        (o ||
                          a ||
                          t.nodeName !== v ||
                          V(H) !== V(l) ||
                          V(I) !== V(s))
                          ? (H && 0 < l.length && (t.style.cssText = o),
                            t.style.cssText || t.removeAttribute("style"),
                            I && 0 < s.length && (t.className = a.trim()),
                            t.className.trim() || t.removeAttribute("class"),
                            t.style.cssText ||
                            t.className ||
                            (t.nodeName !== v && !i)
                              ? t
                              : ((W.v = !0), null))
                          : ((W.v = !0), null)
                      );
                    },
                    q = this.getSelectedElements(null);
                  (h = (l = this.getRange()).startContainer),
                    (g = l.startOffset),
                    (p = l.endContainer),
                    (m = l.endOffset),
                    r.getFormatElement(h, null) ||
                      ((h = r.getChildElement(
                        q[0],
                        function (e) {
                          return 3 === e.nodeType;
                        },
                        !1
                      )),
                      (g = 0)),
                    r.getFormatElement(p, null) ||
                      (m = (p = r.getChildElement(
                        q[q.length - 1],
                        function (e) {
                          return 3 === e.nodeType;
                        },
                        !1
                      )).textContent.length);
                  var Z =
                      r.getFormatElement(h, null) ===
                      r.getFormatElement(p, null),
                    $ = q.length - (Z ? 0 : 1),
                    Y = e.cloneNode(!1),
                    K =
                      u ||
                      (d &&
                        (function (e) {
                          for (var t = 0, i = e.length; t < i; t++)
                            if (
                              r._isMaintainedNode(e[t]) ||
                              r._isSizeNode(e[t])
                            )
                              return !0;
                          return !1;
                        })(i)),
                    X = r._isSizeNode(Y),
                    j = this._util_getMaintainedNode.bind(r, K, X),
                    G = this._util_isMaintainedNode.bind(r, K, X);
                  if (Z) {
                    var J = this._nodeChange_oneLine(
                      q[0],
                      Y,
                      U,
                      h,
                      g,
                      p,
                      m,
                      u,
                      d,
                      l.collapsed,
                      W,
                      j,
                      G
                    );
                    (A.container = J.startContainer),
                      (A.offset = J.startOffset),
                      (M.container = J.endContainer),
                      (M.offset = J.endOffset),
                      A.container === M.container &&
                        r.onlyZeroWidthSpace(A.container) &&
                        (A.offset = M.offset = 1),
                      this._setCommonListStyle(J.ancestor, null);
                  } else {
                    0 < $ &&
                      ((Y = e.cloneNode(!1)),
                      (M = this._nodeChange_endLine(
                        q[$],
                        Y,
                        U,
                        p,
                        m,
                        u,
                        d,
                        W,
                        j,
                        G
                      )));
                    for (var Q, ee = $ - 1; 0 < ee; ee--)
                      (Y = e.cloneNode(!1)),
                        (Q = this._nodeChange_middleLine(
                          q[ee],
                          Y,
                          U,
                          u,
                          d,
                          W,
                          M.container
                        )).endContainer &&
                          ((M.ancestor = null), (M.container = Q.endContainer)),
                        this._setCommonListStyle(Q.ancestor, null);
                    (Y = e.cloneNode(!1)),
                      (A = this._nodeChange_startLine(
                        q[0],
                        Y,
                        U,
                        h,
                        g,
                        u,
                        d,
                        W,
                        j,
                        G,
                        M.container
                      )).endContainer &&
                        ((M.ancestor = null), (M.container = A.endContainer)),
                      $ <= 0
                        ? (M = A)
                        : M.container ||
                          ((M.ancestor = null),
                          (M.container = A.container),
                          (M.offset = A.container.textContent.length)),
                      this._setCommonListStyle(A.ancestor, null),
                      this._setCommonListStyle(
                        M.ancestor || r.getFormatElement(M.container),
                        null
                      );
                  }
                  this.controllersOff(),
                    this.setRange(A.container, A.offset, M.container, M.offset),
                    this.history.push(!1);
                }
              },
              _setCommonListStyle: function (e, t) {
                if (r.isListCell(e)) {
                  t || e.removeAttribute("style");
                  var i = r.getArrayItem(
                    (t || e).childNodes,
                    function (e) {
                      return (
                        !r.isBreak(e) &&
                        !r.onlyZeroWidthSpace(e.textContent.trim())
                      );
                    },
                    !0
                  );
                  if (i[0] && 1 === i.length) {
                    if (!(t = i[0]) || 1 !== t.nodeType) return;
                    var n = t.style,
                      l = e.style;
                    /STRONG/i.test(t.nodeName)
                      ? (l.fontWeight = "bold")
                      : n.fontWeight && (l.fontWeight = n.fontWeight),
                      n.color && (l.color = n.color),
                      n.fontSize && (l.fontSize = n.fontSize),
                      this._setCommonListStyle(e, t);
                  }
                }
              },
              _stripRemoveNode: function (e) {
                var t = e.parentNode;
                if (e && 3 !== e.nodeType && t) {
                  for (var i = e.childNodes; i[0]; ) t.insertBefore(i[0], e);
                  t.removeChild(e);
                }
              },
              _util_getMaintainedNode: function (e, t, i) {
                return !i || e
                  ? null
                  : this.getParentElement(
                      i,
                      this._isMaintainedNode.bind(this)
                    ) ||
                      (t
                        ? null
                        : this.getParentElement(
                            i,
                            this._isSizeNode.bind(this)
                          ));
              },
              _util_isMaintainedNode: function (e, t, i) {
                if (!i || e || 1 !== i.nodeType) return !1;
                var n = this._isMaintainedNode(i);
                return this.getParentElement(
                  i,
                  this._isMaintainedNode.bind(this)
                )
                  ? n
                  : n || (!t && this._isSizeNode(i));
              },
              _nodeChange_oneLine: function (
                e,
                t,
                i,
                n,
                l,
                o,
                s,
                c,
                d,
                u,
                h,
                g,
                p
              ) {
                for (
                  var m = n.parentNode;
                  !(
                    m.nextSibling ||
                    m.previousSibling ||
                    r.isFormatElement(m.parentNode) ||
                    r.isWysiwygDiv(m.parentNode)
                  ) && m.nodeName !== t.nodeName;

                )
                  m = m.parentNode;
                if (
                  !d &&
                  m === o.parentNode &&
                  m.nodeName === t.nodeName &&
                  r.onlyZeroWidthSpace(n.textContent.slice(0, l)) &&
                  r.onlyZeroWidthSpace(o.textContent.slice(s))
                ) {
                  for (
                    var f,
                      v,
                      _,
                      b,
                      y = m.childNodes,
                      w = !0,
                      C = 0,
                      k = y.length;
                    C < k;
                    C++
                  )
                    if (((f = y[C]), (b = !r.onlyZeroWidthSpace(f)), f !== n))
                      if (f !== o) {
                        if ((!v && b) || (v && _ && b)) {
                          w = !1;
                          break;
                        }
                      } else _ = !0;
                    else v = !0;
                  if (w)
                    return (
                      r.copyTagAttributes(m, t),
                      {
                        startContainer: n,
                        startOffset: l,
                        endContainer: o,
                        endOffset: s,
                      }
                    );
                }
                h.v = !1;
                var x,
                  E,
                  S,
                  N,
                  T,
                  L = e,
                  z = [t],
                  B = e.cloneNode(!1),
                  A = n === o,
                  M = n,
                  H = l,
                  I = o,
                  F = s,
                  D = !1,
                  R = !1,
                  O = a.RegExp;
                function P(e) {
                  var t = new O(
                      "(?:;|^|\\s)(?:" + N + "null)\\s*:[^;]*\\s*(?:;|$)",
                      "ig"
                    ),
                    i = "";
                  return (
                    t &&
                      0 < e.style.cssText.length &&
                      (i = t.test(e.style.cssText)),
                    !i
                  );
                }
                if (
                  ((function e(n, l) {
                    for (
                      var o, s = n.childNodes, a = 0, d = s.length;
                      a < d;
                      a++
                    ) {
                      var h = s[a];
                      if (h) {
                        var m = l,
                          f = void 0;
                        if (!D && h === M) {
                          var v = B;
                          T = g(h);
                          var _ = r.createTextNode(
                              1 === M.nodeType ? "" : M.substringData(0, H)
                            ),
                            b = r.createTextNode(
                              1 === M.nodeType
                                ? ""
                                : M.substringData(
                                    H,
                                    A && H <= F ? F - H : M.data.length - H
                                  )
                            );
                          if (T) {
                            var y = g(l);
                            if (y && y.parentNode !== v) {
                              for (var w = y, C = null; w.parentNode !== v; ) {
                                for (
                                  l = C = w.parentNode.cloneNode(!1);
                                  w.childNodes[0];

                                )
                                  C.appendChild(w.childNodes[0]);
                                w.appendChild(C), (w = w.parentNode);
                              }
                              w.parentNode.appendChild(y);
                            }
                            T = T.cloneNode(!1);
                          }
                          r.onlyZeroWidthSpace(_) || l.appendChild(_);
                          var k = g(l);
                          for (
                            k && (T = k), T && (v = T), E = h, x = [], N = "";
                            E !== v && E !== L && null !== E;

                          )
                            (o = p(E) ? null : i(E)) &&
                              1 === E.nodeType &&
                              P(E) &&
                              (x.push(o),
                              (N +=
                                E.style.cssText.substr(
                                  0,
                                  E.style.cssText.indexOf(":")
                                ) + "|")),
                              (E = E.parentNode);
                          var O = x.pop() || b;
                          for (S = E = O; 0 < x.length; )
                            (E = x.pop()), S.appendChild(E), (S = E);
                          if (
                            (t.appendChild(O),
                            v.appendChild(t),
                            T &&
                              !g(I) &&
                              ((t = t.cloneNode(!1)),
                              B.appendChild(t),
                              z.push(t)),
                            (D = !(H = 0)),
                            E !== (M = b) && E.appendChild(M),
                            !A)
                          )
                            continue;
                        }
                        if (R || h !== I) {
                          if (D) {
                            if (1 === h.nodeType && !r.isBreak(h)) {
                              r._isIgnoreNodeChange(h)
                                ? (B.appendChild(h.cloneNode(!0)),
                                  u ||
                                    ((t = t.cloneNode(!1)),
                                    B.appendChild(t),
                                    z.push(t)))
                                : e(h, h);
                              continue;
                            }
                            (E = h), (x = []), (N = "");
                            for (
                              var V = [];
                              null !== E.parentNode && E !== L && E !== t;

                            )
                              (o = R ? E.cloneNode(!1) : i(E)),
                                1 === E.nodeType &&
                                  !r.isBreak(h) &&
                                  o &&
                                  P(E) &&
                                  (p(E) ? T || V.push(o) : x.push(o),
                                  (N +=
                                    E.style.cssText.substr(
                                      0,
                                      E.style.cssText.indexOf(":")
                                    ) + "|")),
                                (E = E.parentNode);
                            var W,
                              U = (x = x.concat(V)).pop() || h;
                            for (S = E = U; 0 < x.length; )
                              (E = x.pop()), S.appendChild(E), (S = E);
                            if (
                              (p(t.parentNode) &&
                                !p(U) &&
                                ((t = t.cloneNode(!1)),
                                B.appendChild(t),
                                z.push(t)),
                              R || T || !p(U))
                            )
                              l =
                                U === h
                                  ? R
                                    ? B
                                    : t
                                  : (R ? B.appendChild(U) : t.appendChild(U),
                                    E);
                            else {
                              t = t.cloneNode(!1);
                              for (
                                var q = U.childNodes, Z = 0, $ = q.length;
                                Z < $;
                                Z++
                              )
                                t.appendChild(q[Z]);
                              U.appendChild(t),
                                B.appendChild(U),
                                z.push(t),
                                (l = 0 < t.children.length ? E : t);
                            }
                            T &&
                              3 === h.nodeType &&
                              (g(h)
                                ? ((W = r.getParentElement(
                                    l,
                                    function (e) {
                                      return (
                                        this._isMaintainedNode(e.parentNode) ||
                                        e.parentNode === B
                                      );
                                    }.bind(r)
                                  )),
                                  T.appendChild(W),
                                  (t = W.cloneNode(!1)),
                                  z.push(t),
                                  B.appendChild(t))
                                : (T = null));
                          }
                          (f = h.cloneNode(!1)),
                            l.appendChild(f),
                            1 !== h.nodeType || r.isBreak(h) || (m = f),
                            e(h, m);
                        } else {
                          T = g(h);
                          var Y,
                            K = r.createTextNode(
                              1 === I.nodeType
                                ? ""
                                : I.substringData(F, I.length - F)
                            ),
                            X = r.createTextNode(
                              A || 1 === I.nodeType ? "" : I.substringData(0, F)
                            );
                          if (
                            (T
                              ? (T = T.cloneNode(!1))
                              : p(t.parentNode) &&
                                !T &&
                                ((t = t.cloneNode(!1)),
                                B.appendChild(t),
                                z.push(t)),
                            !r.onlyZeroWidthSpace(K))
                          ) {
                            (E = h), (N = ""), (x = []);
                            for (var j = []; E !== B && E !== L && null !== E; )
                              1 === E.nodeType &&
                                P(E) &&
                                (p(E)
                                  ? j.push(E.cloneNode(!1))
                                  : x.push(E.cloneNode(!1)),
                                (N +=
                                  E.style.cssText.substr(
                                    0,
                                    E.style.cssText.indexOf(":")
                                  ) + "|")),
                                (E = E.parentNode);
                            for (
                              x = x.concat(j), f = S = E = x.pop() || K;
                              0 < x.length;

                            )
                              (E = x.pop()), S.appendChild(E), (S = E);
                            B.appendChild(f), (E.textContent = K.data);
                          }
                          for (
                            T && f && (Y = g(f)) && (T = Y),
                              E = h,
                              x = [],
                              N = "";
                            E !== B && E !== L && null !== E;

                          )
                            (o = p(E) ? null : i(E)) &&
                              1 === E.nodeType &&
                              P(E) &&
                              (x.push(o),
                              (N +=
                                E.style.cssText.substr(
                                  0,
                                  E.style.cssText.indexOf(":")
                                ) + "|")),
                              (E = E.parentNode);
                          var G = x.pop() || X;
                          for (S = E = G; 0 < x.length; )
                            (E = x.pop()), S.appendChild(E), (S = E);
                          T
                            ? ((t = t.cloneNode(!1)).appendChild(G),
                              T.insertBefore(t, T.firstChild),
                              B.appendChild(T),
                              z.push(t),
                              (T = null))
                            : t.appendChild(G),
                            (F = (I = X).data.length),
                            (R = !0),
                            !c && u && ((t = X).textContent = r.zeroWidthSpace),
                            E !== X && E.appendChild(I);
                        }
                      }
                    }
                  })(e, B),
                  d && !c && !h.v)
                )
                  return {
                    ancestor: e,
                    startContainer: n,
                    startOffset: l,
                    endContainer: o,
                    endOffset: s,
                  };
                if ((c = c && d))
                  for (var V = 0; V < z.length; V++) {
                    var W = z[V],
                      U = void 0,
                      q = void 0,
                      Z = void 0;
                    if (u)
                      (U = r.createTextNode(r.zeroWidthSpace)),
                        B.replaceChild(U, W);
                    else {
                      var $ = W.childNodes;
                      for (q = $[0]; $[0]; ) (Z = $[0]), B.insertBefore(Z, W);
                      r.removeItem(W);
                    }
                    0 === V && (u ? (M = I = U) : ((M = q), (I = Z)));
                  }
                else {
                  if (d)
                    for (var Y = 0; Y < z.length; Y++)
                      this._stripRemoveNode(z[Y]);
                  u && (M = I = t);
                }
                r.removeEmptyNode(B, t),
                  u && ((H = M.textContent.length), (F = I.textContent.length));
                var K = c || 0 === I.textContent.length;
                r.isBreak(I) ||
                  0 !== I.textContent.length ||
                  (r.removeItem(I), (I = M)),
                  (F = K ? I.textContent.length : F);
                var X = { s: 0, e: 0 },
                  j = r.getNodePath(M, B, X),
                  G = !I.parentNode;
                G && (I = M);
                var J = { s: 0, e: 0 },
                  Q = r.getNodePath(I, B, G || K ? null : J);
                (H += X.s),
                  (F = u
                    ? H
                    : G
                    ? M.textContent.length
                    : K
                    ? F + X.s
                    : F + J.s);
                var ee = r.mergeSameTags(B, [j, Q], !0);
                return (
                  e.parentNode.replaceChild(B, e),
                  (M = r.getNodeFromPath(j, B)),
                  (I = r.getNodeFromPath(Q, B)),
                  {
                    ancestor: B,
                    startContainer: M,
                    startOffset: H + ee[0],
                    endContainer: I,
                    endOffset: F + ee[1],
                  }
                );
              },
              _nodeChange_startLine: function (
                e,
                t,
                i,
                n,
                l,
                o,
                s,
                a,
                c,
                d,
                u
              ) {
                for (
                  var h = n.parentNode;
                  !(
                    h.nextSibling ||
                    h.previousSibling ||
                    r.isFormatElement(h.parentNode) ||
                    r.isWysiwygDiv(h.parentNode)
                  ) && h.nodeName !== t.nodeName;

                )
                  h = h.parentNode;
                if (
                  !s &&
                  h.nodeName === t.nodeName &&
                  !r.isFormatElement(h) &&
                  !h.nextSibling &&
                  r.onlyZeroWidthSpace(n.textContent.slice(0, l))
                ) {
                  for (var g = !0, p = n.previousSibling; p; ) {
                    if (!r.onlyZeroWidthSpace(p)) {
                      g = !1;
                      break;
                    }
                    p = p.previousSibling;
                  }
                  if (g)
                    return (
                      r.copyTagAttributes(h, t),
                      { ancestor: e, container: n, offset: l }
                    );
                }
                a.v = !1;
                var m,
                  f,
                  v,
                  _,
                  b,
                  y,
                  w,
                  C = e,
                  k = [t],
                  x = e.cloneNode(!1),
                  E = n,
                  S = l,
                  N = !1;
                if (
                  ((function e(n, l) {
                    for (
                      var o, s, a = n.childNodes, h = 0, g = a.length;
                      h < g;
                      h++
                    ) {
                      var p = a[h];
                      if (p) {
                        var b,
                          y = l;
                        if (N && !r.isBreak(p)) {
                          if (1 === p.nodeType) {
                            r._isIgnoreNodeChange(p)
                              ? ((t = t.cloneNode(!1)),
                                (s = p.cloneNode(!0)),
                                x.appendChild(s),
                                x.appendChild(t),
                                k.push(t),
                                u &&
                                  p.contains(u) &&
                                  ((b = r.getNodePath(u, p)),
                                  (u = r.getNodeFromPath(b, s))))
                              : e(p, p);
                            continue;
                          }
                          (f = p), (m = []);
                          for (
                            var w = [];
                            null !== f.parentNode && f !== C && f !== t;

                          )
                            (o = i(f)),
                              1 === f.nodeType &&
                                o &&
                                (d(f) ? _ || w.push(o) : m.push(o)),
                              (f = f.parentNode);
                          var T,
                            L = 0 < (m = m.concat(w)).length,
                            z = m.pop() || p;
                          for (v = f = z; 0 < m.length; )
                            (f = m.pop()), v.appendChild(f), (v = f);
                          if (
                            (d(t.parentNode) &&
                              !d(z) &&
                              ((t = t.cloneNode(!1)),
                              x.appendChild(t),
                              k.push(t)),
                            !_ && d(z))
                          ) {
                            t = t.cloneNode(!1);
                            for (
                              var B = z.childNodes, A = 0, M = B.length;
                              A < M;
                              A++
                            )
                              t.appendChild(B[A]);
                            z.appendChild(t),
                              x.appendChild(z),
                              (l = d(f) ? t : f),
                              k.push(t);
                          } else l = L ? (t.appendChild(z), f) : t;
                          _ &&
                            3 === p.nodeType &&
                            (c(p)
                              ? ((T = r.getParentElement(
                                  l,
                                  function (e) {
                                    return (
                                      this._isMaintainedNode(e.parentNode) ||
                                      e.parentNode === x
                                    );
                                  }.bind(r)
                                )),
                                _.appendChild(T),
                                (t = T.cloneNode(!1)),
                                k.push(t),
                                x.appendChild(t))
                              : (_ = null));
                        }
                        if (N || p !== E)
                          (o = N ? i(p) : p.cloneNode(!1)) &&
                            (l.appendChild(o),
                            1 !== p.nodeType || r.isBreak(p) || (y = o)),
                            e(p, y);
                        else {
                          var H = x;
                          _ = c(p);
                          var I = r.createTextNode(
                              1 === E.nodeType ? "" : E.substringData(0, S)
                            ),
                            F = r.createTextNode(
                              1 === E.nodeType
                                ? ""
                                : E.substringData(S, E.length - S)
                            );
                          if (_) {
                            var D = c(l);
                            if (D && D.parentNode !== H) {
                              for (var R = D, O = null; R.parentNode !== H; ) {
                                for (
                                  l = O = R.parentNode.cloneNode(!1);
                                  R.childNodes[0];

                                )
                                  O.appendChild(R.childNodes[0]);
                                R.appendChild(O), (R = R.parentNode);
                              }
                              R.parentNode.appendChild(D);
                            }
                            _ = _.cloneNode(!1);
                          }
                          r.onlyZeroWidthSpace(I) || l.appendChild(I);
                          var P = c(l);
                          for (
                            P && (_ = P), _ && (H = _), f = l, m = [];
                            f !== H && null !== f;

                          )
                            (o = i(f)),
                              1 === f.nodeType && o && m.push(o),
                              (f = f.parentNode);
                          var V = m.pop() || l;
                          for (v = f = V; 0 < m.length; )
                            (f = m.pop()), v.appendChild(f), (v = f);
                          (l = V !== l ? (t.appendChild(V), f) : t),
                            r.isBreak(p) && t.appendChild(p.cloneNode(!1)),
                            H.appendChild(t),
                            (E = F),
                            (N = !(S = 0)),
                            l.appendChild(E);
                        }
                      }
                    }
                  })(e, x),
                  s && !o && !a.v)
                )
                  return {
                    ancestor: e,
                    container: n,
                    offset: l,
                    endContainer: u,
                  };
                if ((o = o && s))
                  for (var T = 0; T < k.length; T++) {
                    for (var L = k[T], z = L.childNodes, B = z[0]; z[0]; )
                      x.insertBefore(z[0], L);
                    r.removeItem(L), 0 === T && (E = B);
                  }
                else if (s)
                  for (var A = 0; A < k.length; A++)
                    this._stripRemoveNode(k[A]);
                return (
                  o || 0 !== x.childNodes.length
                    ? (r.removeEmptyNode(x, t),
                      r.onlyZeroWidthSpace(x.textContent) &&
                        ((E = x.firstChild), (S = 0)),
                      (b = { s: 0, e: 0 }),
                      (y = r.getNodePath(E, x, b)),
                      (S += b.s),
                      (w = r.mergeSameTags(x, [y], !0)),
                      e.parentNode.replaceChild(x, e),
                      (E = r.getNodeFromPath(y, x)),
                      (S += w[0]))
                    : e.childNodes
                    ? (E = e.childNodes[0])
                    : ((E = r.createTextNode(r.zeroWidthSpace)),
                      e.appendChild(E)),
                  { ancestor: x, container: E, offset: S, endContainer: u }
                );
              },
              _nodeChange_middleLine: function (e, t, i, n, l, o, s) {
                if (!l) {
                  var a = null;
                  s && e.contains(s) && (a = r.getNodePath(s, e));
                  for (
                    var c,
                      d = e.cloneNode(!0),
                      u = t.nodeName,
                      h = t.style.cssText,
                      g = t.className,
                      p = d.childNodes,
                      m = 0,
                      f = p.length;
                    m < f && 3 !== (c = p[m]).nodeType;
                    m++
                  )
                    if (c.nodeName === u)
                      (c.style.cssText += h), r.addClass(c, g);
                    else {
                      if (!r.isBreak(c) && r._isIgnoreNodeChange(c)) continue;
                      if (1 !== f) break;
                      (f = (p = c.childNodes).length), (m = -1);
                    }
                  if (0 < f && m === f)
                    return (
                      (e.innerHTML = d.innerHTML),
                      {
                        ancestor: e,
                        endContainer: a ? r.getNodeFromPath(a, e) : null,
                      }
                    );
                }
                o.v = !1;
                var v = e.cloneNode(!1),
                  _ = [t],
                  b = !0;
                if (
                  ((function e(n, l) {
                    for (
                      var o, a, c = n.childNodes, d = 0, u = c.length;
                      d < u;
                      d++
                    ) {
                      var h,
                        g,
                        p = c[d];
                      p &&
                        ((h = l),
                        r.isBreak(p) || !r._isIgnoreNodeChange(p)
                          ? ((o = i(p)) &&
                              ((b = !1),
                              l.appendChild(o),
                              1 === p.nodeType && (h = o)),
                            r.isBreak(p) || e(p, h))
                          : (0 < t.childNodes.length &&
                              (v.appendChild(t), (t = t.cloneNode(!1))),
                            (a = p.cloneNode(!0)),
                            v.appendChild(a),
                            v.appendChild(t),
                            _.push(t),
                            (l = t),
                            s &&
                              p.contains(s) &&
                              ((g = r.getNodePath(s, p)),
                              (s = r.getNodeFromPath(g, a)))));
                    }
                  })(e, t),
                  b || (l && !n && !o.v))
                )
                  return { ancestor: e, endContainer: s };
                if ((v.appendChild(t), n && l))
                  for (var y = 0; y < _.length; y++) {
                    for (var w = _[y], C = w.childNodes; C[0]; )
                      v.insertBefore(C[0], w);
                    r.removeItem(w);
                  }
                else if (l)
                  for (var k = 0; k < _.length; k++)
                    this._stripRemoveNode(_[k]);
                return (
                  r.removeEmptyNode(v, t),
                  r.mergeSameTags(v, null, !0),
                  e.parentNode.replaceChild(v, e),
                  { ancestor: v, endContainer: s }
                );
              },
              _nodeChange_endLine: function (e, t, i, n, l, o, s, a, c, d) {
                for (
                  var u = n.parentNode;
                  !(
                    u.nextSibling ||
                    u.previousSibling ||
                    r.isFormatElement(u.parentNode) ||
                    r.isWysiwygDiv(u.parentNode)
                  ) && u.nodeName !== t.nodeName;

                )
                  u = u.parentNode;
                if (
                  !s &&
                  u.nodeName === t.nodeName &&
                  !r.isFormatElement(u) &&
                  !u.previousSibling &&
                  r.onlyZeroWidthSpace(n.textContent.slice(l))
                ) {
                  for (var h = !0, g = n.nextSibling; g; ) {
                    if (!r.onlyZeroWidthSpace(g)) {
                      h = !1;
                      break;
                    }
                    g = g.nextSibling;
                  }
                  if (h)
                    return (
                      r.copyTagAttributes(u, t),
                      { ancestor: e, container: n, offset: l }
                    );
                }
                a.v = !1;
                var p,
                  m,
                  f,
                  v,
                  _ = e,
                  b = [t],
                  y = e.cloneNode(!1),
                  w = n,
                  C = l,
                  k = !1;
                if (
                  ((function e(n, l) {
                    for (
                      var o, s = n.childNodes, a = s.length - 1;
                      0 <= a;
                      a--
                    ) {
                      var u = s[a];
                      if (u) {
                        var h,
                          g = l;
                        if (k && !r.isBreak(u)) {
                          if (1 === u.nodeType) {
                            r._isIgnoreNodeChange(u)
                              ? ((t = t.cloneNode(!1)),
                                (h = u.cloneNode(!0)),
                                y.insertBefore(h, l),
                                y.insertBefore(t, h),
                                b.push(t))
                              : e(u, u);
                            continue;
                          }
                          (m = u), (p = []);
                          for (
                            var x = [];
                            null !== m.parentNode && m !== _ && m !== t;

                          )
                            (o = i(m)) &&
                              1 === m.nodeType &&
                              (d(m) ? v || x.push(o) : p.push(o)),
                              (m = m.parentNode);
                          var E,
                            S = 0 < (p = p.concat(x)).length,
                            N = p.pop() || u;
                          for (f = m = N; 0 < p.length; )
                            (m = p.pop()), f.appendChild(m), (f = m);
                          if (
                            (d(t.parentNode) &&
                              !d(N) &&
                              ((t = t.cloneNode(!1)),
                              y.insertBefore(t, y.firstChild),
                              b.push(t)),
                            !v && d(N))
                          ) {
                            t = t.cloneNode(!1);
                            for (
                              var T = N.childNodes, L = 0, z = T.length;
                              L < z;
                              L++
                            )
                              t.appendChild(T[L]);
                            N.appendChild(t),
                              y.insertBefore(N, y.firstChild),
                              b.push(t),
                              (l = 0 < t.children.length ? m : t);
                          } else
                            l = S ? (t.insertBefore(N, t.firstChild), m) : t;
                          v &&
                            3 === u.nodeType &&
                            (c(u)
                              ? ((E = r.getParentElement(
                                  l,
                                  function (e) {
                                    return (
                                      this._isMaintainedNode(e.parentNode) ||
                                      e.parentNode === y
                                    );
                                  }.bind(r)
                                )),
                                v.appendChild(E),
                                (t = E.cloneNode(!1)),
                                b.push(t),
                                y.insertBefore(t, y.firstChild))
                              : (v = null));
                        }
                        if (k || u !== w)
                          (o = k ? i(u) : u.cloneNode(!1)) &&
                            (l.insertBefore(o, l.firstChild),
                            1 !== u.nodeType || r.isBreak(u) || (g = o)),
                            e(u, g);
                        else {
                          v = c(u);
                          var B = r.createTextNode(
                              1 === w.nodeType
                                ? ""
                                : w.substringData(C, w.length - C)
                            ),
                            A = r.createTextNode(
                              1 === w.nodeType ? "" : w.substringData(0, C)
                            );
                          if (v) {
                            v = v.cloneNode(!1);
                            var M = c(l);
                            if (M && M.parentNode !== y) {
                              for (var H = M, I = null; H.parentNode !== y; ) {
                                for (
                                  l = I = H.parentNode.cloneNode(!1);
                                  H.childNodes[0];

                                )
                                  I.appendChild(H.childNodes[0]);
                                H.appendChild(I), (H = H.parentNode);
                              }
                              H.parentNode.insertBefore(
                                M,
                                H.parentNode.firstChild
                              );
                            }
                            v = v.cloneNode(!1);
                          } else
                            d(t.parentNode) &&
                              !v &&
                              ((t = t.cloneNode(!1)),
                              y.appendChild(t),
                              b.push(t));
                          for (
                            r.onlyZeroWidthSpace(B) ||
                              l.insertBefore(B, l.firstChild),
                              m = l,
                              p = [];
                            m !== y && null !== m;

                          )
                            (o = d(m) ? null : i(m)) &&
                              1 === m.nodeType &&
                              p.push(o),
                              (m = m.parentNode);
                          var F = p.pop() || l;
                          for (f = m = F; 0 < p.length; )
                            (m = p.pop()), f.appendChild(m), (f = m);
                          (l =
                            F !== l ? (t.insertBefore(F, t.firstChild), m) : t),
                            r.isBreak(u) && t.appendChild(u.cloneNode(!1)),
                            v
                              ? (v.insertBefore(t, v.firstChild),
                                y.insertBefore(v, y.firstChild),
                                (v = null))
                              : y.insertBefore(t, y.firstChild),
                            (C = (w = A).data.length),
                            (k = !0),
                            l.insertBefore(w, l.firstChild);
                        }
                      }
                    }
                  })(e, y),
                  s && !o && !a.v)
                )
                  return { ancestor: e, container: n, offset: l };
                if ((o = o && s))
                  for (var x = 0; x < b.length; x++) {
                    for (var E = b[x], S = E.childNodes, N = null; S[0]; )
                      (N = S[0]), y.insertBefore(N, E);
                    r.removeItem(E),
                      x === b.length - 1 && (C = (w = N).textContent.length);
                  }
                else if (s)
                  for (var T = 0; T < b.length; T++)
                    this._stripRemoveNode(b[T]);
                if (o || 0 !== y.childNodes.length) {
                  if (!s && 0 === t.textContent.length)
                    return (
                      r.removeEmptyNode(y, null),
                      { ancestor: null, container: null, offset: 0 }
                    );
                  r.removeEmptyNode(y, t),
                    r.onlyZeroWidthSpace(y.textContent)
                      ? ((w = y.firstChild), (C = w.textContent.length))
                      : r.onlyZeroWidthSpace(w) && ((w = t), (C = 1));
                  var L = { s: 0, e: 0 },
                    z = r.getNodePath(w, y, L);
                  C += L.s;
                  var B = r.mergeSameTags(y, [z], !0);
                  e.parentNode.replaceChild(y, e),
                    (w = r.getNodeFromPath(z, y)),
                    (C += B[0]);
                } else
                  e.childNodes
                    ? (w = e.childNodes[0])
                    : ((w = r.createTextNode(r.zeroWidthSpace)),
                      e.appendChild(w));
                return { ancestor: y, container: w, offset: C };
              },
              actionCall: function (t, i, n) {
                if (i) {
                  if (/more/i.test(i) && n !== this._moreLayerActiveButton) {
                    var l = e.element.toolbar.querySelector("." + t);
                    return void (
                      l &&
                      (this._moreLayerActiveButton &&
                        ((e.element.toolbar.querySelector(
                          "." +
                            this._moreLayerActiveButton.getAttribute(
                              "data-command"
                            )
                        ).style.display = "none"),
                        r.removeClass(this._moreLayerActiveButton, "on")),
                      r.addClass(n, "on"),
                      (this._moreLayerActiveButton = n),
                      (l.style.display = "block"),
                      u._showToolbarBalloon(),
                      u._showToolbarInline())
                    );
                  }
                  if (
                    /submenu/.test(i) &&
                    (null === this._menuTray[t] ||
                      n !== this.submenuActiveButton)
                  )
                    return void this.callPlugin(
                      t,
                      this.submenuOn.bind(this, n),
                      n
                    );
                  if (/dialog/.test(i))
                    return void this.callPlugin(
                      t,
                      this.plugins[t].open.bind(this),
                      n
                    );
                  if (/command/.test(i))
                    this.callPlugin(t, this.plugins[t].action.bind(this), n);
                  else {
                    if (
                      /container/.test(i) &&
                      (null === this._menuTray[t] ||
                        n !== this.containerActiveButton)
                    )
                      return void this.callPlugin(
                        t,
                        this.containerOn.bind(this, n),
                        n
                      );
                    /fileBrowser/.test(i) &&
                      this.callPlugin(
                        t,
                        this.plugins[t].open.bind(this, null),
                        n
                      );
                  }
                } else t && this.commandHandler(n, t);
                var o;
                /more/i.test(i)
                  ? (o = e.element.toolbar.querySelector(
                      "." +
                        this._moreLayerActiveButton.getAttribute("data-command")
                    )) &&
                    (r.removeClass(this._moreLayerActiveButton, "on"),
                    (this._moreLayerActiveButton = null),
                    (o.style.display = "none"),
                    u._showToolbarBalloon(),
                    u._showToolbarInline())
                  : /submenu/.test(i)
                  ? this.submenuOff()
                  : (this.submenuOff(), this.containerOff());
              },
              commandHandler: function (t, i) {
                var n = e.element.wysiwyg,
                  o =
                    r.getChildElement(
                      n.firstChild,
                      function (e) {
                        return 0 === e.childNodes.length || 3 === e.nodeType;
                      },
                      !1
                    ) || n.firstChild,
                  s =
                    r.getChildElement(
                      n.lastChild,
                      function (e) {
                        return 0 === e.childNodes.length || 3 === e.nodeType;
                      },
                      !0
                    ) || n.lastChild,
                  a = this._variable.currentNodesMap,
                  c = -1 < a.indexOf(i) ? null : r.createElement(i),
                  d = i;
                switch (i) {
                  case "selectAll":
                    if (!o || !s) return;
                    this.setRange(o, 0, s, s.textContent.length);
                    break;
                  case "codeView":
                    this.toggleCodeView();
                    break;
                  case "fullScreen":
                    this.toggleFullScreen(t);
                    break;
                  case "indent":
                  case "outdent":
                    this.indent(i);
                    break;
                  case "undo":
                    this.history.undo();
                    break;
                  case "redo":
                    this.history.redo();
                    break;
                  case "removeFormat":
                    this.removeFormat(), this.focus();
                    break;
                  case "print":
                    this.print();
                    break;
                  case "preview":
                    this.preview();
                    break;
                  case "showBlocks":
                    this.toggleDisplayBlocks();
                    break;
                  case "save":
                    if ("function" == typeof l.callBackSave)
                      l.callBackSave(this.getContents(!1));
                    else {
                      if ("function" != typeof h.save)
                        throw Error(
                          "[KothingEditor.core.commandHandler.fail] Please register call back function in creation option. (callBackSave : Function)"
                        );
                      h.save();
                    }
                    e.tool.save && e.tool.save.setAttribute("disabled", !0);
                    break;
                  default:
                    (i = this._defaultCommand[i.toLowerCase()] || i),
                      this.commandMap[i] || (this.commandMap[i] = t),
                      /^SUB$/i.test(i) && -1 < a.indexOf("SUP")
                        ? (d = "SUP")
                        : /^SUP$/i.test(i) &&
                          -1 < a.indexOf("SUB") &&
                          (d = "SUB"),
                      this.nodeChange(c, null, [d], !1),
                      this.focus();
                }
              },
              removeFormat: function () {
                this.nodeChange(null, null, null, null);
              },
              indent: function (e) {
                for (
                  var t,
                    i,
                    n = this.getRange(),
                    l = this.getSelectedElements(null),
                    o = [],
                    s = "indent" !== e,
                    a = n.startContainer,
                    c = n.endContainer,
                    d = n.startOffset,
                    u = n.endOffset,
                    h = 0,
                    g = l.length;
                  h < g;
                  h++
                )
                  (t = l[h]),
                    r.isListCell(t) && this.plugins.list
                      ? (s || t.previousElementSibling) && o.push(t)
                      : ((i = /\d+/.test(t.style.marginLeft)
                          ? r.getNumber(t.style.marginLeft, 0)
                          : 0),
                        s ? (i -= 25) : (i += 25),
                        r.setStyle(t, "marginLeft", i <= 0 ? "" : i + "px"));
                0 < o.length &&
                  this.plugins.list.editInsideList.call(this, s, o),
                  (this.effectNode = null),
                  this.setRange(a, d, c, u),
                  this.history.push(!1);
              },
              toggleDisplayBlocks: function () {
                var t = e.element.wysiwyg;
                r.toggleClass(t, "ke-show-block"),
                  r.hasClass(t, "ke-show-block")
                    ? r.addClass(this._styleCommandMap.showBlocks, "active")
                    : r.removeClass(this._styleCommandMap.showBlocks, "active"),
                  this._resourcesStateChange();
              },
              toggleCodeView: function () {
                var t = this._variable.isCodeView;
                this.controllersOff(),
                  r.setDisabledButtons(!t, this.codeViewDisabledButtons),
                  t
                    ? (this._setCodeDataToEditor(),
                      (e.element.wysiwygFrame.scrollTop = 0),
                      (e.element.code.style.display = "none"),
                      (e.element.wysiwygFrame.style.display = "block"),
                      (this._variable._codeOriginCssText = this._variable._codeOriginCssText.replace(
                        /(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,
                        "display: none"
                      )),
                      (this._variable._wysiwygOriginCssText = this._variable._wysiwygOriginCssText.replace(
                        /(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,
                        "display: block"
                      )),
                      "auto" !== l.height ||
                        l.codeMirrorEditor ||
                        (e.element.code.style.height = "0px"),
                      (this._variable.isCodeView = !1),
                      this._variable.isFullScreen ||
                        ((this._notHideToolbar = !1),
                        /balloon|balloon-always/i.test(l.mode) &&
                          ((e.element._arrow.style.display = ""),
                          (this._isInline = !1),
                          (this._isBalloon = !0),
                          u._hideToolbar())),
                      this.nativeFocus(),
                      r.removeClass(this._styleCommandMap.codeView, "active"),
                      this.history.push(!1))
                    : (this._setEditorDataToCodeView(),
                      (this._variable._codeOriginCssText = this._variable._codeOriginCssText.replace(
                        /(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,
                        "display: block"
                      )),
                      (this._variable._wysiwygOriginCssText = this._variable._wysiwygOriginCssText.replace(
                        /(\s?display(\s+)?:(\s+)?)[a-zA-Z]+(?=;)/,
                        "display: none"
                      )),
                      "auto" !== l.height ||
                        l.codeMirrorEditor ||
                        (e.element.code.style.height =
                          0 < e.element.code.scrollHeight
                            ? e.element.code.scrollHeight + "px"
                            : "auto"),
                      l.codeMirrorEditor && l.codeMirrorEditor.refresh(),
                      (this._variable.isCodeView = !0),
                      this._variable.isFullScreen ||
                        ((this._notHideToolbar = !0),
                        this._isBalloon &&
                          ((e.element._arrow.style.display = "none"),
                          (e.element.toolbar.style.left = ""),
                          (this._isInline = !0),
                          (this._isBalloon = !1),
                          u._showToolbarInline())),
                      (this._variable._range = null),
                      e.element.code.focus(),
                      r.addClass(this._styleCommandMap.codeView, "active")),
                  this._checkPlaceholder(),
                  "function" == typeof h.toggleCodeView &&
                    h.toggleCodeView(this._variable.isCodeView, this);
              },
              _setCodeDataToEditor: function () {
                var t = this._getCodeView();
                if (l.fullPage) {
                  for (
                    var i = this._parser.parseFromString(t, "text/html"),
                      n = i.head.children,
                      o = 0,
                      s = n.length;
                    o < s;
                    o++
                  )
                    /script/i.test(n[o].tagName) &&
                      (i.head.removeChild(n[o]), o--, s--);
                  (this._wd.head.innerHTML = i.head.innerHTML),
                    (this._wd.body.innerHTML = this.convertContentsForEditor(
                      i.body.innerHTML
                    ));
                  for (
                    var a = i.body.attributes, c = 0, d = a.length;
                    c < d;
                    c++
                  )
                    "contenteditable" !== a[c].name &&
                      this._wd.body.setAttribute(a[c].name, a[c].value);
                  r.hasClass(this._wd.body, "kothing-editor-editable") ||
                    r.addClass(this._wd.body, "kothing-editor-editable");
                } else
                  e.element.wysiwyg.innerHTML =
                    0 < t.length
                      ? this.convertContentsForEditor(t)
                      : "<p><br></p>";
              },
              _setEditorDataToCodeView: function () {
                var t,
                  i,
                  n = this.convertHTMLForCodeView(e.element.wysiwyg);
                (i = l.fullPage
                  ? ((t = r.getAttributesToString(this._wd.body, null)),
                    "<!DOCTYPE html>\n<html>\n" +
                      this._wd.head.outerHTML.replace(/>(?!\n)/g, ">\n") +
                      "<body " +
                      t +
                      ">\n" +
                      n +
                      "</body>\n</html>")
                  : n),
                  (e.element.code.style.display = "block"),
                  (e.element.wysiwygFrame.style.display = "none"),
                  this._setCodeView(i);
              },
              toggleFullScreen: function (t) {
                var i = e.element.topArea,
                  n = e.element.toolbar,
                  o = e.element.editorArea,
                  d = e.element.wysiwygFrame,
                  g = e.element.code,
                  p = this._variable;
                this.controllersOff(),
                  p.isFullScreen
                    ? ((p.isFullScreen = !1),
                      (d.style.cssText = p._wysiwygOriginCssText),
                      (g.style.cssText = p._codeOriginCssText),
                      (n.style.cssText = ""),
                      (o.style.cssText = p._editorAreaOriginCssText),
                      (i.style.cssText = p._originCssText),
                      (s.body.style.overflow = p._bodyOverflow),
                      l.toolbarContainer && l.toolbarContainer.appendChild(n),
                      -1 < l.stickyToolbar &&
                        r.removeClass(n, "ke-toolbar-sticky"),
                      p._fullScreenAttrs.sticky &&
                        !l.toolbarContainer &&
                        ((p._fullScreenAttrs.sticky = !1),
                        (e.element._stickyDummy.style.display = "block"),
                        r.addClass(n, "ke-toolbar-sticky")),
                      (this._isInline = p._fullScreenAttrs.inline),
                      (this._isBalloon = p._fullScreenAttrs.balloon),
                      this._isInline && u._showToolbarInline(),
                      l.toolbarContainer &&
                        r.removeClass(n, "ke-toolbar-balloon"),
                      u.onScroll_window(),
                      r.changeElement(t.firstElementChild, c.expansion),
                      r.removeClass(this._styleCommandMap.fullScreen, "active"))
                    : ((p.isFullScreen = !0),
                      (p._fullScreenAttrs.inline = this._isInline),
                      (p._fullScreenAttrs.balloon = this._isBalloon),
                      (this._isInline || this._isBalloon) &&
                        ((this._isInline = !1), (this._isBalloon = !1)),
                      l.toolbarContainer &&
                        e.element.relative.insertBefore(n, o),
                      (i.style.position = "fixed"),
                      (i.style.top = "0"),
                      (i.style.left = "0"),
                      (i.style.width = "100%"),
                      (i.style.maxWidth = "100%"),
                      (i.style.height = "100%"),
                      (i.style.zIndex = "2147483647"),
                      "" !== e.element._stickyDummy.style.display &&
                        ((p._fullScreenAttrs.sticky = !0),
                        (e.element._stickyDummy.style.display = "none"),
                        r.removeClass(n, "ke-toolbar-sticky")),
                      (p._bodyOverflow = s.body.style.overflow),
                      (s.body.style.overflow = "hidden"),
                      (p._editorAreaOriginCssText = o.style.cssText),
                      (p._wysiwygOriginCssText = d.style.cssText),
                      (p._codeOriginCssText = g.style.cssText),
                      (o.style.cssText = n.style.cssText = ""),
                      (d.style.cssText = (d.style.cssText.match(
                        /\s?display(\s+)?:(\s+)?[a-zA-Z]+;/
                      ) || [""])[0]),
                      (g.style.cssText = (g.style.cssText.match(
                        /\s?display(\s+)?:(\s+)?[a-zA-Z]+;/
                      ) || [""])[0]),
                      (n.style.width = d.style.height = g.style.height =
                        "100%"),
                      (n.style.position = "relative"),
                      (n.style.display = "block"),
                      (p.innerHeight_fullScreen =
                        a.innerHeight - n.offsetHeight),
                      (o.style.height = p.innerHeight_fullScreen + "px"),
                      r.changeElement(t.firstElementChild, c.reduction),
                      l.iframe &&
                        "auto" === l.height &&
                        ((o.style.overflow = "auto"), this._iframeAutoHeight()),
                      r.addClass(this._styleCommandMap.fullScreen, "active")),
                  "function" == typeof h.toggleFullScreen &&
                    h.toggleFullScreen(this._variable.isFullScreen, this);
              },
              print: function () {
                var e = r.createElement("IFRAME");
                (e.style.display = "none"), s.body.appendChild(e);
                var t = r.getIframeDocument(e),
                  i = this.getContents(!0),
                  n = this._wd;
                if (l.iframe) {
                  var o = l.fullPage
                    ? r.getAttributesToString(n.body, ["contenteditable"])
                    : 'class="kothing-editor-editable"';
                  t.write(
                    "<!DOCTYPE html><html><head>" +
                      n.head.innerHTML +
                      "</head><body " +
                      o +
                      ">" +
                      i +
                      "</body></html>"
                  );
                } else {
                  for (
                    var c = s.head.getElementsByTagName("link"),
                      u = s.head.getElementsByTagName("style"),
                      h = "",
                      g = 0,
                      p = c.length;
                    g < p;
                    g++
                  )
                    h += c[g].outerHTML;
                  for (var m = 0, f = u.length; m < f; m++) h += u[m].outerHTML;
                  t.write(
                    "<!DOCTYPE html><html><head>" +
                      h +
                      '</head><body class="kothing-editor-editable">' +
                      i +
                      "</body></html>"
                  );
                }
                this.showLoading(),
                  a.setTimeout(function () {
                    try {
                      if (
                        (e.focus(),
                        r.isIE_Edge || s.documentMode || a.StyleMedia)
                      )
                        try {
                          e.contentWindow.document.execCommand(
                            "print",
                            !1,
                            null
                          );
                        } catch (t) {
                          e.contentWindow.print();
                        }
                      else e.contentWindow.print();
                    } catch (t) {
                      throw Error(
                        "[KothingEditor.core.print.fail] error: " + t
                      );
                    } finally {
                      d.closeLoading(), r.removeItem(e);
                    }
                  }, 1e3);
              },
              preview: function () {
                d.submenuOff(), d.containerOff(), d.controllersOff();
                var t = this.getContents(!0),
                  i = a.open("", "_blank");
                i.mimeType = "text/html";
                var o = e.element.wysiwygFrame.offsetWidth + "px !important",
                  c = this._wd;
                if (l.iframe) {
                  var u = l.fullPage
                    ? r.getAttributesToString(c.body, ["contenteditable"])
                    : 'class="kothing-editor-editable"';
                  i.document.write(
                    "<!DOCTYPE html><html><head>" +
                      c.head.innerHTML +
                      "<style>body {overflow:auto !important; width:" +
                      o +
                      "; border:1px solid #ccc; margin: 10px auto !important; height:auto !important;}</style></head><body " +
                      u +
                      ">" +
                      t +
                      "</body></html>"
                  );
                } else {
                  for (
                    var h = s.head.getElementsByTagName("link"),
                      g = s.head.getElementsByTagName("style"),
                      p = "",
                      m = 0,
                      f = h.length;
                    m < f;
                    m++
                  )
                    p += h[m].outerHTML;
                  for (var v = 0, _ = g.length; v < _; v++) p += g[v].outerHTML;
                  i.document.write(
                    '<!DOCTYPE html><html><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1"><title>' +
                      n.toolbar.preview +
                      "</title>" +
                      p +
                      '</head><body class="kothing-editor-editable" style="width:' +
                      o +
                      '; border:1px solid #ccc; margin:10px auto !important; height:auto !important;">' +
                      t +
                      "</body></html>"
                  );
                }
              },
              setContents: function (t) {
                var i,
                  n = this.convertContentsForEditor(t);
                this._resetComponents(),
                  this._variable.isCodeView
                    ? ((i = this.convertHTMLForCodeView(n)),
                      this._setCodeView(i))
                    : ((e.element.wysiwyg.innerHTML = n),
                      this.history.push(!1));
              },
              getContents: function (t) {
                var i = e.element.wysiwyg.innerHTML,
                  n = r.createElement("DIV");
                n.innerHTML = i;
                for (
                  var o = r.getListChildren(n, function (e) {
                      return /FIGCAPTION/i.test(e.nodeName);
                    }),
                    s = 0,
                    a = o.length;
                  s < a;
                  s++
                )
                  o[s].removeAttribute("contenteditable");
                if (!l.fullPage || t) return n.innerHTML;
                var c = r.getAttributesToString(this._wd.body, [
                  "contenteditable",
                ]);
                return (
                  "<!DOCTYPE html><html>" +
                  this._wd.head.outerHTML +
                  "<body " +
                  c +
                  ">" +
                  n.innerHTML +
                  "</body></html>"
                );
              },
              _makeLine: function (e, t) {
                if (1 === e.nodeType)
                  return r._disallowedTags(e)
                    ? ""
                    : !t ||
                      r.isFormatElement(e) ||
                      r.isRangeFormatElement(e) ||
                      r.isComponent(e) ||
                      r.isMedia(e) ||
                      (r.isAnchor(e) && r.isMedia(e.firstElementChild))
                    ? e.outerHTML
                    : "<p>" + e.outerHTML + "</p>";
                if (3 !== e.nodeType)
                  return 8 === e.nodeType && this._allowHTMLComments
                    ? "\x3c!--" + e.textContent.trim() + "--\x3e"
                    : "";
                if (!t) return e.textContent;
                for (
                  var i,
                    n = e.textContent.split(/\n/g),
                    l = "",
                    o = 0,
                    s = n.length;
                  o < s;
                  o++
                )
                  0 < (i = n[o].trim()).length && (l += "<p>" + i + "</p>");
                return l;
              },
              _tagConvertor: function (e) {
                if (!this._disallowedTextTagsRegExp) return e;
                var t = {
                  b: "strong",
                  i: "em",
                  ins: "u",
                  strike: "del",
                  s: "del",
                };
                return e.replace(this._disallowedTextTagsRegExp, function (
                  e,
                  i,
                  n
                ) {
                  return i + ("string" == typeof t[n] ? t[n] : n);
                });
              },
              _deleteDisallowedTags: function (e) {
                return e
                  .replace(/\n/g, "")
                  .replace(/<(script|style).*>(\n|.)*<\/(script|style)>/gi, "")
                  .replace(
                    /<[a-z0-9]+\:[a-z0-9]+[^>^\/]*>[^>]*<\/[a-z0-9]+\:[a-z0-9]+>/gi,
                    ""
                  )
                  .replace(this.editorTagsWhitelistRegExp, "");
              },
              cleanHTML: function (e, t) {
                e = this._deleteDisallowedTags(e).replace(
                  /(<[a-zA-Z0-9]+)[^>]*(?=>)/g,
                  function (e, t) {
                    if (/^<[a-z0-9]+\:[a-z0-9]+/i.test(e)) return e;
                    var i,
                      n = null,
                      l = this._attributesTagsWhitelist[
                        t.match(/(?!<)[a-zA-Z0-9]+/)[0].toLowerCase()
                      ];
                    if (
                      ((n = l
                        ? e.match(l)
                        : e.match(this._attributesWhitelistRegExp)),
                      !/<span/i.test(t) ||
                        (n && /style=/i.test(n.toString())) ||
                        ((i = e.match(/style\s*=\s*"[^"]*"/)) &&
                          (n = n || []).push(i[0])),
                      n)
                    )
                      for (var o = 0, s = n.length; o < s; o++)
                        /^class="(?!(__ke__|ke-|katex))/.test(n[o]) ||
                          (t += " " + n[o]);
                    return t;
                  }.bind(this)
                );
                var i = s.createRange().createContextualFragment(e);
                try {
                  r._consistencyCheckOfHTML(i, this._htmlCheckWhitelistRegExp);
                } catch (e) {
                  console.warn(
                    "[KothingEditor.cleanHTML.consistencyCheck.fail] " + e
                  );
                }
                if (this.managedTagsInfo && this.managedTagsInfo.query)
                  for (
                    var n,
                      l,
                      o = i.querySelectorAll(this.managedTagsInfo.query),
                      a = 0,
                      c = o.length;
                    a < c;
                    a++
                  )
                    for (
                      var d = 0, u = (l = [].slice.call(o[a].classList)).length;
                      d < u;
                      d++
                    )
                      if ((n = this.managedTagsInfo.map[l[d]])) {
                        n(o[a]);
                        break;
                      }
                for (
                  var h, g = i.childNodes, p = "", m = !1, f = 0, v = g.length;
                  f < v;
                  f++
                )
                  if (
                    1 === (h = g[f]).nodeType &&
                    !r.isTextStyleElement(h) &&
                    !r.isBreak(h) &&
                    !r._disallowedTags(h)
                  ) {
                    m = !0;
                    break;
                  }
                for (var _ = 0, b = g.length; _ < b; _++)
                  p += this._makeLine(g[_], m);
                return (
                  (p = r.htmlRemoveWhiteSpace(p)),
                  this._tagConvertor(
                    p
                      ? t
                        ? p.replace(
                            "string" == typeof t ? r.createTagsWhitelist(t) : t,
                            ""
                          )
                        : p
                      : e
                  )
                );
              },
              convertContentsForEditor: function (e) {
                var t = s
                  .createRange()
                  .createContextualFragment(this._deleteDisallowedTags(e));
                try {
                  r._consistencyCheckOfHTML(t, this._htmlCheckWhitelistRegExp);
                } catch (e) {
                  console.warn(
                    "[KothingEditor.convertContentsForEditor.consistencyCheck.fail] " +
                      e
                  );
                }
                for (
                  var i = t.childNodes, n = "", l = 0, o = i.length;
                  l < o;
                  l++
                )
                  n += this._makeLine(i[l], !0);
                return 0 === n.length
                  ? "<p><br></p>"
                  : ((n = r.htmlRemoveWhiteSpace(n)), this._tagConvertor(n));
              },
              convertHTMLForCodeView: function (e) {
                var t = "",
                  i = a.RegExp,
                  n = new i(
                    "^(BLOCKQUOTE|PRE|TABLE|THEAD|TBODY|TR|TH|TD|OL|UL|IMG|IFRAME|VIDEO|AUDIO|FIGURE|FIGCAPTION|HR|BR|CANVAS|SELECT)$",
                    "i"
                  ),
                  l = r.isFormatElement.bind(r),
                  o =
                    "string" == typeof e
                      ? s.createRange().createContextualFragment(e)
                      : e,
                  c =
                    0 < (c = +this._variable.codeIndent)
                      ? new a.Array(c + 1).join(" ")
                      : "";
                return (
                  (function e(o, s, a) {
                    for (
                      var d,
                        u = o.childNodes,
                        h = n.test(o.nodeName),
                        g = h ? s : "",
                        p = 0,
                        m = u.length;
                      p < m;
                      p++
                    ) {
                      var f,
                        v = u[p],
                        _ = (d = n.test(v.nodeName)) ? "\n" : "";
                      (a =
                        !l(v) || h || /^(TH|TD)$/i.test(o.nodeName)
                          ? ""
                          : "\n"),
                        8 !== v.nodeType
                          ? 3 !== v.nodeType
                            ? 0 !== v.childNodes.length
                              ? ((f = v.nodeName.toLowerCase()),
                                (t +=
                                  (a || (h ? "" : _)) +
                                  (g || d ? s : "") +
                                  v.outerHTML.match(
                                    i("<" + f + "[^>]*>", "i")
                                  )[0] +
                                  _),
                                e(v, s + c, ""),
                                (t +=
                                  (d ? s : "") +
                                  "</" +
                                  f +
                                  ">" +
                                  (a || _ || h || /^(TH|TD)$/i.test(v.nodeName)
                                    ? "\n"
                                    : "")))
                              : (t +=
                                  (/^HR$/i.test(v.nodeName) ? "\n" : "") +
                                  g +
                                  v.outerHTML +
                                  _)
                            : (t += r._HTMLConvertor(
                                /^\n+$/.test(v.data) ? "" : v.data
                              ))
                          : (t +=
                              "\n\x3c!-- " +
                              v.textContent.trim() +
                              " --\x3e" +
                              _);
                    }
                  })(o, "", "\n"),
                  t.trim() + "\n"
                );
              },
              addDocEvent: function (e, t, i) {
                s.addEventListener(e, t, i),
                  l.iframe && this._wd.addEventListener(e, t);
              },
              removeDocEvent: function (e, t) {
                s.removeEventListener(e, t),
                  l.iframe && this._wd.removeEventListener(e, t);
              },
              _charCount: function (e) {
                var t = l.maxCharCount,
                  i = l.charCounterType,
                  n = 0;
                if (
                  (e && (n = this.getCharLength(e, i)),
                  this._setCharCount(),
                  0 < t)
                ) {
                  var o,
                    s,
                    a,
                    r,
                    c = !1,
                    d = h.getCharCount(i);
                  if (
                    (t < d
                      ? ((c = !0),
                        0 < n &&
                          (this._editorRange(),
                          (s = (o = this.getRange()).endOffset - 1),
                          (a = this.getSelectionNode().textContent),
                          (r = o.endOffset - (d - t)),
                          (this.getSelectionNode().textContent =
                            a.slice(0, r < 0 ? 0 : r) +
                            a.slice(o.endOffset, a.length)),
                          this.setRange(o.endContainer, s, o.endContainer, s)))
                      : t < d + n && (c = !0),
                    c && (this._callCounterBlink(), 0 < n))
                  )
                    return !1;
                }
                return !0;
              },
              checkCharCount: function (e, t) {
                if (l.maxCharCount) {
                  var i = t || l.charCounterType,
                    n = this.getCharLength(
                      "string" == typeof e
                        ? e
                        : this._charTypeHTML
                        ? e.outerHTML
                        : e.textContent,
                      i
                    );
                  if (0 < n && n + h.getCharCount(i) > l.maxCharCount)
                    return this._callCounterBlink(), !1;
                }
                return !0;
              },
              getCharLength: function (e, t) {
                return /byte/.test(t) ? r.getByteLength(e) : e.length;
              },
              _setCharCount: function () {
                e.element.charCounter &&
                  a.setTimeout(function () {
                    e.element.charCounter.textContent = h.getCharCount(
                      l.charCounterType
                    );
                  });
              },
              _callCounterBlink: function () {
                var t = e.element.charWrapper;
                t &&
                  !r.hasClass(t, "ke-blink") &&
                  (r.addClass(t, "ke-blink"),
                  a.setTimeout(function () {
                    r.removeClass(t, "ke-blink");
                  }, 600));
              },
              _checkComponents: function () {
                for (
                  var e = 0, t = this._fileInfoPluginsCheck.length;
                  e < t;
                  e++
                )
                  this._fileInfoPluginsCheck[e]();
              },
              _resetComponents: function () {
                for (
                  var e = 0, t = this._fileInfoPluginsReset.length;
                  e < t;
                  e++
                )
                  this._fileInfoPluginsReset[e]();
              },
              _setCodeView: function (t) {
                l.codeMirrorEditor
                  ? l.codeMirrorEditor.getDoc().setValue(t)
                  : (e.element.code.value = t);
              },
              _getCodeView: function () {
                return l.codeMirrorEditor
                  ? l.codeMirrorEditor.getDoc().getValue()
                  : e.element.code.value;
              },
              _init: function (n, o) {
                var c = a.RegExp;
                if (
                  ((this._ww = l.iframe
                    ? e.element.wysiwygFrame.contentWindow
                    : a),
                  (this._wd = s),
                  (this._charTypeHTML = "byte-html" === l.charCounterType),
                  !l.iframe && "function" == typeof a.ShadowRoot)
                )
                  for (var d = e.element.wysiwygFrame; d; ) {
                    if (d.shadowRoot) {
                      this._shadowRoot = d.shadowRoot;
                      break;
                    }
                    if (d instanceof a.ShadowRoot) {
                      this._shadowRoot = d;
                      break;
                    }
                    d = d.parentNode;
                  }
                for (
                  var u = ["b", "i", "ins", "s", "strike"],
                    h = l.addTagsWhitelist
                      ? l.addTagsWhitelist.split("|").filter(function (e) {
                          return /b|i|ins|s|strike/i.test(e);
                        })
                      : [],
                    g = 0;
                  g < h.length;
                  g++
                )
                  u.splice(u.indexOf(h[g].toLowerCase()), 1);
                this._disallowedTextTagsRegExp =
                  0 === u.length
                    ? null
                    : new c(
                        "(<\\/?)(" +
                          u.join("|") +
                          ")\\b\\s*(?:[^>^<]+)?\\s*(?=>)",
                        "gi"
                      );
                var p =
                  "contenteditable|colspan|rowspan|target|href|src|class|type|controls|data-format|data-size|data-file-size|data-file-name|data-origin|data-align|data-image-link|data-rotate|data-proportion|data-percentage|origin-size|data-exp|data-font-size";
                (this._allowHTMLComments =
                  -1 < l._editorTagsWhitelist.indexOf("//")),
                  (this._htmlCheckWhitelistRegExp = new c(
                    "^(" + l._editorTagsWhitelist.replace("|//", "") + ")$",
                    "i"
                  )),
                  (this.editorTagsWhitelistRegExp = r.createTagsWhitelist(
                    l._editorTagsWhitelist.replace("|//", "|\x3c!--|--\x3e")
                  )),
                  (this.pasteTagsWhitelistRegExp = r.createTagsWhitelist(
                    l.pasteTagsWhitelist
                  ));
                var m = l.attributesWhitelist,
                  f = {},
                  v = "";
                if (m)
                  for (var _ in m)
                    r.hasOwn(m, _) &&
                      ("all" === _
                        ? (v = m[_] + "|")
                        : (f[_] = new c(
                            "((?:" + m[_] + "|" + p + ')s*=s*"[^"]*")',
                            "ig"
                          )));
                (this._attributesWhitelistRegExp = new c(
                  "((?:" + v + p + ')s*=s*"[^"]*")',
                  "ig"
                )),
                  (this._attributesTagsWhitelist = f),
                  (this._isInline = /inline/i.test(l.mode)),
                  (this._isBalloon = /balloon|balloon-always/i.test(l.mode)),
                  (this._isBalloonAlways = /balloon-always/i.test(l.mode)),
                  this._cachingButtons(),
                  (this._fileInfoPluginsCheck = []),
                  (this._fileInfoPluginsReset = []),
                  (this.managedTagsInfo = { query: "", map: {} });
                var b = [];
                (this.activePlugins = []),
                  (this._fileManager.tags = []),
                  (this._fileManager.pluginMap = {});
                var y,
                  w,
                  C,
                  k,
                  x,
                  E,
                  S,
                  N,
                  T,
                  L,
                  z,
                  B,
                  A,
                  M,
                  I,
                  F = [];
                for (C in i)
                  if (r.hasOwn(i, C)) {
                    if (
                      ((y = i[C]),
                      (w = t[C]),
                      y.active && w && this.callPlugin(C, null, w),
                      "function" == typeof y.checkFileInfo &&
                        "function" == typeof y.resetFileInfo &&
                        (this.callPlugin(C, null, w),
                        this._fileInfoPluginsCheck.push(
                          y.checkFileInfo.bind(this)
                        ),
                        this._fileInfoPluginsReset.push(
                          y.resetFileInfo.bind(this)
                        )),
                      a.Array.isArray(y.fileTags))
                    ) {
                      var D = y.fileTags;
                      this.callPlugin(C, null, w),
                        (this._fileManager.tags = this._fileManager.tags.concat(
                          D
                        )),
                        F.push(C);
                      for (var R = 0, O = D.length; R < O; R++)
                        this._fileManager.pluginMap[D[R].toLowerCase()] = C;
                    }
                    y.managedTags &&
                      ((k = y.managedTags()),
                      b.push("." + k.className),
                      (this.managedTagsInfo.map[k.className] = k.method.bind(
                        this
                      )));
                  }
                function P() {
                  var e = I[M];
                  (L.wysiwyg.innerHTML = e.contents),
                    x.setRange(
                      N.getNodeFromPath(e.s.path, L.wysiwyg),
                      e.s.offset,
                      N.getNodeFromPath(e.e.path, L.wysiwyg),
                      e.e.offset
                    ),
                    x.focus(),
                    0 === M
                      ? (z && z.setAttribute("disabled", !0),
                        B && B.removeAttribute("disabled"))
                      : M === I.length - 1
                      ? (z && z.removeAttribute("disabled"),
                        B && B.setAttribute("disabled", !0))
                      : (z && z.removeAttribute("disabled"),
                        B && B.removeAttribute("disabled")),
                    x.controllersOff(),
                    x._checkComponents(),
                    x._setCharCount(),
                    x._resourcesStateChange(),
                    E();
                }
                function V() {
                  x._checkComponents();
                  var e,
                    t = x.getContents(!0);
                  (I[M] && t === I[M].contents) ||
                    (M++,
                    (e = x._variable._range),
                    I.length > M &&
                      ((I = I.slice(0, M)),
                      B && B.setAttribute("disabled", !0)),
                    (I[M] = e
                      ? {
                          contents: t,
                          s: {
                            path: N.getNodePath(e.startContainer, null, null),
                            offset: e.startOffset,
                          },
                          e: {
                            path: N.getNodePath(e.endContainer, null, null),
                            offset: e.endOffset,
                          },
                        }
                      : {
                          contents: t,
                          s: { path: [0, 0], offset: [0, 0] },
                          e: { path: 0, offset: 0 },
                        }),
                    1 === M && z && z.removeAttribute("disabled"),
                    x._setCharCount(),
                    E());
                }
                (this.managedTagsInfo.query = b.toString()),
                  (this._fileManager.queryString = this._fileManager.tags.join(
                    ","
                  )),
                  (this._fileManager.regExp = new c(
                    "^(" + this._fileManager.tags.join("|") + ")$",
                    "i"
                  )),
                  (this._fileManager.pluginRegExp = new c(
                    "^(" + (0 === F.length ? "undefined" : F.join("|")) + ")$",
                    "i"
                  )),
                  (this._variable._originCssText =
                    e.element.topArea.style.cssText),
                  (this._placeholder = e.element.placeholder),
                  (this._lineBreaker = e.element.lineBreaker),
                  (this._lineBreakerButton = this._lineBreaker.querySelector(
                    "button"
                  )),
                  (this.history =
                    ((E = (x = this)._onChange_historyStack.bind(this)),
                    (S = x._w),
                    (N = x.util),
                    (T = x.context.options.historyStackDelayTime),
                    (L = x.context.element),
                    (z = x.context.tool.undo),
                    (B = x.context.tool.redo),
                    (A = null),
                    (M = 0),
                    {
                      stack: (I = []),
                      push: function (e) {
                        S.setTimeout(x._resourcesStateChange.bind(x));
                        var t =
                          "number" == typeof e ? (0 < e ? e : 0) : e ? T : 0;
                        (t && !A) || (S.clearTimeout(A), t)
                          ? (A = S.setTimeout(function () {
                              S.clearTimeout(A), (A = null), V();
                            }, t))
                          : V();
                      },
                      undo: function () {
                        0 < M && (M--, P());
                      },
                      redo: function () {
                        I.length - 1 > M && (M++, P());
                      },
                      go: function (e) {
                        (M = e < 0 ? I.length - 1 : e), P();
                      },
                      reset: function (e) {
                        z && z.setAttribute("disabled", !0),
                          B && B.setAttribute("disabled", !0),
                          x.context.tool.save &&
                            x.context.tool.save.setAttribute("disabled", !0),
                          I.splice(0),
                          (I[(M = 0)] = {
                            contents: x.getContents(!0),
                            s: { path: [0, 0], offset: 0 },
                            e: { path: [0, 0], offset: 0 },
                          }),
                          e || E();
                      },
                      _resetCachingButton: function () {
                        (L = x.context.element),
                          (z = x.context.tool.undo),
                          (B = x.context.tool.redo),
                          0 === M
                            ? (z && z.setAttribute("disabled", !0),
                              B &&
                                M === I.length - 1 &&
                                B.setAttribute("disabled", !0),
                              x.context.tool.save &&
                                x.context.tool.save.setAttribute(
                                  "disabled",
                                  !0
                                ))
                            : M === I.length - 1 &&
                              B &&
                              B.setAttribute("disabled", !0);
                      },
                      _destroy: function () {
                        A && S.clearTimeout(A), (I = null);
                      },
                    })),
                  this.addModule([H]),
                  l.iframe &&
                    ((this._wd = e.element.wysiwygFrame.contentDocument),
                    (e.element.wysiwyg = this._wd.body),
                    l._editorStyles.editor &&
                      (e.element.wysiwyg.style.cssText =
                        l._editorStyles.editor),
                    "auto" === l.height && (this._iframeAuto = this._wd.body)),
                  this._initWysiwygArea(n, o);
              },
              _cachingButtons: function () {
                (this.codeViewDisabledButtons = e.element.toolbar.querySelectorAll(
                  '.ke-toolbar button:not([class~="ke-code-view-enabled"])'
                )),
                  (this.resizingDisabledButtons = e.element.toolbar.querySelectorAll(
                    '.ke-toolbar button:not([class~="ke-resizing-enabled"])'
                  ));
                var t = e.tool;
                (this.commandMap = {
                  STRONG: t.bold,
                  U: t.underline,
                  EM: t.italic,
                  DEL: t.strike,
                  SUB: t.subscript,
                  SUP: t.superscript,
                  OUTDENT: t.outdent,
                  INDENT: t.indent,
                }),
                  (this._styleCommandMap = {
                    fullScreen: t.fullScreen,
                    showBlocks: t.showBlocks,
                    codeView: t.codeView,
                  });
              },
              _initWysiwygArea: function (t, i) {
                e.element.wysiwyg.innerHTML = t
                  ? i
                  : this.convertContentsForEditor(
                      "string" == typeof i ? i : e.element.originElement.value
                    );
              },
              _resourcesStateChange: function () {
                this._iframeAutoHeight(), this._checkPlaceholder();
              },
              _onChange_historyStack: function () {
                u._applyTagEffects(),
                  e.tool.save && e.tool.save.removeAttribute("disabled"),
                  h.onChange && h.onChange(this.getContents(!0), this);
              },
              _iframeAutoHeight: function () {
                this._iframeAuto &&
                  a.setTimeout(function () {
                    e.element.wysiwygFrame.style.height =
                      d._iframeAuto.offsetHeight + "px";
                  });
              },
              _checkPlaceholder: function () {
                if (this._placeholder) {
                  if (this._variable.isCodeView)
                    return void (this._placeholder.style.display = "none");
                  var t = e.element.wysiwyg;
                  !r.onlyZeroWidthSpace(t.textContent) ||
                  t.querySelector(
                    ".ke-component, pre, blockquote, hr, li, table, img, iframe, video"
                  ) ||
                  1 < (t.innerText.match(/\n/g) || "").length
                    ? (this._placeholder.style.display = "none")
                    : (this._placeholder.style.display = "block");
                }
              },
              _setDefaultFormat: function (e) {
                if (
                  !this._fileManager.pluginRegExp.test(
                    this.currentControllerName
                  )
                ) {
                  var t,
                    i,
                    n,
                    l,
                    o = this.getRange(),
                    s = o.commonAncestorContainer,
                    a = o.startContainer,
                    c = r.getRangeFormatElement(s, null),
                    d = r.getParentElement(s, r.isComponent);
                  if (
                    (!d || r.isTable(d)) &&
                    ((!r.isRangeFormatElement(a) && !r.isWysiwygDiv(a)) ||
                      !r.isComponent(a.childNodes[o.startOffset]))
                  ) {
                    if (c)
                      return (
                        ((n = r.createElement(e || "P")).innerHTML =
                          c.innerHTML),
                        0 === n.childNodes.length &&
                          (n.innerHTML = r.zeroWidthSpace),
                        (c.innerHTML = n.outerHTML),
                        (n = c.firstChild),
                        (t = r.getEdgeChildNodes(n, null).sc) ||
                          ((t = r.createTextNode(r.zeroWidthSpace)),
                          n.insertBefore(t, n.firstChild)),
                        (i = t.textContent.length),
                        void this.setRange(t, i, t, i)
                      );
                    if (r.isRangeFormatElement(s) && s.childNodes.length <= 1) {
                      var u = null;
                      return (
                        1 === s.childNodes.length && r.isBreak(s.firstChild)
                          ? (u = s.firstChild)
                          : ((u = r.createTextNode(r.zeroWidthSpace)),
                            s.appendChild(u)),
                        void this.setRange(u, 1, u, 1)
                      );
                    }
                    if (
                      (this.execCommand("formatBlock", !1, e || "P"),
                      (t = (t = r.getEdgeChildNodes(s, s)) ? t.ec : s),
                      !(n = r.getFormatElement(t, null)))
                    )
                      return this.removeRange(), void this._editorRange();
                    r.isBreak(n.nextSibling) && r.removeItem(n.nextSibling),
                      r.isBreak(n.previousSibling) &&
                        r.removeItem(n.previousSibling),
                      r.isBreak(t) &&
                        ((l = r.createTextNode(r.zeroWidthSpace)),
                        t.parentNode.insertBefore(l, t),
                        (t = l)),
                      (this.effectNode = null),
                      this.nativeFocus();
                  }
                }
              },
              _setOptionsInit: function (t, i) {
                (this.context = e = M(
                  t.originElement,
                  this._getConstructed(t),
                  l
                )),
                  (this._componentsInfoReset = !0),
                  this._editorInit(!0, i);
              },
              _editorInit: function (t, i) {
                this._init(t, i),
                  u._addEvent(),
                  this._setCharCount(),
                  u._offStickyToolbar(),
                  u.onResize_window(),
                  (e.element.toolbar.style.visibility = ""),
                  this._checkComponents(),
                  (this._componentsInfoInit = !1),
                  (this._componentsInfoReset = !1),
                  this.history.reset(!0),
                  this._resourcesStateChange(),
                  a.setTimeout(function () {
                    "function" == typeof h.onload && h.onload(d, t);
                  });
              },
              _getConstructed: function (e) {
                return {
                  _top: e.topArea,
                  _relative: e.relative,
                  _toolBar: e.toolbar,
                  _menuTray: e._menuTray,
                  _editorArea: e.editorArea,
                  _wysiwygArea: e.wysiwygFrame,
                  _codeArea: e.code,
                  _placeholder: e.placeholder,
                  _resizingBar: e.resizingBar,
                  _navigation: e.navigation,
                  _charCounter: e.charCounter,
                  _charWrapper: e.charWrapper,
                  _loading: e.loading,
                  _lineBreaker: e.lineBreaker,
                  _lineBreaker_t: e.lineBreaker_t,
                  _lineBreaker_b: e.lineBreaker_b,
                  _resizeBack: e.resizeBackground,
                  _stickyDummy: e._stickyDummy,
                  _arrow: e._arrow,
                };
              },
            },
            u = {
              _IEisComposing: !1,
              _lineBreakerBind: null,
              _responsiveCurrentSize: "default",
              _responsiveButtonSize: null,
              _responsiveButtons: null,
              _directionKeyCode: new a.RegExp("^(8|13|3[2-9]|40|46)$"),
              _nonTextKeyCode: new a.RegExp(
                "^(8|13|1[6-9]|20|27|3[3-9]|40|45|46|11[2-9]|12[0-3]|144|145)$"
              ),
              _historyIgnoreKeyCode: new a.RegExp(
                "^(1[6-9]|20|27|3[3-9]|40|45|11[2-9]|12[0-3]|144|145)$"
              ),
              _onButtonsCheck: new a.RegExp("^(STRONG|U|EM|DEL|SUB|SUP)$"),
              _frontZeroWidthReg: new a.RegExp(r.zeroWidthSpace + "+", ""),
              _keyCodeShortcut: {
                65: "A",
                66: "B",
                83: "S",
                85: "U",
                73: "I",
                89: "Y",
                90: "Z",
                219: "[",
                221: "]",
              },
              _shortcutCommand: function (e, t) {
                var i = null;
                switch (u._keyCodeShortcut[e]) {
                  case "A":
                    i = "selectAll";
                    break;
                  case "B":
                    -1 === l.shortcutsDisable.indexOf("bold") && (i = "STRONG");
                    break;
                  case "S":
                    t &&
                      -1 === l.shortcutsDisable.indexOf("strike") &&
                      (i = "DEL");
                    break;
                  case "U":
                    -1 === l.shortcutsDisable.indexOf("underline") && (i = "U");
                    break;
                  case "I":
                    -1 === l.shortcutsDisable.indexOf("italic") && (i = "EM");
                    break;
                  case "Z":
                    -1 === l.shortcutsDisable.indexOf("undo") &&
                      (i = t ? "redo" : "undo");
                    break;
                  case "Y":
                    -1 === l.shortcutsDisable.indexOf("undo") && (i = "redo");
                    break;
                  case "[":
                    -1 === l.shortcutsDisable.indexOf("indent") &&
                      (i = "outdent");
                    break;
                  case "]":
                    -1 === l.shortcutsDisable.indexOf("indent") &&
                      (i = "indent");
                }
                return !!i && (d.commandHandler(d.commandMap[i], i), !0);
              },
              _applyTagEffects: function () {
                var t = d.getSelectionNode();
                if (t !== d.effectNode) {
                  d.effectNode = t;
                  for (
                    var n,
                      o = d.commandMap,
                      s = this._onButtonsCheck,
                      a = [],
                      c = [],
                      u = d.activePlugins,
                      h = u.length;
                    t.firstChild;

                  )
                    t = t.firstChild;
                  for (var g, p = t; !r.isWysiwygDiv(p) && p; p = p.parentNode)
                    if (1 === p.nodeType && !r.isBreak(p)) {
                      (n = p.nodeName.toUpperCase()), c.push(n);
                      for (var m, f = 0; f < h; f++)
                        (m = u[f]),
                          -1 === a.indexOf(m) &&
                            i[m].active.call(d, p) &&
                            a.push(m);
                      r.isFormatElement(p)
                        ? (-1 === a.indexOf("OUTDENT") &&
                            o.OUTDENT &&
                            (r.isListCell(p) ||
                              (p.style.marginLeft &&
                                0 < r.getNumber(p.style.marginLeft, 0))) &&
                            (a.push("OUTDENT"),
                            o.OUTDENT.removeAttribute("disabled")),
                          -1 === a.indexOf("INDENT") &&
                            o.INDENT &&
                            r.isListCell(p) &&
                            !p.previousElementSibling &&
                            (a.push("INDENT"),
                            o.INDENT.setAttribute("disabled", !0)))
                        : s.test(n) && (a.push(n), r.addClass(o[n], "active"));
                    }
                  for (g in o)
                    -1 < a.indexOf(g) ||
                      !r.hasOwn(o, g) ||
                      (-1 < u.indexOf(g)
                        ? i[g].active.call(d, null)
                        : o.OUTDENT && /^OUTDENT$/i.test(g)
                        ? o.OUTDENT.setAttribute("disabled", !0)
                        : o.INDENT && /^INDENT$/i.test(g)
                        ? o.INDENT.removeAttribute("disabled")
                        : r.removeClass(o[g], "active"));
                  (d._variable.currentNodes = c.reverse()),
                    (d._variable.currentNodesMap = a),
                    l.showPathLabel &&
                      (e.element.navigation.textContent = d._variable.currentNodes.join(
                        " > "
                      ));
                }
              },
              _cancelCaptionEdit: function () {
                this.setAttribute("contenteditable", !1),
                  this.removeEventListener("blur", u._cancelCaptionEdit);
              },
              _buttonsEventHandler: function (e) {
                var t = e.target;
                if (
                  (d._bindControllersOff && e.stopPropagation(),
                  /^(input|textarea|select|option)$/i.test(t.nodeName)
                    ? (d._antiBlur = !1)
                    : e.preventDefault(),
                  r.getParentElement(t, ".ke-submenu"))
                )
                  e.stopPropagation(), (d._notHideToolbar = !0);
                else {
                  for (
                    var i = t.getAttribute("data-command"), n = t.className;
                    !i &&
                    !/ke-menu-list/.test(n) &&
                    !/kothing-editor-common/.test(n);

                  )
                    (i = (t = t.parentNode).getAttribute("data-command")),
                      (n = t.className);
                  (i !== d._submenuName && i !== d._containerName) ||
                    e.stopPropagation();
                }
              },
              onClick_toolbar: function (e) {
                for (
                  var t = e.target,
                    i = t.getAttribute("data-display"),
                    n = t.getAttribute("data-command"),
                    l = t.className;
                  t.parentNode &&
                  !n &&
                  !/ke-menu-list/.test(l) &&
                  !/ke-toolbar/.test(l);

                )
                  (n = (t = t.parentNode).getAttribute("data-command")),
                    (i = t.getAttribute("data-display")),
                    (l = t.className);
                (n || i) &&
                  (t.disabled ||
                    (d.hasFocus || d.nativeFocus(),
                    d._variable.isCodeView || d._editorRange(),
                    d.actionCall(n, i, t)));
              },
              onMouseDown_wysiwyg: function (t) {
                var i, n;
                r.isNonEditable(e.element.wysiwyg) ||
                  (!(i = r.getParentElement(t.target, r.isCell)) ||
                    ((n = d.plugins.table) &&
                      i !== n._fixedCell &&
                      !n._shift &&
                      d.callPlugin(
                        "table",
                        function () {
                          n.onTableCellMultiSelect.call(d, i, !1);
                        },
                        null
                      )),
                  d._isBalloon && u._hideToolbar(),
                  /FIGURE/i.test(t.target.nodeName) && t.preventDefault(),
                  "function" == typeof h.onMouseDown && h.onMouseDown(t, d));
              },
              onClick_wysiwyg: function (t) {
                var i = t.target;
                if (!r.isNonEditable(e.element.wysiwyg)) {
                  var n = d.getFileComponent(i);
                  if (n)
                    return (
                      t.preventDefault(),
                      void d.selectComponent(n.target, n.pluginName)
                    );
                  var l = r.getParentElement(i, "FIGCAPTION");
                  r.isNonEditable(l) &&
                    (t.preventDefault(),
                    l.setAttribute("contenteditable", !0),
                    l.focus(),
                    d._isInline &&
                      !d._inlineToolbarAttr.isShow &&
                      (u._showToolbarInline(),
                      l.addEventListener("blur", function e() {
                        u._hideToolbar(), l.removeEventListener("blur", e);
                      }))),
                    a.setTimeout(d._editorRange.bind(d)),
                    d._editorRange();
                  var o,
                    s,
                    c,
                    g = d.getSelectionNode(),
                    p = r.getFormatElement(g, null),
                    m = r.getRangeFormatElement(g, null);
                  (p && p !== m) || r.isNonEditable(i) || r.isList(m)
                    ? u._applyTagEffects()
                    : ((o = d.getRange()),
                      r.getFormatElement(o.startContainer) ===
                        r.getFormatElement(o.endContainer) &&
                        (r.isList(m)
                          ? ((s = r.createElement("LI")),
                            (c = g.nextElementSibling),
                            s.appendChild(g),
                            m.insertBefore(s, c))
                          : r.isWysiwygDiv(g) ||
                            r.isComponent(g) ||
                            (r.isTable(g) && !r.isCell(g)) ||
                            d._setDefaultFormat(
                              r.isRangeFormatElement(m) ? "DIV" : "P"
                            ),
                        t.preventDefault(),
                        d.focus())),
                    d._isBalloon && a.setTimeout(u._toggleToolbarBalloon),
                    "function" == typeof h.onClick && h.onClick(t, d);
                }
              },
              _balloonDelay: null,
              _showToolbarBalloonDelay: function () {
                u._balloonDelay && a.clearTimeout(u._balloonDelay),
                  (u._balloonDelay = a.setTimeout(
                    function () {
                      a.clearTimeout(this._balloonDelay),
                        (this._balloonDelay = null),
                        this._showToolbarBalloon();
                    }.bind(u),
                    350
                  ));
              },
              _toggleToolbarBalloon: function () {
                d._editorRange();
                var e = d.getRange();
                d._bindControllersOff || (!d._isBalloonAlways && e.collapsed)
                  ? u._hideToolbar()
                  : u._showToolbarBalloon(e);
              },
              _showToolbarBalloon: function (t) {
                if (d._isBalloon) {
                  var i,
                    n,
                    l = t || d.getRange(),
                    o = e.element.toolbar,
                    s = d.getSelection();
                  n =
                    !(!d._isBalloonAlways || !l.collapsed) ||
                    (s.focusNode === s.anchorNode
                      ? s.focusOffset < s.anchorOffset
                      : ((i = r.getListChildNodes(
                          l.commonAncestorContainer,
                          null
                        )),
                        r.getArrayIndex(i, s.focusNode) <
                          r.getArrayIndex(i, s.anchorNode)));
                  var c = l.getClientRects();
                  c = c[n ? 0 : c.length - 1];
                  for (var h = 0, g = 0, p = e.element.topArea; p; )
                    (h += p.scrollLeft),
                      (g += p.scrollTop),
                      (p = p.parentElement);
                  var m,
                    f,
                    v,
                    _ = e.element.topArea.offsetWidth,
                    b = u._getEditorOffsets(null),
                    y = b.top,
                    w = b.left;
                  (o.style.top = "-10000px"),
                    (o.style.visibility = "hidden"),
                    (o.style.display = "block"),
                    c ||
                      ((m = d.getSelectionNode()),
                      r.isFormatElement(m) &&
                        ((f = r.createTextNode(r.zeroWidthSpace)),
                        d.insertNode(f, null, !1),
                        d.setRange(f, 1, f, 1),
                        d._editorRange(),
                        (c = (c = d.getRange().getClientRects())[
                          n ? 0 : c.length - 1
                        ])),
                      c ||
                        ((c = {
                          left: (v = r.getOffset(m, e.element.wysiwygFrame))
                            .left,
                          top: v.top,
                          right: v.left,
                          bottom: v.top + m.offsetHeight,
                          noText: !0,
                        }),
                        (g = h = 0)),
                      (n = !0));
                  var C = a.Math.round(e.element._arrow.offsetWidth / 2),
                    k = o.offsetWidth,
                    x = o.offsetHeight,
                    E = /iframe/i.test(e.element.wysiwygFrame.nodeName)
                      ? e.element.wysiwygFrame.getClientRects()[0]
                      : null;
                  E &&
                    (c = {
                      left: c.left + E.left,
                      top: c.top + E.top,
                      right: c.right + E.right - E.width,
                      bottom: c.bottom + E.bottom - E.height,
                    }),
                    u._setToolbarOffset(n, c, o, w, _, h, g, y, C),
                    (k === o.offsetWidth && x === o.offsetHeight) ||
                      u._setToolbarOffset(n, c, o, w, _, h, g, y, C),
                    (o.style.visibility = "");
                }
              },
              _setToolbarOffset: function (t, i, n, l, o, c, d, h, g) {
                var p = n.offsetWidth,
                  m = i.noText && !t ? 0 : n.offsetHeight,
                  f = (t ? i.left : i.right) - l - p / 2 + c,
                  v = f + p - o,
                  _ =
                    (t ? i.top - m - g : i.bottom + g) - (i.noText ? 0 : h) + d,
                  b = f < 0 ? 1 : v < 0 ? f : f - v - 1 - 1,
                  y = !1,
                  w =
                    _ +
                    (t
                      ? u._getEditorOffsets(null).top
                      : n.offsetHeight - e.element.wysiwyg.offsetHeight);
                !t && 0 < w && u._getPageBottomSpace() < w
                  ? (y = t = !0)
                  : t && s.documentElement.offsetTop > w && (y = !(t = !1)),
                  y &&
                    (_ =
                      (t ? i.top - m - g : i.bottom + g) -
                      (i.noText ? 0 : h) +
                      d),
                  (n.style.left = a.Math.floor(b) + "px"),
                  (n.style.top = a.Math.floor(_) + "px"),
                  t
                    ? (r.removeClass(e.element._arrow, "ke-arrow-up"),
                      r.addClass(e.element._arrow, "ke-arrow-down"),
                      (e.element._arrow.style.top = m + "px"))
                    : (r.removeClass(e.element._arrow, "ke-arrow-down"),
                      r.addClass(e.element._arrow, "ke-arrow-up"),
                      (e.element._arrow.style.top = -g + "px"));
                var C = a.Math.floor(p / 2 + (f - b));
                e.element._arrow.style.left =
                  (C + g > n.offsetWidth ? n.offsetWidth - g : C < g ? g : C) +
                  "px";
              },
              _showToolbarInline: function () {
                var t;
                d._isInline &&
                  ((t = e.element.toolbar),
                  l.toolbarContainer
                    ? (t.style.position = "relative")
                    : (t.style.position = "absolute"),
                  (t.style.visibility = "hidden"),
                  (t.style.display = "block"),
                  (d._inlineToolbarAttr.width = t.style.width = l.toolbarWidth),
                  (d._inlineToolbarAttr.top = t.style.top =
                    (l.toolbarContainer ? 0 : -1 - t.offsetHeight) + "px"),
                  "function" == typeof h.showInline && h.showInline(t, e, d),
                  u.onScroll_window(),
                  (d._inlineToolbarAttr.isShow = !0),
                  (t.style.visibility = ""));
              },
              _hideToolbar: function () {
                d._notHideToolbar ||
                  d._variable.isFullScreen ||
                  ((e.element.toolbar.style.display = "none"),
                  (d._inlineToolbarAttr.isShow = !1));
              },
              onInput_wysiwyg: function (e) {
                d._editorRange();
                var t =
                  (null === e.data ? "" : void 0 === e.data ? " " : e.data) ||
                  "";
                d._charCount(t) || (e.preventDefault(), e.stopPropagation()),
                  d.history.push(!0),
                  "function" == typeof h.onInput && h.onInput(e, d);
              },
              _onShortcutKey: !1,
              onKeyDown_wysiwyg: function (t) {
                var i = t.keyCode,
                  n = t.shiftKey,
                  o =
                    t.ctrlKey || t.metaKey || 91 === i || 92 === i || 224 === i,
                  s = t.altKey;
                if (
                  ((u._IEisComposing = 229 === i),
                  d.submenuOff(),
                  d._isBalloon && u._hideToolbar(),
                  o && u._shortcutCommand(i, n))
                )
                  return (
                    (u._onShortcutKey = !0),
                    t.preventDefault(),
                    t.stopPropagation(),
                    !1
                  );
                u._onShortcutKey && (u._onShortcutKey = !1);
                var c,
                  g = d.getSelectionNode(),
                  p = d.getRange(),
                  m = !p.collapsed || p.startContainer !== p.endContainer,
                  f = d._fileManager.pluginRegExp.test(d.currentControllerName)
                    ? d.currentControllerName
                    : "",
                  v = r.getFormatElement(g, null) || g,
                  _ = r.getRangeFormatElement(v, null),
                  b = p.commonAncestorContainer;
                switch (i) {
                  case 8:
                    if (!m && f) {
                      t.preventDefault(),
                        t.stopPropagation(),
                        d.plugins[f].destroy.call(d);
                      break;
                    }
                    if (m && u._hardDelete()) {
                      t.preventDefault(), t.stopPropagation();
                      break;
                    }
                    if (
                      !r.isFormatElement(v) &&
                      !e.element.wysiwyg.firstElementChild &&
                      !r.isComponent(g)
                    )
                      return (
                        t.preventDefault(),
                        t.stopPropagation(),
                        d._setDefaultFormat("P"),
                        !1
                      );
                    if (
                      !m &&
                      !v.previousElementSibling &&
                      0 === p.startOffset &&
                      !g.previousSibling &&
                      !r.isListCell(v) &&
                      r.isFormatElement(v) &&
                      (!r.isFreeFormatElement(v) ||
                        r.isClosureFreeFormatElement(v))
                    ) {
                      if (r.isClosureRangeFormatElement(v.parentNode))
                        return t.preventDefault(), t.stopPropagation(), !1;
                      if (
                        r.isWysiwygDiv(v.parentNode) &&
                        v.childNodes.length <= 1 &&
                        (!v.firstChild || r.onlyZeroWidthSpace(v.textContent))
                      ) {
                        t.preventDefault(),
                          t.stopPropagation(),
                          (v.innerHTML = "<br>");
                        for (var y = v.attributes; y[0]; )
                          v.removeAttribute(y[0].name);
                        return d.nativeFocus(), !1;
                      }
                    }
                    if (
                      v &&
                      p.startContainer === p.endContainer &&
                      3 === g.nodeType &&
                      !r.isFormatElement(g.parentNode) &&
                      (p.collapsed
                        ? 1 === g.textContent.length
                        : p.endOffset - p.startOffset === g.textContent.length)
                    ) {
                      t.preventDefault();
                      var w = null,
                        C = g.parentNode.previousSibling,
                        k = g.parentNode.nextSibling;
                      C ||
                        (k
                          ? ((C = k), (w = 0))
                          : ((C = r.createElement("BR")), v.appendChild(C))),
                        (g.textContent = ""),
                        r.removeItemAllParents(g, null, v),
                        (w =
                          "number" == typeof w
                            ? w
                            : 3 === C.nodeType
                            ? C.textContent.length
                            : 1),
                        d.setRange(C, w, C, w);
                      break;
                    }
                    if (
                      ((v = r.getFormatElement(p.startContainer, null)),
                      (_ = r.getRangeFormatElement(v, null)) &&
                        v &&
                        !r.isCell(_) &&
                        !/^FIGCAPTION$/i.test(_.nodeName))
                    ) {
                      if (
                        r.isListCell(v) &&
                        r.isList(_) &&
                        (r.isListCell(_.parentNode) ||
                          v.previousElementSibling) &&
                        (g === v ||
                          (3 === g.nodeType &&
                            (!g.previousSibling ||
                              r.isList(g.previousSibling)))) &&
                        (r.getFormatElement(p.startContainer, null) !==
                        r.getFormatElement(p.endContainer, null)
                          ? _.contains(p.startContainer)
                          : 0 === p.startOffset && p.collapsed)
                      ) {
                        if (p.startContainer !== p.endContainer)
                          t.preventDefault(),
                            d.removeNode(),
                            3 === p.startContainer.nodeType &&
                              d.setRange(
                                p.startContainer,
                                p.startContainer.textContent.length,
                                p.startContainer,
                                p.startContainer.textContent.length
                              ),
                            d.history.push(!0);
                        else {
                          var x = v.previousElementSibling || _.parentNode;
                          if (r.isListCell(x)) {
                            t.preventDefault();
                            var E = x;
                            if (
                              !x.contains(v) &&
                              r.isListCell(E) &&
                              r.isList(E.lastElementChild)
                            ) {
                              for (
                                E = E.lastElementChild.lastElementChild;
                                r.isListCell(E) && r.isList(E.lastElementChild);

                              )
                                E =
                                  E.lastElementChild &&
                                  E.lastElementChild.lastElementChild;
                              x = E;
                            }
                            var S =
                              x === _.parentNode
                                ? _.previousSibling
                                : x.lastChild;
                            S ||
                              ((S = r.createTextNode(r.zeroWidthSpace)),
                              _.parentNode.insertBefore(
                                S,
                                _.parentNode.firstChild
                              ));
                            for (
                              var N =
                                  3 === S.nodeType ? S.textContent.length : 1,
                                T = v.childNodes,
                                L = S,
                                z = T[0];
                              (z = T[0]);

                            )
                              x.insertBefore(z, L.nextSibling), (L = z);
                            r.removeItem(v),
                              0 === _.children.length && r.removeItem(_),
                              d.setRange(S, N, S, N),
                              d.history.push(!0);
                          }
                        }
                        break;
                      }
                      if (!m && 0 === p.startOffset) {
                        for (
                          var B = !0, A = b;
                          A && A !== _ && !r.isWysiwygDiv(A);

                        ) {
                          if (
                            A.previousSibling &&
                            (1 === A.previousSibling.nodeType ||
                              !r.onlyZeroWidthSpace(
                                A.previousSibling.textContent.trim()
                              ))
                          ) {
                            B = !1;
                            break;
                          }
                          A = A.parentNode;
                        }
                        if (B && _.parentNode) {
                          t.preventDefault(),
                            d.detachRangeFormatElement(
                              _,
                              r.isListCell(v) ? [v] : null,
                              null,
                              !1,
                              !1
                            ),
                            d.history.push(!0);
                          break;
                        }
                      }
                    }
                    if (
                      !m &&
                      (0 === p.startOffset ||
                        (g === v && v.childNodes[p.startOffset]))
                    ) {
                      var M = g === v ? v.childNodes[p.startOffset] : g,
                        H =
                          (3 === b.nodeType || r.isBreak(b)) &&
                          !b.previousSibling &&
                          0 === p.startOffset;
                      if (
                        !M.previousSibling &&
                        (r.isComponent(b.previousSibling) ||
                          (H && r.isComponent(v.previousSibling)))
                      ) {
                        var I = d.getFileComponent(v.previousSibling);
                        I &&
                          (t.preventDefault(),
                          t.stopPropagation(),
                          0 === v.textContent.length && r.removeItem(v),
                          d.selectComponent(I.target, I.pluginName));
                        break;
                      }
                      if (r.isNonEditable(M.previousSibling)) {
                        t.preventDefault(),
                          t.stopPropagation(),
                          r.removeItem(M.previousSibling);
                        break;
                      }
                    }
                    break;
                  case 46:
                    if (f) {
                      t.preventDefault(),
                        t.stopPropagation(),
                        d.plugins[f].destroy.call(d);
                      break;
                    }
                    if (m && u._hardDelete()) {
                      t.preventDefault(), t.stopPropagation();
                      break;
                    }
                    if (
                      (r.isFormatElement(g) ||
                        null === g.nextSibling ||
                        (r.onlyZeroWidthSpace(g.nextSibling) &&
                          null === g.nextSibling.nextSibling)) &&
                      p.startOffset === g.textContent.length
                    ) {
                      var F = v.nextElementSibling;
                      if (!F) {
                        t.preventDefault();
                        break;
                      }
                      if (r.isComponent(F)) {
                        if (
                          (t.preventDefault(),
                          r.onlyZeroWidthSpace(v) &&
                            (r.removeItem(v), r.isTable(F)))
                        ) {
                          var D =
                            (D = r.getChildElement(F, r.isCell, !1))
                              .firstElementChild || D;
                          d.setRange(D, 0, D, 0);
                          break;
                        }
                        var R = d.getFileComponent(F);
                        R &&
                          (t.stopPropagation(),
                          d.selectComponent(R.target, R.pluginName));
                        break;
                      }
                    }
                    if (
                      !m &&
                      (d.isEdgePoint(p.endContainer, p.endOffset) ||
                        (g === v && v.childNodes[p.startOffset]))
                    ) {
                      var O = g === v ? v.childNodes[p.startOffset] : g;
                      if (r.isNonEditable(O.nextSibling)) {
                        t.preventDefault(),
                          t.stopPropagation(),
                          r.removeItem(O.nextSibling);
                        break;
                      }
                    }
                    if (
                      ((v = r.getFormatElement(p.startContainer, null)),
                      (_ = r.getRangeFormatElement(v, null)),
                      r.isListCell(v) &&
                        r.isList(_) &&
                        (g === v ||
                          (3 === g.nodeType &&
                            (!g.nextSibling || r.isList(g.nextSibling)) &&
                            (r.getFormatElement(p.startContainer, null) !==
                            r.getFormatElement(p.endContainer, null)
                              ? _.contains(p.endContainer)
                              : p.endOffset === g.textContent.length &&
                                p.collapsed))))
                    ) {
                      p.startContainer !== p.endContainer && d.removeNode();
                      var P = r.getArrayItem(v.children, r.isList, !1);
                      if (
                        (P =
                          P ||
                          v.nextElementSibling ||
                          _.parentNode.nextElementSibling) &&
                        (r.isList(P) ||
                          r.getArrayItem(P.children, r.isList, !1))
                      ) {
                        if ((t.preventDefault(), r.isList(P))) {
                          for (
                            var V,
                              W = P.firstElementChild,
                              U = (V = W.childNodes)[0];
                            V[0];

                          )
                            v.insertBefore(V[0], P);
                          r.removeItem(W);
                        } else {
                          for (U = P.firstChild, V = P.childNodes; V[0]; )
                            v.appendChild(V[0]);
                          r.removeItem(P);
                        }
                        d.setRange(U, 0, U, 0), d.history.push(!0);
                      }
                      break;
                    }
                    break;
                  case 9:
                    if (f || l.tabDisable) break;
                    if ((t.preventDefault(), o || s || r.isWysiwygDiv(g)))
                      break;
                    g = d.getSelectionNode();
                    for (
                      var q,
                        Z =
                          !p.collapsed ||
                          d.isEdgePoint(p.startContainer, p.startOffset),
                        $ = d.getSelectedElements(null),
                        Y = [],
                        K = [],
                        X = r.isListCell($[0]),
                        j = r.isListCell($[$.length - 1]),
                        G = {
                          sc: p.startContainer,
                          so: p.startOffset,
                          ec: p.endContainer,
                          eo: p.endOffset,
                        },
                        J = 0,
                        Q = $.length;
                      J < Q;
                      J++
                    )
                      if (((q = $[J]), r.isListCell(q))) {
                        if (!q.previousElementSibling && !n) continue;
                        Y.push(q);
                      } else K.push(q);
                    if (0 < Y.length && Z && d.plugins.list)
                      G = d.plugins.list.editInsideList.call(d, n, Y);
                    else {
                      var ee = r.getParentElement(g, r.isCell);
                      if (ee && Z) {
                        var te = r.getParentElement(ee, "table"),
                          ie = r.getListChildren(te, r.isCell),
                          ne = n ? r.prevIdx(ie, ee) : r.nextIdx(ie, ee);
                        ne !== ie.length || n || (ne = 0),
                          -1 === ne && n && (ne = ie.length - 1);
                        var le = ie[ne];
                        if (!le) break;
                        (le = le.firstElementChild || le),
                          d.setRange(le, 0, le, 0);
                        break;
                      }
                      (K = K.concat(Y)), (X = j = null);
                    }
                    if (0 < K.length)
                      if (n) {
                        for (var oe, se = K.length - 1, ae = 0; ae <= se; ae++)
                          for (
                            var re, ce = 0, de = (oe = K[ae].childNodes).length;
                            ce < de && (re = oe[ce]);
                            ce++
                          )
                            if (!r.onlyZeroWidthSpace(re)) {
                              /^\s{1,4}$/.test(re.textContent)
                                ? r.removeItem(re)
                                : /^\s{1,4}/.test(re.textContent) &&
                                  (re.textContent = re.textContent.replace(
                                    /^\s{1,4}/,
                                    ""
                                  ));
                              break;
                            }
                        var ue = r.getChildElement(K[0], "text", !1),
                          he = r.getChildElement(K[se], "text", !0);
                        !X && ue && ((G.sc = ue), (G.so = 0)),
                          !j &&
                            he &&
                            ((G.ec = he), (G.eo = he.textContent.length));
                      } else {
                        var ge = r.createTextNode(
                          new a.Array(d._variable.tabSize + 1).join("\xa0")
                        );
                        if (1 === K.length) {
                          var pe = d.insertNode(ge, null, !0);
                          if (!pe) return !1;
                          X || ((G.sc = ge), (G.so = pe.endOffset)),
                            j || ((G.ec = ge), (G.eo = pe.endOffset));
                        } else {
                          for (
                            var me, fe = K.length - 1, ve = 0;
                            ve <= fe;
                            ve++
                          )
                            (me = K[ve].firstChild) &&
                              (r.isBreak(me)
                                ? K[ve].insertBefore(ge.cloneNode(!1), me)
                                : (me.textContent =
                                    ge.textContent + me.textContent));
                          var _e = r.getChildElement(K[0], "text", !1),
                            be = r.getChildElement(K[fe], "text", !0);
                          !X && _e && ((G.sc = _e), (G.so = 0)),
                            !j &&
                              be &&
                              ((G.ec = be), (G.eo = be.textContent.length));
                        }
                      }
                    d.setRange(G.sc, G.so, G.ec, G.eo), d.history.push(!1);
                    break;
                  case 13:
                    var ye,
                      we,
                      Ce,
                      ke,
                      xe = r.getFreeFormatElement(g, null);
                    if (d._charTypeHTML) {
                      var Ee =
                        (!n && xe) || n
                          ? "<br>"
                          : "<" + v.nodeName + "><br></" + v.nodeName + ">";
                      if (!d.checkCharCount(Ee, "byte-html"))
                        return t.preventDefault(), !1;
                    }
                    if (!n && xe) {
                      t.preventDefault();
                      var Se,
                        Ne,
                        Te,
                        Le,
                        ze,
                        Be,
                        Ae = g === xe,
                        Me = d.getSelection(),
                        He = g.childNodes,
                        Ie = Me.focusOffset,
                        Fe = g.previousElementSibling,
                        De = g.nextSibling;
                      if (
                        !r.isClosureFreeFormatElement(xe) &&
                        He &&
                        ((Ae &&
                          p.collapsed &&
                          He.length - 1 <= Ie + 1 &&
                          r.isBreak(He[Ie]) &&
                          (!He[Ie + 1] ||
                            ((!He[Ie + 2] ||
                              r.onlyZeroWidthSpace(He[Ie + 2].textContent)) &&
                              3 === He[Ie + 1].nodeType &&
                              r.onlyZeroWidthSpace(He[Ie + 1].textContent))) &&
                          0 < Ie &&
                          r.isBreak(He[Ie - 1])) ||
                          (!Ae &&
                            r.onlyZeroWidthSpace(g.textContent) &&
                            r.isBreak(Fe) &&
                            (r.isBreak(Fe.previousSibling) ||
                              !r.onlyZeroWidthSpace(
                                Fe.previousSibling.textContent
                              )) &&
                            (!De ||
                              (!r.isBreak(De) &&
                                r.onlyZeroWidthSpace(De.textContent)))))
                      ) {
                        Ae ? r.removeItem(He[Ie - 1]) : r.removeItem(g);
                        var Re = d.appendFormatTag(
                          xe,
                          r.isFormatElement(xe.nextElementSibling)
                            ? xe.nextElementSibling
                            : null
                        );
                        r.copyFormatAttributes(Re, xe),
                          d.setRange(Re, 1, Re, 1);
                        break;
                      }
                      Ae
                        ? (h.insertHTML(
                            p.collapsed &&
                              r.isBreak(
                                p.startContainer.childNodes[p.startOffset - 1]
                              )
                              ? "<br>"
                              : "<br><br>",
                            !0,
                            !1
                          ),
                          (Se = Me.focusNode),
                          (Ne = Me.focusOffset),
                          xe === Se &&
                            (Se = Se.childNodes[1 < Ne - Ie ? Ne - 1 : Ne]),
                          d.setRange(Se, 1, Se, 1))
                        : ((Te = Me.focusNode.nextSibling),
                          (Le = r.createElement("BR")),
                          d.insertNode(Le, null, !1),
                          (ze = Le.previousSibling),
                          (Be = Le.nextSibling),
                          r.isBreak(Te) ||
                          r.isBreak(ze) ||
                          (Be && !r.onlyZeroWidthSpace(Be))
                            ? d.setRange(Be, 0, Be, 0)
                            : (Le.parentNode.insertBefore(Le.cloneNode(!1), Le),
                              d.setRange(Le, 1, Le, 1))),
                        (u._onShortcutKey = !0);
                      break;
                    }
                    if (m) break;
                    if (
                      _ &&
                      v &&
                      !r.isCell(_) &&
                      !/^FIGCAPTION$/i.test(_.nodeName)
                    ) {
                      var Oe = d.getRange();
                      if (
                        d.isEdgePoint(Oe.endContainer, Oe.endOffset) &&
                        r.isList(g.nextSibling)
                      ) {
                        t.preventDefault();
                        var Pe = r.createElement("LI"),
                          Ve = r.createElement("BR");
                        Pe.appendChild(Ve),
                          v.parentNode.insertBefore(Pe, v.nextElementSibling),
                          Pe.appendChild(g.nextSibling),
                          d.setRange(Ve, 1, Ve, 1);
                        break;
                      }
                      if (
                        (3 !== Oe.commonAncestorContainer.nodeType ||
                          !Oe.commonAncestorContainer.nextElementSibling) &&
                        r.onlyZeroWidthSpace(v.innerText.trim())
                      ) {
                        t.preventDefault();
                        var We,
                          Ue,
                          qe,
                          Ze = null;
                        r.isListCell(_.parentNode)
                          ? ((_ = v.parentNode.parentNode.parentNode),
                            (Ze = r.splitElement(
                              v,
                              null,
                              r.getElementDepth(v) - 2
                            )) ||
                              (((We = r.createElement("LI")).innerHTML =
                                "<br>"),
                              _.insertBefore(We, Ze),
                              (Ze = We)))
                          : ((Ue = r.isCell(_.parentNode)
                              ? "DIV"
                              : r.isList(_.parentNode)
                              ? "LI"
                              : r.isFormatElement(_.nextElementSibling)
                              ? _.nextElementSibling.nodeName
                              : r.isFormatElement(_.previousElementSibling)
                              ? _.previousElementSibling.nodeName
                              : "P"),
                            (Ze = r.createElement(Ue)),
                            (qe = d.detachRangeFormatElement(
                              _,
                              [v],
                              null,
                              !0,
                              !0
                            )).cc.insertBefore(Ze, qe.ec)),
                          (Ze.innerHTML = "<br>"),
                          r.copyFormatAttributes(Ze, v),
                          r.removeItemAllParents(v, null, null),
                          d.setRange(Ze, 1, Ze, 1);
                        break;
                      }
                    }
                    _ &&
                      r.getParentElement(_, "FIGCAPTION") &&
                      r.getParentElement(_, r.isList) &&
                      (t.preventDefault(),
                      (v = d.appendFormatTag(v, null)),
                      d.setRange(v, 0, v, 0)),
                      f &&
                        (t.preventDefault(),
                        t.stopPropagation(),
                        (Ce =
                          (we = (ye = e[f])._container)
                            .previousElementSibling || we.nextElementSibling),
                        (ke = null),
                        r.isListCell(we.parentNode)
                          ? (ke = r.createElement("BR"))
                          : ((ke = r.createElement(
                              r.isFormatElement(Ce) ? Ce.nodeName : "P"
                            )).innerHTML = "<br>"),
                        we.parentNode.insertBefore(ke, we),
                        d.callPlugin(
                          f,
                          function () {
                            d.selectComponent(ye._element, f);
                          },
                          null
                        ));
                    break;
                  case 27:
                    if (f)
                      return (
                        t.preventDefault(),
                        t.stopPropagation(),
                        d.controllersOff(),
                        !1
                      );
                }
                if (n && /16/.test(i)) {
                  t.preventDefault(), t.stopPropagation();
                  var $e = d.plugins.table;
                  if ($e && !$e._shift && !$e._ref) {
                    var Ye = r.getParentElement(v, r.isCell);
                    if (Ye)
                      return void $e.onTableCellMultiSelect.call(d, Ye, !0);
                  }
                }
                o ||
                  s ||
                  m ||
                  u._nonTextKeyCode.test(i) ||
                  !p.collapsed ||
                  p.startContainer !== p.endContainer ||
                  !r.isBreak(p.commonAncestorContainer) ||
                  ((c = r.createTextNode(r.zeroWidthSpace)),
                  d.insertNode(c, null, !1),
                  d.setRange(c, 1, c, 1)),
                  "function" == typeof h.onKeyDown && h.onKeyDown(t, d);
              },
              onKeyUp_wysiwyg: function (e) {
                if (!u._onShortcutKey) {
                  d._editorRange();
                  var t = d.getRange(),
                    i = e.keyCode,
                    n =
                      e.ctrlKey ||
                      e.metaKey ||
                      91 === i ||
                      92 === i ||
                      224 === i,
                    l = e.altKey,
                    o = d.getSelectionNode();
                  if (
                    d._isBalloon &&
                    ((d._isBalloonAlways && 27 !== i) || !t.collapsed)
                  ) {
                    if (!d._isBalloonAlways)
                      return void u._showToolbarBalloon();
                    27 !== i && u._showToolbarBalloonDelay();
                  }
                  if (
                    8 === i &&
                    r.isWysiwygDiv(o) &&
                    "" === o.textContent &&
                    0 === o.children.length
                  ) {
                    e.preventDefault(), e.stopPropagation(), (o.innerHTML = "");
                    var s = r.createElement(
                      r.isFormatElement(d._variable.currentNodes[0])
                        ? d._variable.currentNodes[0]
                        : "P"
                    );
                    return (
                      (s.innerHTML = "<br>"),
                      o.appendChild(s),
                      d.setRange(s, 0, s, 0),
                      u._applyTagEffects(),
                      void d.history.push(!1)
                    );
                  }
                  var a,
                    c,
                    g,
                    p = r.getFormatElement(o, null),
                    m = r.getRangeFormatElement(o, null);
                  ((p || !t.collapsed) && p !== m) ||
                    r.isComponent(o) ||
                    r.isList(o) ||
                    (d._setDefaultFormat(
                      r.isRangeFormatElement(m) ? "DIV" : "P"
                    ),
                    (o = d.getSelectionNode())),
                    u._directionKeyCode.test(i) && u._applyTagEffects(),
                    n ||
                      l ||
                      u._nonTextKeyCode.test(i) ||
                      3 !== o.nodeType ||
                      !r.zeroWidthRegExp.test(o.textContent) ||
                      (void 0 !== e.isComposing
                        ? e.isComposing
                        : u._IEisComposing) ||
                      (t.startOffset,
                      (g = t.endOffset),
                      (a = (
                        o.textContent
                          .substring(0, g)
                          .match(u._frontZeroWidthReg) || ""
                      ).length),
                      (c = t.startOffset - a),
                      (g = t.endOffset - a),
                      (o.textContent = o.textContent.replace(
                        r.zeroWidthRegExp,
                        ""
                      )),
                      d.setRange(o, c < 0 ? 0 : c, o, g < 0 ? 0 : g)),
                    d._charCount(""),
                    d.history.push(!0),
                    "function" == typeof h.onKeyUp && h.onKeyUp(e, d);
                }
              },
              onScroll_wysiwyg: function (e) {
                d.controllersOff(),
                  (d._lineBreaker.style.display = "none"),
                  d._isBalloon && u._hideToolbar(),
                  "function" == typeof h.onScroll && h.onScroll(e, d);
              },
              onFocus_wysiwyg: function (e) {
                d._antiBlur ||
                  ((d.hasFocus = !0),
                  d._isInline && u._showToolbarInline(),
                  "function" == typeof h.onFocus && h.onFocus(e, d));
              },
              onBlur_wysiwyg: function (t) {
                if (!d._antiBlur) {
                  (d.hasFocus = !1),
                    d.controllersOff(),
                    (d._isInline || d._isBalloon) && u._hideToolbar(),
                    "function" == typeof h.onBlur && h.onBlur(t, d);
                  var n,
                    o = d.commandMap,
                    s = d.activePlugins;
                  for (n in o)
                    r.hasOwn(o, n) &&
                      (-1 < s.indexOf(n)
                        ? i[n].active.call(d, null)
                        : o.OUTDENT && /^OUTDENT$/i.test(n)
                        ? o.OUTDENT.setAttribute("disabled", !0)
                        : o.INDENT && /^INDENT$/i.test(n)
                        ? o.INDENT.removeAttribute("disabled")
                        : r.removeClass(o[n], "active"));
                  (d._variable.currentNodes = []),
                    (d._variable.currentNodesMap = []),
                    l.showPathLabel && (e.element.navigation.textContent = "");
                }
              },
              onMouseDown_resizingBar: function (t) {
                t.stopPropagation(),
                  (d._variable.resizeClientY = t.clientY),
                  (e.element.resizeBackground.style.display = "block"),
                  s.addEventListener("mousemove", u._resize_editor),
                  s.addEventListener("mouseup", function t() {
                    (e.element.resizeBackground.style.display = "none"),
                      s.removeEventListener("mousemove", u._resize_editor),
                      s.removeEventListener("mouseup", t);
                  });
              },
              _resize_editor: function (t) {
                var i =
                  e.element.editorArea.offsetHeight +
                  (t.clientY - d._variable.resizeClientY);
                (e.element.wysiwygFrame.style.height = e.element.code.style.height =
                  (i < d._variable.minResizingSize
                    ? d._variable.minResizingSize
                    : i) + "px"),
                  (d._variable.resizeClientY = t.clientY);
              },
              onResize_window: function () {
                d.controllersOff();
                var t = u._responsiveButtonSize;
                if (t) {
                  for (
                    var i = a.innerWidth, n = "default", l = 1, o = t.length;
                    l < o;
                    l++
                  )
                    i < t[l] && (n = t[l] + "");
                  u._responsiveCurrentSize !== n &&
                    ((u._responsiveCurrentSize = n),
                    h.setToolbarButtons(u._responsiveButtons[n]));
                }
                if (0 !== e.element.toolbar.offsetWidth) {
                  if (
                    (e.fileBrowser &&
                      "block" === e.fileBrowser.area.style.display &&
                      (e.fileBrowser.body.style.maxHeight =
                        a.innerHeight -
                        e.fileBrowser.header.offsetHeight -
                        50 +
                        "px"),
                    d.submenuActiveButton &&
                      d.submenu &&
                      d._setMenuPosition(d.submenuActiveButton, d.submenu),
                    d._variable.isFullScreen)
                  )
                    return (
                      (d._variable.innerHeight_fullScreen +=
                        a.innerHeight -
                        e.element.toolbar.offsetHeight -
                        d._variable.innerHeight_fullScreen),
                      void (e.element.editorArea.style.height =
                        d._variable.innerHeight_fullScreen + "px")
                    );
                  d._variable.isCodeView && d._isInline
                    ? u._showToolbarInline()
                    : (d._iframeAutoHeight(),
                      d._sticky &&
                        ((e.element.toolbar.style.width =
                          e.element.topArea.offsetWidth - 2 + "px"),
                        u.onScroll_window()));
                }
              },
              onScroll_window: function () {
                var t, i, n, o;
                d._variable.isFullScreen ||
                  0 === e.element.toolbar.offsetWidth ||
                  l.stickyToolbar < 0 ||
                  ((i = (t = e.element).editorArea.offsetHeight),
                  (n =
                    (this.scrollY || s.documentElement.scrollTop) +
                    l.stickyToolbar) <
                  (o =
                    u._getEditorOffsets(l.toolbarContainer).top -
                    (d._isInline ? t.toolbar.offsetHeight : 0))
                    ? u._offStickyToolbar()
                    : n + d._variable.minResizingSize >= i + o
                    ? (d._sticky || u._onStickyToolbar(),
                      (t.toolbar.style.top =
                        i +
                        o +
                        l.stickyToolbar -
                        n -
                        d._variable.minResizingSize +
                        "px"))
                    : o <= n && u._onStickyToolbar());
              },
              _getEditorOffsets: function (t) {
                for (var i = t || e.element.topArea, n = 0, l = 0, o = 0; i; )
                  (n += i.offsetTop),
                    (l += i.offsetLeft),
                    (o += i.scrollTop),
                    (i = i.offsetParent);
                return { top: n, left: l, scroll: o };
              },
              _getPageBottomSpace: function () {
                return (
                  s.documentElement.scrollHeight -
                  (u._getEditorOffsets(null).top +
                    e.element.topArea.offsetHeight)
                );
              },
              _onStickyToolbar: function () {
                var t = e.element;
                d._isInline ||
                  l.toolbarContainer ||
                  ((t._stickyDummy.style.height =
                    t.toolbar.offsetHeight + "px"),
                  (t._stickyDummy.style.display = "block")),
                  (t.toolbar.style.top = l.stickyToolbar + "px"),
                  (t.toolbar.style.width = d._isInline
                    ? d._inlineToolbarAttr.width
                    : t.toolbar.offsetWidth + "px"),
                  r.addClass(t.toolbar, "ke-toolbar-sticky"),
                  (d._sticky = !0);
              },
              _offStickyToolbar: function () {
                var t = e.element;
                (t._stickyDummy.style.display = "none"),
                  (t.toolbar.style.top = d._isInline
                    ? d._inlineToolbarAttr.top
                    : ""),
                  (t.toolbar.style.width = d._isInline
                    ? d._inlineToolbarAttr.width
                    : ""),
                  (t.editorArea.style.marginTop = ""),
                  r.removeClass(t.toolbar, "ke-toolbar-sticky"),
                  (d._sticky = !1);
              },
              _codeViewAutoHeight: function () {
                e.element.code.style.height =
                  e.element.code.scrollHeight + "px";
              },
              _hardDelete: function () {
                var e = d.getRange(),
                  t = e.startContainer,
                  i = e.endContainer,
                  n = r.getRangeFormatElement(t),
                  l = r.getRangeFormatElement(i),
                  o = r.isCell(n),
                  s = r.isCell(l);
                if (
                  ((o &&
                    !n.previousElementSibling &&
                    !n.parentElement.previousElementSibling) ||
                    (s &&
                      !l.nextElementSibling &&
                      !l.parentElement.nextElementSibling)) &&
                  n !== l
                )
                  if (o) {
                    if (s)
                      return (
                        r.removeItem(r.getParentElement(n, r.isComponent)),
                        d.nativeFocus(),
                        !0
                      );
                    r.removeItem(r.getParentElement(n, r.isComponent));
                  } else r.removeItem(r.getParentElement(l, r.isComponent));
                var a =
                    1 === t.nodeType
                      ? r.getParentElement(t, ".ke-component")
                      : null,
                  c =
                    1 === i.nodeType
                      ? r.getParentElement(i, ".ke-component")
                      : null;
                return a && r.removeItem(a), c && r.removeItem(c), !1;
              },
              onPaste_wysiwyg: function (e) {
                var t = r.isIE ? a.clipboardData : e.clipboardData;
                return !t || u._dataTransferAction("paste", e, t);
              },
              _setClipboardComponent: function (e, t, i) {
                e.preventDefault(),
                  e.stopPropagation(),
                  i.setData("text/html", t.component.outerHTML);
              },
              onCopy_wysiwyg: function (e) {
                var t = r.isIE ? a.clipboardData : e.clipboardData;
                if ("function" == typeof h.onCopy && !h.onCopy(e, t, d))
                  return e.preventDefault(), e.stopPropagation(), !1;
                var i = d.currentFileComponentInfo;
                i &&
                  !r.isIE &&
                  (u._setClipboardComponent(e, i, t),
                  r.addClass(i.component, "ke-component-copy"),
                  a.setTimeout(function () {
                    r.removeClass(i.component, "ke-component-copy");
                  }, 150));
              },
              onCut_wysiwyg: function (e) {
                var t = r.isIE ? a.clipboardData : e.clipboardData;
                if ("function" == typeof h.onCut && !h.onCut(e, t, d))
                  return e.preventDefault(), e.stopPropagation(), !1;
                var i = d.currentFileComponentInfo;
                i &&
                  !r.isIE &&
                  (u._setClipboardComponent(e, i, t),
                  r.removeItem(i.component),
                  d.controllersOff()),
                  a.setTimeout(function () {
                    d.history.push(!1);
                  });
              },
              onDrop_wysiwyg: function (e) {
                var t = e.dataTransfer;
                return (
                  !t ||
                  (r.isIE
                    ? (e.preventDefault(), e.stopPropagation(), !1)
                    : (d.removeNode(),
                      u._setDropLocationSelection(e),
                      u._dataTransferAction("drop", e, t)))
                );
              },
              _setDropLocationSelection: function (e) {
                var t, i;
                e.rangeParent
                  ? d.setRange(
                      e.rangeParent,
                      e.rangeOffset,
                      e.rangeParent,
                      e.rangeOffset
                    )
                  : d._wd.caretRangeFromPoint
                  ? ((t = d._wd.caretRangeFromPoint(e.clientX, e.clientY)),
                    d.setRange(
                      t.startContainer,
                      t.startOffset,
                      t.endContainer,
                      t.endOffset
                    ))
                  : ((i = d.getRange()),
                    d.setRange(
                      i.startContainer,
                      i.startOffset,
                      i.endContainer,
                      i.endOffset
                    ));
              },
              _dataTransferAction: function (t, i, n) {
                var l, o;
                if (r.isIE) {
                  l = n.getData("Text");
                  var s = d.getRange(),
                    c = r.createElement("DIV"),
                    h = {
                      sc: s.startContainer,
                      so: s.startOffset,
                      ec: s.endContainer,
                      eo: s.endOffset,
                    };
                  return (
                    c.setAttribute("contenteditable", !0),
                    (c.style.cssText =
                      "position:absolute; top:0; left:0; width:1px; height:1px; overflow:hidden;"),
                    e.element.relative.appendChild(c),
                    c.focus(),
                    a.setTimeout(function () {
                      (o = c.innerHTML),
                        r.removeItem(c),
                        d.setRange(h.sc, h.so, h.ec, h.eo),
                        u._setClipboardData(t, i, l, o, n);
                    }),
                    !0
                  );
                }
                if (
                  ((l = n.getData("text/plain")),
                  (o = n.getData("text/html")),
                  !1 === u._setClipboardData(t, i, l, o, n))
                )
                  return i.preventDefault(), i.stopPropagation(), !1;
              },
              _setClipboardData: function (e, t, i, n, l) {
                (i =
                  /class=["']*Mso(Normal|List)/i.test(n) ||
                  /content=["']*Word.Document/i.test(n) ||
                  /content=["']*OneNote.File/i.test(n)
                    ? ((n = n.replace(/\n/g, " ")), i.replace(/\n/g, " "))
                    : i.replace(/\n/g, "")),
                  (n = d.cleanHTML(n, d.pasteTagsWhitelistRegExp));
                var o = d._charCount(d._charTypeHTML ? n : i);
                if (
                  "paste" === e &&
                  "function" == typeof h.onPaste &&
                  !h.onPaste(t, n, o, d)
                )
                  return !1;
                if (
                  "drop" === e &&
                  "function" == typeof h.onDrop &&
                  !h.onDrop(t, l, d)
                )
                  return !1;
                var s = l.files;
                return 0 < s.length
                  ? (/^image/.test(s[0].type) &&
                      d.plugins.image &&
                      h.insertImage(s),
                    !1)
                  : !!o && (n ? (h.insertHTML(n, !0, !1), !1) : void 0);
              },
              onMouseMove_wysiwyg: function (t) {
                if (!d.isDisabled) {
                  var i = r.getParentElement(t.target, r.isComponent),
                    n = d._lineBreaker.style;
                  if (i && !d.currentControllerName) {
                    for (
                      var o = 0, s = e.element.wysiwyg;
                      (o += s.scrollTop),
                        (s = s.parentElement) &&
                          !/^(BODY|HTML)$/i.test(s.nodeName);

                    );
                    var a = e.element.wysiwyg.scrollTop,
                      c = u._getEditorOffsets(null),
                      h = r.getOffset(i, e.element.wysiwygFrame).top + a,
                      g =
                        t.pageY +
                        o +
                        (l.iframe && !l.toolbarContainer
                          ? e.element.toolbar.offsetHeight
                          : 0),
                      p = h + (l.iframe ? o : c.top),
                      m = r.isListCell(i.parentNode),
                      f = "",
                      v = "";
                    if (
                      (m
                        ? !i.previousSibling
                        : !r.isFormatElement(i.previousElementSibling)) &&
                      g < p + 20
                    )
                      (v = h), (f = "t");
                    else {
                      if (
                        (m
                          ? i.nextSibling
                          : r.isFormatElement(i.nextElementSibling)) ||
                        !(g > p + i.offsetHeight - 20)
                      )
                        return void (n.display = "none");
                      (v = h + i.offsetHeight), (f = "b");
                    }
                    (d._variable._lineBreakComp = i),
                      (d._variable._lineBreakDir = f),
                      (n.top = v - a + "px"),
                      (d._lineBreakerButton.style.left =
                        r.getOffset(i).left + i.offsetWidth / 2 - 15 + "px"),
                      (n.display = "block");
                  } else "none" !== n.display && (n.display = "none");
                }
              },
              _onMouseDown_lineBreak: function (e) {
                e.preventDefault();
              },
              _onLineBreak: function (e) {
                e.preventDefault();
                var t,
                  i = d._variable._lineBreakComp,
                  n = this ? this : d._variable._lineBreakDir,
                  l = r.isListCell(i.parentNode),
                  o = r.createElement(
                    l ? "BR" : r.isCell(i.parentNode) ? "DIV" : "P"
                  );
                l || (o.innerHTML = "<br>"),
                  (d._charTypeHTML &&
                    !d.checkCharCount(o.outerHTML, "byte-html")) ||
                    (i.parentNode.insertBefore(
                      o,
                      "t" === n ? i : i.nextSibling
                    ),
                    (d._lineBreaker.style.display = "none"),
                    (d._variable._lineBreakComp = null),
                    (t = l ? o : o.firstChild),
                    d.setRange(t, 1, t, 1),
                    d.history.push(!1));
              },
              _addEvent: function () {
                var t = l.iframe ? d._ww : e.element.wysiwyg;
                e.element.toolbar.addEventListener(
                  "mousedown",
                  u._buttonsEventHandler,
                  !1
                ),
                  e.element._menuTray.addEventListener(
                    "mousedown",
                    u._buttonsEventHandler,
                    !1
                  ),
                  e.element.toolbar.addEventListener(
                    "click",
                    u.onClick_toolbar,
                    !1
                  ),
                  t.addEventListener("mousedown", u.onMouseDown_wysiwyg, !1),
                  t.addEventListener("click", u.onClick_wysiwyg, !1),
                  t.addEventListener(
                    r.isIE ? "textinput" : "input",
                    u.onInput_wysiwyg,
                    !1
                  ),
                  t.addEventListener("keydown", u.onKeyDown_wysiwyg, !1),
                  t.addEventListener("keyup", u.onKeyUp_wysiwyg, !1),
                  t.addEventListener("paste", u.onPaste_wysiwyg, !1),
                  t.addEventListener("copy", u.onCopy_wysiwyg, !1),
                  t.addEventListener("cut", u.onCut_wysiwyg, !1),
                  t.addEventListener("drop", u.onDrop_wysiwyg, !1),
                  t.addEventListener("scroll", u.onScroll_wysiwyg, !1),
                  t.addEventListener("focus", u.onFocus_wysiwyg, !1),
                  t.addEventListener("blur", u.onBlur_wysiwyg, !1),
                  (u._lineBreakerBind = {
                    a: u._onLineBreak.bind(""),
                    t: u._onLineBreak.bind("t"),
                    b: u._onLineBreak.bind("b"),
                  }),
                  t.addEventListener("mousemove", u.onMouseMove_wysiwyg, !1),
                  d._lineBreakerButton.addEventListener(
                    "mousedown",
                    u._onMouseDown_lineBreak,
                    !1
                  ),
                  d._lineBreakerButton.addEventListener(
                    "click",
                    u._lineBreakerBind.a,
                    !1
                  ),
                  e.element.lineBreaker_t.addEventListener(
                    "mousedown",
                    u._lineBreakerBind.t,
                    !1
                  ),
                  e.element.lineBreaker_b.addEventListener(
                    "mousedown",
                    u._lineBreakerBind.b,
                    !1
                  ),
                  d.plugins.table &&
                    t.addEventListener("touchstart", u.onMouseDown_wysiwyg, {
                      passive: !0,
                      useCapture: !1,
                    }),
                  "auto" !== l.height ||
                    l.codeMirrorEditor ||
                    (e.element.code.addEventListener(
                      "keydown",
                      u._codeViewAutoHeight,
                      !1
                    ),
                    e.element.code.addEventListener(
                      "keyup",
                      u._codeViewAutoHeight,
                      !1
                    ),
                    e.element.code.addEventListener(
                      "paste",
                      u._codeViewAutoHeight,
                      !1
                    )),
                  e.element.resizingBar &&
                    (/\d+/.test(l.height)
                      ? e.element.resizingBar.addEventListener(
                          "mousedown",
                          u.onMouseDown_resizingBar,
                          !1
                        )
                      : r.addClass(e.element.resizingBar, "ke-resizing-none")),
                  u._setResponsiveToolbar(),
                  a.removeEventListener("resize", u.onResize_window),
                  a.removeEventListener("scroll", u.onScroll_window),
                  a.addEventListener("resize", u.onResize_window, !1),
                  -1 < l.stickyToolbar &&
                    a.addEventListener("scroll", u.onScroll_window, !1);
              },
              _removeEvent: function () {
                var t = l.iframe ? d._ww : e.element.wysiwyg;
                e.element.toolbar.removeEventListener(
                  "mousedown",
                  u._buttonsEventHandler
                ),
                  e.element._menuTray.removeEventListener(
                    "mousedown",
                    u._buttonsEventHandler
                  ),
                  e.element.toolbar.removeEventListener(
                    "click",
                    u.onClick_toolbar
                  ),
                  t.removeEventListener("mousedown", u.onMouseDown_wysiwyg),
                  t.removeEventListener("click", u.onClick_wysiwyg),
                  t.removeEventListener(
                    r.isIE ? "textinput" : "input",
                    u.onInput_wysiwyg
                  ),
                  t.removeEventListener("keydown", u.onKeyDown_wysiwyg),
                  t.removeEventListener("keyup", u.onKeyUp_wysiwyg),
                  t.removeEventListener("paste", u.onPaste_wysiwyg),
                  t.removeEventListener("copy", u.onCopy_wysiwyg),
                  t.removeEventListener("cut", u.onCut_wysiwyg),
                  t.removeEventListener("drop", u.onDrop_wysiwyg),
                  t.removeEventListener("scroll", u.onScroll_wysiwyg),
                  t.removeEventListener("mousemove", u.onMouseMove_wysiwyg),
                  d._lineBreakerButton.removeEventListener(
                    "mousedown",
                    u._onMouseDown_lineBreak
                  ),
                  d._lineBreakerButton.removeEventListener(
                    "click",
                    u._lineBreakerBind.a
                  ),
                  e.element.lineBreaker_t.removeEventListener(
                    "mousedown",
                    u._lineBreakerBind.t
                  ),
                  e.element.lineBreaker_b.removeEventListener(
                    "mousedown",
                    u._lineBreakerBind.b
                  ),
                  (u._lineBreakerBind = null),
                  t.removeEventListener("touchstart", u.onMouseDown_wysiwyg, {
                    passive: !0,
                    useCapture: !1,
                  }),
                  t.removeEventListener("focus", u.onFocus_wysiwyg),
                  t.removeEventListener("blur", u.onBlur_wysiwyg),
                  e.element.code.removeEventListener(
                    "keydown",
                    u._codeViewAutoHeight
                  ),
                  e.element.code.removeEventListener(
                    "keyup",
                    u._codeViewAutoHeight
                  ),
                  e.element.code.removeEventListener(
                    "paste",
                    u._codeViewAutoHeight
                  ),
                  e.element.resizingBar &&
                    e.element.resizingBar.removeEventListener(
                      "mousedown",
                      u.onMouseDown_resizingBar
                    ),
                  a.removeEventListener("resize", u.onResize_window),
                  a.removeEventListener("scroll", u.onScroll_window);
              },
              _setResponsiveToolbar: function () {
                if (0 !== o.length)
                  for (
                    var e,
                      t,
                      i = (u._responsiveButtonSize = ["default"]),
                      n = (u._responsiveButtons = { default: o[0] }),
                      l = 1,
                      s = o.length;
                    l < s;
                    l++
                  )
                    (e = +(t = o[l])[0]), i.push(e), (n[e] = t[1]);
                else o = null;
              },
            },
            h = {
              core: d,
              util: r,
              onload: null,
              onScroll: null,
              onMouseDown: null,
              onClick: null,
              onInput: null,
              onKeyDown: null,
              onKeyUp: null,
              onDrop: null,
              onChange: null,
              onCopy: null,
              onCut: null,
              onPaste: null,
              onFocus: null,
              onBlur: null,
              showInline: null,
              showController: null,
              toggleCodeView: null,
              toggleFullScreen: null,
              imageUploadHandler: null,
              videoUploadHandler: null,
              audioUploadHandler: null,
              onImageUploadBefore: null,
              onVideoUploadBefore: null,
              onAudioUploadBefore: null,
              onImageUpload: null,
              onVideoUpload: null,
              onAudioUpload: null,
              onImageUploadError: null,
              onVideoUploadError: null,
              onAudioUploadError: null,
              setToolbarButtons: function (n) {
                d.submenuOff(), d.containerOff();
                var a = A._createToolBar(s, n, d.plugins, l);
                (o = a.responsiveButtons),
                  (d._moreLayerActiveButton = null),
                  u._setResponsiveToolbar(),
                  e.element.toolbar.replaceChild(
                    a._buttonTray,
                    e.element._buttonTray
                  );
                var c = M(
                  e.element.originElement,
                  d._getConstructed(e.element),
                  l
                );
                (e.element = c.element),
                  (e.tool = c.tool),
                  l.iframe && (e.element.wysiwyg = d._wd.body),
                  d._cachingButtons(),
                  d.history._resetCachingButton(),
                  (d.activePlugins = []);
                var h,
                  g,
                  p,
                  m,
                  f = t;
                for (m in (t = a.pluginCallButtons))
                  r.hasOwn(t, m) &&
                    ((h = i[m]),
                    (g = t[m]),
                    h.active &&
                      g &&
                      ((p = f[m]),
                      d.callPlugin(m, null, p || g),
                      p && (g.parentElement.replaceChild(p, g), (t[m] = p))));
                d.hasFocus && u._applyTagEffects(),
                  d._variable.isCodeView &&
                    r.addClass(d._styleCommandMap.codeView, "active"),
                  d._variable.isFullScreen &&
                    r.addClass(d._styleCommandMap.fullScreen, "active"),
                  r.hasClass(e.element.wysiwyg, "ke-show-block") &&
                    r.addClass(d._styleCommandMap.showBlocks, "active");
              },
              setOptions: function (s) {
                u._removeEvent(),
                  d._resetComponents(),
                  r.removeClass(d._styleCommandMap.showBlocks, "active"),
                  r.removeClass(d._styleCommandMap.codeView, "active"),
                  (d._variable.isCodeView = !1),
                  (d._iframeAuto = null),
                  (d.plugins = s.plugins || d.plugins);
                var c = [l, s].reduce(function (e, t) {
                    for (var i in t)
                      r.hasOwn(t, i) &&
                        ("plugins" === i && t[i] && e[i]
                          ? (function () {
                              var n = e[i],
                                l = t[i];
                              (n = n.length
                                ? n
                                : a.Object.keys(n).map(function (e) {
                                    return n[e];
                                  })),
                                (l = l.length
                                  ? l
                                  : a.Object.keys(l).map(function (e) {
                                      return l[e];
                                    })),
                                (e[i] = l
                                  .filter(function (e) {
                                    return -1 === n.indexOf(e);
                                  })
                                  .concat(n));
                            })()
                          : (e[i] = t[i]));
                    return e;
                  }, {}),
                  h = e.element,
                  g = h.wysiwyg.innerHTML,
                  p = A._setOptions(c, e, d.plugins, l);
                p.callButtons && ((t = p.callButtons), (d.initPlugins = {})),
                  p.plugins && (d.plugins = i = p.plugins),
                  0 === h._menuTray.children.length && (this._menuTray = {}),
                  (o = p.toolbar.responsiveButtons),
                  (l = c),
                  (d.lang = n = l.lang),
                  l.iframe &&
                    h.wysiwygFrame.addEventListener("load", function () {
                      r._setIframeDocument(this, l), d._setOptionsInit(h, g);
                    }),
                  h.editorArea.appendChild(h.wysiwygFrame),
                  l.iframe || d._setOptionsInit(h, g);
              },
              setDefaultStyle: function (t) {
                var i = (l._editorStyles = r._setDefaultOptionStyle(l, t)),
                  n = e.element;
                (n.topArea.style.cssText = i.top),
                  (n.code.style.cssText = l._editorStyles.frame),
                  (n.code.style.display = "none"),
                  "auto" === l.height
                    ? (n.code.style.overflow = "hidden")
                    : (n.code.style.overflow = ""),
                  l.iframe
                    ? ((n.wysiwygFrame.style.cssText = i.frame),
                      (n.wysiwyg.style.cssText = i.editor))
                    : (n.wysiwygFrame.style.cssText = i.frame + i.editor);
              },
              noticeOpen: function (e) {
                d.notice.open.call(d, e);
              },
              noticeClose: function () {
                d.notice.close.call(d);
              },
              save: function () {
                e.element.originElement.value = d.getContents(!1);
              },
              getContext: function () {
                return e;
              },
              getContents: function (e) {
                return d.getContents(e);
              },
              getText: function () {
                return e.element.wysiwyg.textContent;
              },
              getCharCount: function (t) {
                return (
                  (t = "string" == typeof t ? t : l.charCounterType),
                  d.getCharLength(
                    d._charTypeHTML
                      ? e.element.wysiwyg.innerHTML
                      : e.element.wysiwyg.textContent,
                    t
                  )
                );
              },
              getImagesInfo: function () {
                return e.image ? e.image._infoList : [];
              },
              getFilesInfo: function (t) {
                return e[t] ? e[t]._infoList : [];
              },
              insertImage: function (e) {
                d.plugins.image &&
                  e &&
                  (d.initPlugins.image
                    ? d.plugins.image.submitAction.call(d, e)
                    : d.callPlugin(
                        "image",
                        d.plugins.image.submitAction.bind(d, e),
                        null
                      ),
                  d.focus());
              },
              insertHTML: function (e, t, i, n) {
                if ("string" == typeof e) {
                  t || (e = d.cleanHTML(e, null));
                  try {
                    var l,
                      o,
                      a,
                      c,
                      u = s.createRange().createContextualFragment(e)
                        .childNodes;
                    if (i) {
                      for (
                        var h = d._charTypeHTML ? "outerHTML" : "textContent",
                          g = "",
                          p = 0,
                          m = u.length;
                        p < m;
                        p++
                      )
                        g += u[p][h];
                      if (!d.checkCharCount(g, null)) return;
                    }
                    for (; (l = u[0]); )
                      (o = (a = d.insertNode(l, o, !1)).container || a),
                        (c = c || a);
                    var f =
                      3 === o.nodeType
                        ? a.endOffset || o.textContent.length
                        : o.childNodes.length;
                    n
                      ? d.setRange(c.container || c, c.startOffset || 0, o, f)
                      : d.setRange(o, f, o, f);
                  } catch (t) {
                    d.execCommand("insertHTML", !1, e);
                  }
                } else {
                  var v;
                  r.isComponent(e)
                    ? d.insertComponent(e, !1, i, !1)
                    : ((v = null),
                      (r.isFormatElement(e) || r.isMedia(e)) &&
                        (v = r.getFormatElement(d.getSelectionNode(), null)),
                      d.insertNode(e, v, i));
                }
                (d.effectNode = null), d.focus(), d.history.push(!1);
              },
              setContents: function (e) {
                d.setContents(e);
              },
              appendContents: function (t) {
                var i = d.convertContentsForEditor(t);
                if (d._variable.isCodeView)
                  d._setCodeView(
                    d._getCodeView() + "\n" + d.convertHTMLForCodeView(i)
                  );
                else {
                  var n = r.createElement("DIV");
                  n.innerHTML = i;
                  for (
                    var l = e.element.wysiwyg,
                      o = n.children,
                      s = 0,
                      a = o.length;
                    s < a;
                    s++
                  )
                    l.appendChild(o[s]);
                }
                d.history.push(!1);
              },
              disabled: function () {
                (e.tool.cover.style.display = "block"),
                  e.element.wysiwyg.setAttribute("contenteditable", !1),
                  (d.isDisabled = !0),
                  l.codeMirrorEditor
                    ? l.codeMirrorEditor.setOption("readOnly", !0)
                    : e.element.code.setAttribute("disabled", "disabled");
              },
              enabled: function () {
                (e.tool.cover.style.display = "none"),
                  e.element.wysiwyg.setAttribute("contenteditable", !0),
                  (d.isDisabled = !1),
                  l.codeMirrorEditor
                    ? l.codeMirrorEditor.setOption("readOnly", !1)
                    : e.element.code.removeAttribute("disabled");
              },
              show: function () {
                var t = e.element.topArea.style;
                "none" === t.display && (t.display = l.display);
              },
              hide: function () {
                e.element.topArea.style.display = "none";
              },
              destroy: function () {
                for (var i in (d.submenuOff(),
                d.containerOff(),
                d.controllersOff(),
                d.notice && d.notice.close.call(d),
                d.modalForm && d.plugins.dialog.close.call(d),
                d.history._destroy(),
                u._removeEvent(),
                r.removeItem(e.element.toolbar),
                r.removeItem(e.element.topArea),
                d))
                  r.hasOwn(d, i) && delete d[i];
                for (var n in u) r.hasOwn(u, n) && delete u[n];
                for (var l in e) r.hasOwn(e, l) && delete e[l];
                for (var o in t) r.hasOwn(t, o) && delete t[o];
                for (var s in this) r.hasOwn(this, s) && delete this[s];
              },
              toolbar: {
                disabled: function () {
                  e.tool.cover.style.display = "block";
                },
                enabled: function () {
                  e.tool.cover.style.display = "none";
                },
                show: function () {
                  d._isInline
                    ? u._showToolbarInline()
                    : ((e.element.toolbar.style.display = ""),
                      (e.element._stickyDummy.style.display = ""));
                },
                hide: function () {
                  d._isInline
                    ? u._hideToolbar()
                    : ((e.element.toolbar.style.display = "none"),
                      (e.element._stickyDummy.style.display = "none"));
                },
              },
            };
          d.functions = h;
          var g = e.element,
            p = g.originElement,
            m = g.topArea;
          return (
            (p.style.display = "none"),
            (m.style.display = "block"),
            l.iframe &&
              g.wysiwygFrame.addEventListener("load", function () {
                r._setIframeDocument(this, l),
                  d._editorInit(!1, l.value),
                  (l.value = null);
              }),
            "object" === I(p.nextElementSibling)
              ? p.parentNode.insertBefore(m, p.nextElementSibling)
              : p.parentNode.appendChild(m),
            g.editorArea.appendChild(g.wysiwygFrame),
            (g = p = m = null),
            l.iframe || (d._editorInit(!1, l.value), (l.value = null)),
            h
          );
        })(
          M(n, l.constructed, l.options),
          l.pluginCallButtons,
          l.plugins,
          l.options.lang,
          t,
          l._responsiveButtons
        );
      },
    };
    Object.defineProperty(window, "KothingEditor", {
      enumerable: !0,
      writable: !1,
      configurable: !1,
      value: D.init({ plugins: E }),
    }),
      (t.default = D);
  },
  JhlZ: function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          var n = {
            name: "fileBrowser",
            _xmlHttp: null,
            _loading: null,
            add: function (e) {
              var t = e.context;
              t.fileBrowser = {
                _closeSignal: !1,
                area: null,
                header: null,
                tagArea: null,
                body: null,
                list: null,
                tagElements: null,
                items: [],
                selectedTags: [],
                selectorHandler: null,
                contextPlugin: "",
                columnSize: 4,
              };
              var i = e.util.createElement("DIV");
              i.className = "ke-file-browser kothing-editor-common";
              var n = e.util.createElement("DIV");
              n.className = "ke-file-browser-back";
              var l = e.util.createElement("DIV");
              (l.className = "ke-file-browser-inner"),
                (l.innerHTML = this.set_browser(e)),
                i.appendChild(n),
                i.appendChild(l),
                (this._loading = i.querySelector(".ke-loading-box")),
                (t.fileBrowser.area = i),
                (t.fileBrowser.header = l.querySelector(
                  ".ke-file-browser-header"
                )),
                (t.fileBrowser.titleArea = l.querySelector(
                  ".ke-file-browser-title"
                )),
                (t.fileBrowser.tagArea = l.querySelector(
                  ".ke-file-browser-tags"
                )),
                (t.fileBrowser.body = l.querySelector(".ke-file-browser-body")),
                (t.fileBrowser.list = l.querySelector(".ke-file-browser-list")),
                t.fileBrowser.tagArea.addEventListener(
                  "click",
                  this.onClickTag.bind(e)
                ),
                t.fileBrowser.list.addEventListener(
                  "click",
                  this.onClickFile.bind(e)
                ),
                l.addEventListener(
                  "mousedown",
                  this._onMouseDown_browser.bind(e)
                ),
                l.addEventListener("click", this._onClick_browser.bind(e)),
                t.element.relative.appendChild(i),
                (l = n = i = null);
            },
            set_browser: function (e) {
              return (
                '<div class="ke-file-browser-content"><div class="ke-file-browser-header"><button type="button" data-command="close" class="ke-btn ke-file-browser-close" class="close" aria-label="Close" title="' +
                e.lang.dialogBox.close +
                '">' +
                e.icons.cancel +
                '</button><span class="ke-file-browser-title"></span><div class="ke-file-browser-tags"></div></div><div class="ke-file-browser-body"><div class="ke-loading-box kothing-editor-common"><div class="ke-loading-effect"></div></div><div class="ke-file-browser-list"></div></div></div>'
              );
            },
            _onMouseDown_browser: function (e) {
              /ke-file-browser-inner/.test(e.target.className)
                ? (this.context.fileBrowser._closeSignal = !0)
                : (this.context.fileBrowser._closeSignal = !1);
            },
            _onClick_browser: function (e) {
              e.stopPropagation(),
                (/close/.test(e.target.getAttribute("data-command")) ||
                  this.context.fileBrowser._closeSignal) &&
                  this.plugins.fileBrowser.close.call(this);
            },
            open: function (e, t) {
              this.plugins.fileBrowser._bindClose &&
                (this._d.removeEventListener(
                  "keydown",
                  this.plugins.fileBrowser._bindClose
                ),
                (this.plugins.fileBrowser._bindClose = null)),
                (this.plugins.fileBrowser._bindClose = function (e) {
                  /27/.test(e.keyCode) &&
                    this.plugins.fileBrowser.close.call(this);
                }.bind(this)),
                this._d.addEventListener(
                  "keydown",
                  this.plugins.fileBrowser._bindClose
                );
              var i = this.context.fileBrowser;
              (i.contextPlugin = e), (i.selectorHandler = t);
              var n = this.context[e],
                l = n.listClass;
              this.util.hasClass(i.list, l) ||
                (i.list.className = "ke-file-browser-list " + l),
                "full" === this.context.option.popupDisplay
                  ? (i.area.style.position = "fixed")
                  : (i.area.style.position = "absolute"),
                (i.titleArea.textContent = n.title),
                (i.area.style.display = "block"),
                this.plugins.fileBrowser._drawFileList.call(
                  this,
                  this.context[e].url
                );
            },
            _bindClose: null,
            close: function () {
              var e = this.plugins.fileBrowser;
              e._xmlHttp && e._xmlHttp.abort(),
                e._bindClose &&
                  (this._d.removeEventListener("keydown", e._bindClose),
                  (e._bindClose = null));
              var t = this.context.fileBrowser;
              (t.area.style.display = "none"),
                (t.selectorHandler = null),
                (t.selectedTags = []),
                (t.items = []),
                (t.list.innerHTML = ""),
                (t.tagArea.innerHTML = ""),
                (t.titleArea.textContent = ""),
                "function" == typeof this.plugins[t.contextPlugin].init &&
                  this.plugins[t.contextPlugin].init.call(this),
                (t.contextPlugin = "");
            },
            showBrowserLoading: function () {
              this._loading.style.display = "block";
            },
            closeBrowserLoading: function () {
              this._loading.style.display = "none";
            },
            _drawFileList: function (e) {
              var t = this.plugins.fileBrowser,
                i = (t._xmlHttp = this.util.getXMLHttpRequest());
              (i.onreadystatechange = t._callBackGet.bind(this, i)),
                i.open("get", e, !0),
                i.send(null),
                this.plugins.fileBrowser.showBrowserLoading();
            },
            _callBackGet: function (e) {
              if (4 === e.readyState)
                if (
                  ((this.plugins.fileBrowser._xmlHttp = null), 200 === e.status)
                )
                  try {
                    this.plugins.fileBrowser._drawListItem.call(
                      this,
                      JSON.parse(e.responseText).result,
                      !0
                    );
                  } catch (e) {
                    throw Error(
                      '[KothingEditor.fileBrowser.drawList.fail] cause : "' +
                        e.message +
                        '"'
                    );
                  } finally {
                    this.plugins.fileBrowser.closeBrowserLoading(),
                      (this.context.fileBrowser.body.style.maxHeight =
                        this._w.innerHeight -
                        this.context.fileBrowser.header.offsetHeight -
                        50 +
                        "px");
                  }
                else if (
                  (this.plugins.fileBrowser.closeBrowserLoading(),
                  0 !== e.status)
                ) {
                  var t = e.responseText ? JSON.parse(e.responseText) : e,
                    i =
                      "[KothingEditor.fileBrowser.get.serverException] status: " +
                      e.status +
                      ", response: " +
                      (t.errorMessage || e.responseText);
                  throw Error(i);
                }
            },
            _drawListItem: function (e, t) {
              for (
                var i,
                  n,
                  l = this.context.fileBrowser,
                  o = this.context[l.contextPlugin],
                  s = [],
                  a = e.length,
                  r = o.columnSize || l.columnSize,
                  c = (!(r <= 1) && Math.round(a / r)) || 1,
                  d = o.itemTemplateHandler,
                  u = "",
                  h = '<div class="ke-file-item-column">',
                  g = 1,
                  p = 0;
                p < a;
                p++
              )
                if (
                  ((n = (i = e[p]).tag
                    ? "string" == typeof i.tag
                      ? i.tag.split(",")
                      : i.tag
                    : []),
                  (n = i.tag = n.map(function (e) {
                    return e.trim();
                  })),
                  (h += d(i)),
                  (p + 1) % c == 0 &&
                    g < r &&
                    p + 1 < a &&
                    (g++, (h += '</div><div class="ke-file-item-column">')),
                  t && 0 < n.length)
                )
                  for (var m, f = 0, v = n.length; f < v; f++)
                    (m = n[f]) &&
                      -1 === s.indexOf(m) &&
                      (s.push(m), (u += '<a title="' + m + '">' + m + "</a>"));
              (h += "</div>"),
                (l.list.innerHTML = h),
                t &&
                  ((l.items = e),
                  (l.tagArea.innerHTML = u),
                  (l.tagElements = l.tagArea.querySelectorAll("A")));
            },
            onClickTag: function (e) {
              var t,
                i,
                n,
                l,
                o,
                s,
                a = e.target;
              this.util.isAnchor(a) &&
                ((t = a.textContent),
                (i = this.plugins.fileBrowser),
                (l = (n = this.context.fileBrowser).tagArea.querySelector(
                  'a[title="' + t + '"]'
                )),
                -1 < (s = (o = n.selectedTags).indexOf(t))
                  ? (o.splice(s, 1), this.util.removeClass(l, "on"))
                  : (o.push(t), this.util.addClass(l, "on")),
                i._drawListItem.call(
                  this,
                  0 === o.length
                    ? n.items
                    : n.items.filter(function (e) {
                        return e.tag.some(function (e) {
                          return -1 < o.indexOf(e);
                        });
                      }),
                  !1
                ));
            },
            onClickFile: function (e) {
              e.preventDefault(), e.stopPropagation();
              var t,
                i = this.context.fileBrowser,
                n = i.list,
                l = e.target,
                o = null;
              if (l !== n) {
                for (
                  ;
                  n !== l.parentNode && !(o = l.getAttribute("data-command"));

                )
                  l = l.parentNode;
                o &&
                  ((t =
                    i.selectorHandler ||
                    this.context[i.contextPlugin].selectorHandler),
                  this.plugins.fileBrowser.close.call(this),
                  t(l));
              }
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Modules ||
                Object.defineProperty(e, "KothingEditor_Modules", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Modules, "fileBrowser", {
                enumerable: !0,
                writable: !1,
                configurable: !1,
                value: n,
              })),
            n
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Modules a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  P6u4: function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          var n = {
            code: "en",
            toolbar: {
              default: "Default",
              save: "Save",
              font: "Font",
              formats: "Formats",
              fontSize: "Size",
              bold: "Bold",
              underline: "Underline",
              italic: "Italic",
              strike: "Strike",
              subscript: "Subscript",
              superscript: "Superscript",
              removeFormat: "Remove Format",
              fontColor: "Font Color",
              hiliteColor: "Highlight Color",
              indent: "Indent",
              outdent: "Outdent",
              align: "Align",
              alignLeft: "Align left",
              alignRight: "Align right",
              alignCenter: "Align center",
              alignJustify: "Align justify",
              list: "List",
              orderList: "Ordered list",
              unorderList: "Unordered list",
              horizontalRule: "Horizontal line",
              hr_solid: "Solid",
              hr_dotted: "Dotted",
              hr_dashed: "Dashed",
              table: "Table",
              link: "Link",
              math: "Math",
              image: "Image",
              video: "Video",
              audio: "Audio",
              fullScreen: "Full screen",
              showBlocks: "Show blocks",
              codeView: "Code view",
              undo: "Undo",
              redo: "Redo",
              preview: "Preview",
              print: "print",
              tag_p: "Paragraph",
              tag_div: "Normal (DIV)",
              tag_h: "Header",
              tag_blockquote: "Quote",
              tag_pre: "Code",
              template: "Template",
              lineHeight: "Line height",
              paragraphStyle: "Paragraph style",
              textStyle: "Text style",
              imageGallery: "Image gallery",
            },
            dialogBox: {
              linkBox: {
                title: "Insert Link",
                url: "URL to link",
                text: "Text to display",
                newWindowCheck: "Open in new window",
              },
              mathBox: {
                title: "Math",
                inputLabel: "Mathematical Notation",
                fontSizeLabel: "Font Size",
                previewLabel: "Preview",
              },
              imageBox: {
                title: "Insert image",
                file: "Select from files",
                url: "Image URL",
                altText: "Alternative text",
              },
              videoBox: {
                title: "Insert Video",
                file: "Select from files",
                url: "Media embed URL, YouTube/Vimeo",
              },
              audioBox: {
                title: "Insert Audio",
                file: "Select from files",
                url: "Audio URL",
              },
              browser: { tags: "Tags", search: "Search" },
              caption: "Insert description",
              close: "Close",
              submitButton: "Submit",
              revertButton: "Revert",
              proportion: "Constrain proportions",
              basic: "Basic",
              left: "Left",
              right: "Right",
              center: "Center",
              width: "Width",
              height: "Height",
              size: "Size",
              ratio: "Ratio",
            },
            controller: {
              edit: "Edit",
              unlink: "Unlink",
              remove: "Remove",
              insertRowAbove: "Insert row above",
              insertRowBelow: "Insert row below",
              deleteRow: "Delete row",
              insertColumnBefore: "Insert column before",
              insertColumnAfter: "Insert column after",
              deleteColumn: "Delete column",
              fixedColumnWidth: "Fixed column width",
              resize100: "Resize 100%",
              resize75: "Resize 75%",
              resize50: "Resize 50%",
              resize25: "Resize 25%",
              autoSize: "Auto size",
              mirrorHorizontal: "Mirror, Horizontal",
              mirrorVertical: "Mirror, Vertical",
              rotateLeft: "Rotate left",
              rotateRight: "Rotate right",
              maxSize: "Max size",
              minSize: "Min size",
              tableHeader: "Table header",
              mergeCells: "Merge cells",
              splitCells: "Split Cells",
              HorizontalSplit: "Horizontal split",
              VerticalSplit: "Vertical split",
            },
            menu: {
              spaced: "Spaced",
              bordered: "Bordered",
              neon: "Neon",
              translucent: "Translucent",
              shadow: "Shadow",
              code: "Code",
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Lang ||
                Object.defineProperty(e, "KothingEditor_Lang", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Lang, "en", {
                enumerable: !0,
                writable: !0,
                configurable: !0,
                value: n,
              })),
            n
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Lang a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  YuTi: function (e, t) {
    e.exports = function (e) {
      return (
        e.webpackPolyfill ||
          ((e.deprecate = function () {}),
          (e.paths = []),
          e.children || (e.children = []),
          Object.defineProperty(e, "loaded", {
            enumerable: !0,
            get: function () {
              return e.l;
            },
          }),
          Object.defineProperty(e, "id", {
            enumerable: !0,
            get: function () {
              return e.i;
            },
          }),
          (e.webpackPolyfill = 1)),
        e
      );
    };
  },
  ZED3: function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          var n = {
            name: "component",
            set_container: function (e, t) {
              var i = this.util.createElement("DIV");
              return (
                (i.className = "ke-component " + t),
                i.setAttribute("contenteditable", !1),
                i.appendChild(e),
                i
              );
            },
            set_cover: function (e) {
              var t = this.util.createElement("FIGURE");
              return t.appendChild(e), t;
            },
            create_caption: function () {
              var e = this.util.createElement("FIGCAPTION");
              return (
                e.setAttribute("contenteditable", !0),
                (e.innerHTML =
                  "<div>" + this.lang.dialogBox.caption + "</div>"),
                e
              );
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Modules ||
                Object.defineProperty(e, "KothingEditor_Modules", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Modules, "component", {
                enumerable: !0,
                writable: !1,
                configurable: !1,
                value: n,
              })),
            n
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Modules a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  ee5k: function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          var n = {
            name: "resizing",
            add: function (e) {
              var t = e.icons,
                i = e.context;
              i.resizing = {
                _resizeClientX: 0,
                _resizeClientY: 0,
                _resize_plugin: "",
                _resize_w: 0,
                _resize_h: 0,
                _origin_w: 0,
                _origin_h: 0,
                _rotateVertical: !1,
                _resize_direction: "",
                _move_path: null,
                _isChange: !1,
                alignIcons: {
                  basic: t.align_justify,
                  left: t.align_left,
                  right: t.align_right,
                  center: t.align_center,
                },
              };
              var n = this.setController_resize.call(e);
              (i.resizing.resizeContainer = n),
                (i.resizing.resizeDiv = n.querySelector(".ke-modal-resize")),
                (i.resizing.resizeDot = n.querySelector(".ke-resize-dot")),
                (i.resizing.resizeDisplay = n.querySelector(
                  ".ke-resize-display"
                ));
              var l = this.setController_button.call(e);
              i.resizing.resizeButton = l;
              var o = (i.resizing.resizeHandles = i.resizing.resizeDot.querySelectorAll(
                "span"
              ));
              (i.resizing.resizeButtonGroup = l.querySelector(
                "._ke_resizing_btn_group"
              )),
                (i.resizing.rotationButtons = l.querySelectorAll(
                  "._ke_resizing_btn_group ._ke_rotation"
                )),
                (i.resizing.percentageButtons = l.querySelectorAll(
                  "._ke_resizing_btn_group ._ke_percentage"
                )),
                (i.resizing.alignMenu = l.querySelector(
                  ".ke-resizing-align-list"
                )),
                (i.resizing.alignMenuList = i.resizing.alignMenu.querySelectorAll(
                  "button"
                )),
                (i.resizing.alignButton = l.querySelector(
                  "._ke_resizing_align_button"
                )),
                (i.resizing.autoSizeButton = l.querySelector(
                  "._ke_resizing_btn_group ._ke_auto_size"
                )),
                (i.resizing.captionButton = l.querySelector(
                  "._ke_resizing_caption_button"
                )),
                n.addEventListener("mousedown", function (e) {
                  e.preventDefault();
                }),
                l.addEventListener("mousedown", e.eventStop),
                o[0].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[1].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[2].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[3].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[4].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[5].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[6].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                o[7].addEventListener(
                  "mousedown",
                  this.onMouseDown_resize_handle.bind(e)
                ),
                l.addEventListener("click", this.onClick_resizeButton.bind(e)),
                i.element.relative.appendChild(n),
                i.element.relative.appendChild(l),
                (o = l = n = null);
            },
            setController_resize: function () {
              var e = this.util.createElement("DIV");
              return (
                (e.className = "ke-controller ke-resizing-container"),
                (e.style.display = "none"),
                (e.innerHTML =
                  '<div class="ke-modal-resize"></div><div class="ke-resize-dot"><span class="tl"></span><span class="tr"></span><span class="bl"></span><span class="br"></span><span class="lw"></span><span class="th"></span><span class="rw"></span><span class="bh"></span><div class="ke-resize-display"></div></div>'),
                e
              );
            },
            setController_button: function () {
              var e = this.lang,
                t = this.icons,
                i = this.util.createElement("DIV");
              return (
                (i.className = "ke-controller ke-controller-resizing"),
                (i.innerHTML =
                  '<div class="ke-arrow ke-arrow-up"></div><div class="ke-btn-group _ke_resizing_btn_group"><button type="button" data-command="percent" data-value="1" class="ke-tooltip _ke_percentage"><span>100%</span><span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.resize100 +
                  '</span></span></button><button type="button" data-command="percent" data-value="0.75" class="ke-tooltip _ke_percentage"><span>75%</span><span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.resize75 +
                  '</span></span></button><button type="button" data-command="percent" data-value="0.5" class="ke-tooltip _ke_percentage"><span>50%</span><span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.resize50 +
                  '</span></span></button><button type="button" data-command="auto" class="ke-btn ke-tooltip _ke_auto_size">' +
                  t.auto_size +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.autoSize +
                  '</span></span></button><button type="button" data-command="rotate" data-value="-90" class="ke-btn ke-tooltip _ke_rotation">' +
                  t.rotate_left +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.rotateLeft +
                  '</span></span></button><button type="button" data-command="rotate" data-value="90" class="ke-btn ke-tooltip _ke_rotation">' +
                  t.rotate_right +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.rotateRight +
                  '</span></span></button></div><div class="ke-btn-group" style="padding-top: 0;"><button type="button" data-command="mirror" data-value="h" class="ke-btn ke-tooltip">' +
                  t.mirror_horizontal +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.mirrorHorizontal +
                  '</span></span></button><button type="button" data-command="mirror" data-value="v" class="ke-btn ke-tooltip">' +
                  t.mirror_vertical +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.mirrorVertical +
                  '</span></span></button><button type="button" data-command="onalign" class="ke-btn ke-tooltip _ke_resizing_align_button">' +
                  t.align_justify +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.toolbar.align +
                  '</span></span></button><div class="ke-btn-group-sub kothing-editor-common ke-list-layer ke-resizing-align-list"><div class="ke-list-inner"><ul class="ke-list-basic"><li><button type="button" class="ke-btn-list ke-tooltip" data-command="align" data-value="basic">' +
                  t.align_justify +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.basic +
                  '</span></span></button></li><li><button type="button" class="ke-btn-list ke-tooltip" data-command="align" data-value="left">' +
                  t.align_left +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.left +
                  '</span></span></button></li><li><button type="button" class="ke-btn-list ke-tooltip" data-command="align" data-value="center">' +
                  t.align_center +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.center +
                  '</span></span></button></li><li><button type="button" class="ke-btn-list ke-tooltip" data-command="align" data-value="right">' +
                  t.align_right +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.right +
                  '</span></span></button></li></ul></div></div><button type="button" data-command="caption" class="ke-btn ke-tooltip _ke_resizing_caption_button">' +
                  t.caption +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.caption +
                  '</span></span></button><button type="button" data-command="revert" class="ke-btn ke-tooltip">' +
                  t.revert +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.dialogBox.revertButton +
                  '</span></span></button><button type="button" data-command="update" class="ke-btn ke-tooltip">' +
                  t.modify +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.edit +
                  '</span></span></button><button type="button" data-command="delete" class="ke-btn ke-tooltip">' +
                  t.delete +
                  '<span class="ke-tooltip-inner"><span class="ke-tooltip-text">' +
                  e.controller.remove +
                  "</span></span></button></div>"),
                i
              );
            },
            _module_getSizeX: function (e, t, i, n) {
              return (
                (t = t || e._element),
                (i = i || e._cover),
                (n = n || e._container),
                t
                  ? /%$/.test(t.style.width)
                    ? ((n && this.util.getNumber(n.style.width, 2)) || 100) +
                      "%"
                    : t.style.width
                  : ""
              );
            },
            _module_getSizeY: function (e, t, i, n) {
              return (
                (t = t || e._element),
                (i = i || e._cover),
                (n = n || e._container) && i
                  ? 0 < this.util.getNumber(i.style.paddingBottom, 0) &&
                    !this.context.resizing._rotateVertical
                    ? i.style.height
                    : /%$/.test(t.style.height) && /%$/.test(t.style.width)
                    ? ((n && this.util.getNumber(n.style.height, 2)) || 100) +
                      "%"
                    : t.style.height
                  : (t && t.style.height) || ""
              );
            },
            _module_setModifyInputSize: function (e, t) {
              var i =
                e._onlyPercentage && this.context.resizing._rotateVertical;
              e.proportion.checked = e._proportionChecked =
                "false" !== e._element.getAttribute("data-proportion");
              var n,
                l = i
                  ? ""
                  : this.plugins.resizing._module_getSizeX.call(this, e);
              l === e._defaultSizeX && (l = ""),
                e._onlyPercentage && (l = this.util.getNumber(l, 2)),
                (e.inputX.value = l),
                t.setInputSize.call(this, "x"),
                e._onlyPercentage ||
                  ((n = i
                    ? ""
                    : this.plugins.resizing._module_getSizeY.call(this, e)) ===
                    e._defaultSizeY && (n = ""),
                  e._onlyPercentage && (n = this.util.getNumber(n, 2)),
                  (e.inputY.value = n)),
                (e.inputX.disabled = !!i),
                (e.inputY.disabled = !!i),
                (e.proportion.disabled = !!i),
                t.setRatio.call(this);
            },
            _module_setInputSize: function (e, t) {
              if (e._onlyPercentage)
                "x" === t && 100 < e.inputX.value && (e.inputX.value = 100);
              else if (
                e.proportion.checked &&
                e._ratio &&
                /\d/.test(e.inputX.value) &&
                /\d/.test(e.inputY.value)
              ) {
                var i = e.inputX.value.replace(/\d+|\./g, "") || e.sizeUnit,
                  n = e.inputY.value.replace(/\d+|\./g, "") || e.sizeUnit;
                if (i !== n) return;
                var l = "%" === i ? 2 : 0;
                "x" === t
                  ? (e.inputY.value =
                      this.util.getNumber(
                        e._ratioY * this.util.getNumber(e.inputX.value, l),
                        l
                      ) + n)
                  : (e.inputX.value =
                      this.util.getNumber(
                        e._ratioX * this.util.getNumber(e.inputY.value, l),
                        l
                      ) + i);
              }
            },
            _module_setRatio: function (e) {
              var t,
                i,
                n = e.inputX.value,
                l = e.inputY.value;
              e.proportion.checked &&
              /\d+/.test(n) &&
              /\d+/.test(l) &&
              (n.replace(/\d+|\./g, "") || e.sizeUnit) ===
                (l.replace(/\d+|\./g, "") || e.sizeUnit)
                ? e._ratio ||
                  ((t = this.util.getNumber(n, 0)),
                  (i = this.util.getNumber(l, 0)),
                  (e._ratio = !0),
                  (e._ratioX = t / i),
                  (e._ratioY = i / t))
                : (e._ratio = !1);
            },
            _module_sizeRevert: function (e) {
              e._onlyPercentage
                ? (e.inputX.value = 100 < e._origin_w ? 100 : e._origin_w)
                : ((e.inputX.value = e._origin_w),
                  (e.inputY.value = e._origin_h));
            },
            _module_saveCurrentSize: function (e) {
              var t = this.plugins.resizing._module_getSizeX.call(this, e),
                i = this.plugins.resizing._module_getSizeY.call(this, e);
              e._element.setAttribute("data-size", t + "," + i),
                e._videoRatio && (e._videoRatio = i);
            },
            call_controller_resize: function (e, t) {
              var i = this.context.resizing,
                n = this.context[t];
              i._resize_plugin = t;
              var l = i.resizeContainer,
                o = i.resizeDiv,
                s = this.util.getOffset(e, this.context.element.wysiwygFrame),
                a = (i._rotateVertical = /^(90|270)$/.test(
                  Math.abs(e.getAttribute("data-rotate")).toString()
                )),
                r = a ? e.offsetHeight : e.offsetWidth,
                c = a ? e.offsetWidth : e.offsetHeight,
                d = s.top,
                u = s.left - this.context.element.wysiwygFrame.scrollLeft;
              (l.style.top = d + "px"),
                (l.style.left = u + "px"),
                (l.style.width = r + "px"),
                (l.style.height = c + "px"),
                (o.style.top = "0px"),
                (o.style.left = "0px"),
                (o.style.width = r + "px"),
                (o.style.height = c + "px");
              var h =
                  "none" === (h = e.getAttribute("data-align") || "basic")
                    ? "basic"
                    : h,
                g = this.util.getParentElement(e, this.util.isComponent),
                p = this.util.getParentElement(e, "FIGURE"),
                m =
                  this.plugins.resizing._module_getSizeX.call(
                    this,
                    n,
                    e,
                    p,
                    g
                  ) || "auto",
                f =
                  n._onlyPercentage && "image" === t
                    ? ""
                    : ", " +
                      (this.plugins.resizing._module_getSizeY.call(
                        this,
                        n,
                        e,
                        p,
                        g
                      ) || "auto");
              this.util.changeTxt(
                i.resizeDisplay,
                this.lang.dialogBox[h] + " (" + m + f + ")"
              ),
                (i.resizeButtonGroup.style.display = n._resizing ? "" : "none");
              for (
                var v,
                  _ =
                    !n._resizing || n._resizeDotHide || n._onlyPercentage
                      ? "none"
                      : "flex",
                  b = i.resizeHandles,
                  y = 0,
                  w = b.length;
                y < w;
                y++
              )
                b[y].style.display = _;
              n._resizing &&
                ((v =
                  i.rotationButtons)[0].style.display = v[1].style.display = n._rotation
                  ? ""
                  : "none");
              var C = i.alignMenuList;
              this.util.changeElement(
                i.alignButton.firstElementChild,
                i.alignIcons[h]
              );
              for (var k = 0, x = C.length; k < x; k++)
                C[k].getAttribute("data-value") === h
                  ? this.util.addClass(C[k], "on")
                  : this.util.removeClass(C[k], "on");
              for (
                var E = i.percentageButtons,
                  S =
                    /%$/.test(e.style.width) && /%$/.test(g.style.width)
                      ? this.util.getNumber(g.style.width, 0) / 100 + ""
                      : "",
                  N = 0,
                  T = E.length;
                N < T;
                N++
              )
                E[N].getAttribute("data-value") === S
                  ? this.util.addClass(E[N], "active")
                  : this.util.removeClass(E[N], "active");
              n._captionShow
                ? ((i.captionButton.style.display = ""),
                  this.util.getChildElement(e.parentNode, "figcaption")
                    ? (this.util.addClass(i.captionButton, "active"),
                      (n._captionChecked = !0))
                    : (this.util.removeClass(i.captionButton, "active"),
                      (n._captionChecked = !1)))
                : (i.captionButton.style.display = "none"),
                this.currentControllerName !== t &&
                  (this.util.setDisabledButtons(
                    !0,
                    this.resizingDisabledButtons
                  ),
                  this.controllersOn(
                    i.resizeContainer,
                    i.resizeButton,
                    this.util.setDisabledButtons.bind(
                      this,
                      !1,
                      this.resizingDisabledButtons
                    ),
                    e,
                    t
                  ));
              var L =
                this.context.element.wysiwygFrame.offsetWidth -
                u -
                i.resizeButton.offsetWidth;
              (i.resizeButton.style.top = c + d + 60 + "px"),
                (i.resizeButton.style.left = u + (L < 0 ? L : 0) + "px"),
                (i.resizeButton.firstElementChild.style.left =
                  L < 0 ? 20 - L + "px" : "20px"),
                (i._resize_w = r),
                (i._resize_h = c);
              var z = (e.getAttribute("origin-size") || "").split(",");
              return (
                (i._origin_w = z[0] || e.naturalWidth),
                (i._origin_h = z[1] || e.naturalHeight),
                { w: r, h: c, t: d, l: u }
              );
            },
            _closeAlignMenu: null,
            openAlignMenu: function () {
              this.util.addClass(this.context.resizing.alignButton, "on"),
                (this.context.resizing.alignMenu.style.display = "block"),
                (this.plugins.resizing._closeAlignMenu = function () {
                  this.util.removeClass(
                    this.context.resizing.alignButton,
                    "on"
                  ),
                    (this.context.resizing.alignMenu.style.display = "none"),
                    this.removeDocEvent(
                      "mousedown",
                      this.plugins.resizing._closeAlignMenu
                    ),
                    (this.plugins.resizing._closeAlignMenu = null);
                }.bind(this)),
                this.addDocEvent(
                  "mousedown",
                  this.plugins.resizing._closeAlignMenu
                );
            },
            onClick_resizeButton: function (e) {
              e.stopPropagation();
              var t = e.target,
                i =
                  t.getAttribute("data-command") ||
                  t.parentNode.getAttribute("data-command");
              if (i) {
                var n =
                    t.getAttribute("data-value") ||
                    t.parentNode.getAttribute("data-value"),
                  l = this.context.resizing._resize_plugin,
                  o = this.context[l],
                  s = o._element,
                  a = this.plugins[l];
                if (
                  (e.preventDefault(),
                  "function" != typeof this.plugins.resizing._closeAlignMenu ||
                    (this.plugins.resizing._closeAlignMenu(), "onalign" !== i))
                ) {
                  switch (i) {
                    case "auto":
                      this.plugins.resizing.resetTransform.call(this, s),
                        a.setAutoSize.call(this),
                        this.selectComponent(s, l);
                      break;
                    case "percent":
                      var r,
                        c = this.plugins.resizing._module_getSizeY.call(
                          this,
                          o
                        );
                      !this.context.resizing._rotateVertical ||
                        ((r = s.getAttribute("data-percentage")) &&
                          (c = r.split(",")[1])),
                        this.plugins.resizing.resetTransform.call(this, s),
                        a.setPercentSize.call(
                          this,
                          100 * n,
                          null !== this.util.getNumber(c, 0) && /%$/.test(c)
                            ? c
                            : ""
                        ),
                        this.selectComponent(s, l);
                      break;
                    case "mirror":
                      var d = s.getAttribute("data-rotate") || "0",
                        u = s.getAttribute("data-rotateX") || "",
                        h = s.getAttribute("data-rotateY") || "";
                      ("h" === n && !this.context.resizing._rotateVertical) ||
                      ("v" === n && this.context.resizing._rotateVertical)
                        ? (h = h ? "" : "180")
                        : (u = u ? "" : "180"),
                        s.setAttribute("data-rotateX", u),
                        s.setAttribute("data-rotateY", h),
                        this.plugins.resizing._setTransForm(s, d, u, h);
                      break;
                    case "rotate":
                      var g = this.context.resizing,
                        p = +s.getAttribute("data-rotate") + +n,
                        m = 360 <= this._w.Math.abs(p) ? 0 : p;
                      s.setAttribute("data-rotate", m),
                        (g._rotateVertical = /^(90|270)$/.test(
                          this._w.Math.abs(m).toString()
                        )),
                        this.plugins.resizing.setTransformSize.call(
                          this,
                          s,
                          null,
                          null
                        ),
                        this.selectComponent(s, l);
                      break;
                    case "onalign":
                      return void this.plugins.resizing.openAlignMenu.call(
                        this
                      );
                    case "align":
                      var f = "basic" === n ? "none" : n;
                      a.setAlign.call(this, f, null, null, null),
                        this.selectComponent(s, l);
                      break;
                    case "caption":
                      var v,
                        _ = !o._captionChecked;
                      a.openModify.call(this, !0),
                        (o._captionChecked = o.captionCheckEl.checked = _),
                        a.update_image.call(this, !1, !1, !1),
                        _
                          ? ((v = this.util.getChildElement(
                              o._caption,
                              function (e) {
                                return 3 === e.nodeType;
                              }
                            ))
                              ? this.setRange(v, 0, v, v.textContent.length)
                              : o._caption.focus(),
                            this.controllersOff())
                          : (this.selectComponent(s, l),
                            a.openModify.call(this, !0));
                      break;
                    case "revert":
                      a.setOriginSize.call(this), this.selectComponent(s, l);
                      break;
                    case "update":
                      a.openModify.call(this), this.controllersOff();
                      break;
                    case "delete":
                      a.destroy.call(this);
                  }
                  this.history.push(!1);
                }
              }
            },
            resetTransform: function (e) {
              var t = (
                e.getAttribute("data-size") ||
                e.getAttribute("data-origin") ||
                ""
              ).split(",");
              (this.context.resizing._rotateVertical = !1),
                (e.style.maxWidth = ""),
                (e.style.transform = ""),
                (e.style.transformOrigin = ""),
                e.setAttribute("data-rotate", ""),
                e.setAttribute("data-rotateX", ""),
                e.setAttribute("data-rotateY", ""),
                this.plugins[this.context.resizing._resize_plugin].setSize.call(
                  this,
                  t[0] ? t[0] : "auto",
                  t[1] ? t[1] : "",
                  !0
                );
            },
            setTransformSize: function (e, t, i) {
              var n,
                l,
                o,
                s,
                a,
                r = e.getAttribute("data-percentage"),
                c = this.context.resizing._rotateVertical,
                d = +e.getAttribute("data-rotate"),
                u = "";
              r && !c
                ? "auto" === (r = r.split(","))[0] && "auto" === r[1]
                  ? this.plugins[
                      this.context.resizing._resize_plugin
                    ].setAutoSize.call(this)
                  : this.plugins[
                      this.context.resizing._resize_plugin
                    ].setPercentSize.call(this, r[0], r[1])
                : ((n = this.util.getParentElement(e, "FIGURE")),
                  (l = t || e.offsetWidth),
                  (o = i || e.offsetHeight),
                  (s = (c ? o : l) + "px"),
                  (a = (c ? l : o) + "px"),
                  this.plugins[
                    this.context.resizing._resize_plugin
                  ].cancelPercentAttr.call(this),
                  this.plugins[
                    this.context.resizing._resize_plugin
                  ].setSize.call(this, l + "px", o + "px", !0),
                  (n.style.width = s),
                  (n.style.height = this.context[
                    this.context.resizing._resize_plugin
                  ]._caption
                    ? ""
                    : a),
                  c &&
                    (u =
                      90 === d || -270 === d
                        ? o / 2 + "px " + o / 2 + "px 0"
                        : l / 2 + "px " + l / 2 + "px 0")),
                (e.style.transformOrigin = u),
                this.plugins.resizing._setTransForm(
                  e,
                  d.toString(),
                  e.getAttribute("data-rotateX") || "",
                  e.getAttribute("data-rotateY") || ""
                ),
                (e.style.maxWidth = c ? "none" : ""),
                this.plugins.resizing.setCaptionPosition.call(this, e);
            },
            _setTransForm: function (e, t, i, n) {
              var l = (e.offsetWidth - e.offsetHeight) * (/-/.test(t) ? 1 : -1),
                o = "";
              if (/[1-9]/.test(t) && (i || n))
                switch (((o = i ? "Y" : "X"), t)) {
                  case "90":
                    o = i && n ? "X" : n ? o : "";
                    break;
                  case "270":
                    (l *= -1), (o = i && n ? "Y" : i ? o : "");
                    break;
                  case "-90":
                    o = i && n ? "Y" : i ? o : "";
                    break;
                  case "-270":
                    (l *= -1), (o = i && n ? "X" : n ? o : "");
                    break;
                  default:
                    o = "";
                }
              t % 180 == 0 && (e.style.maxWidth = ""),
                (e.style.transform =
                  "rotate(" +
                  t +
                  "deg)" +
                  (i ? " rotateX(" + i + "deg)" : "") +
                  (n ? " rotateY(" + n + "deg)" : "") +
                  (o ? " translate" + o + "(" + l + "px)" : ""));
            },
            setCaptionPosition: function (e) {
              var t = this.util.getChildElement(
                this.util.getParentElement(e, "FIGURE"),
                "FIGCAPTION"
              );
              t &&
                (t.style.marginTop =
                  (this.context.resizing._rotateVertical
                    ? e.offsetWidth - e.offsetHeight
                    : 0) + "px");
            },
            onMouseDown_resize_handle: function (e) {
              e.stopPropagation(), e.preventDefault();
              var t = this.context.resizing,
                i = (t._resize_direction = e.target.classList[0]);
              (t._resizeClientX = e.clientX),
                (t._resizeClientY = e.clientY),
                (this.context.element.resizeBackground.style.display = "block"),
                (t.resizeButton.style.display = "none"),
                (t.resizeDiv.style.float = /l/.test(i)
                  ? "right"
                  : /r/.test(i)
                  ? "left"
                  : "none");
              var n = this.plugins.resizing.resizing_element.bind(
                  this,
                  t,
                  i,
                  this.context[t._resize_plugin]
                ),
                l = function (e) {
                  var o;
                  ("keydown" === e.type && 27 !== e.keyCode) ||
                    ((o = t._isChange),
                    (t._isChange = !1),
                    this.removeDocEvent("mousemove", n),
                    this.removeDocEvent("mouseup", l),
                    this.removeDocEvent("keydown", l),
                    "keydown" === e.type
                      ? (this.controllersOff(),
                        (this.context.element.resizeBackground.style.display =
                          "none"),
                        this.plugins[
                          this.context.resizing._resize_plugin
                        ].init.call(this))
                      : (this.plugins.resizing.cancel_controller_resize.call(
                          this,
                          i
                        ),
                        o && this.history.push(!1)));
                }.bind(this);
              this.addDocEvent("mousemove", n),
                this.addDocEvent("mouseup", l),
                this.addDocEvent("keydown", l);
            },
            resizing_element: function (e, t, i, n) {
              var l = n.clientX,
                o = n.clientY,
                s = i._element_w,
                a = i._element_h,
                r =
                  i._element_w +
                  (/r/.test(t) ? l - e._resizeClientX : e._resizeClientX - l),
                c =
                  i._element_h +
                  (/b/.test(t) ? o - e._resizeClientY : e._resizeClientY - o),
                d = (i._element_h / i._element_w) * r;
              /t/.test(t) &&
                (e.resizeDiv.style.top =
                  i._element_h - (/h/.test(t) ? c : d) + "px"),
                /l/.test(t) &&
                  (e.resizeDiv.style.left = i._element_w - r + "px"),
                /r|l/.test(t) &&
                  ((e.resizeDiv.style.width = r + "px"), (s = r)),
                /^(t|b)[^h]$/.test(t)
                  ? ((e.resizeDiv.style.height = d + "px"), (a = d))
                  : /^(t|b)h$/.test(t) &&
                    ((e.resizeDiv.style.height = c + "px"), (a = c)),
                (e._resize_w = s),
                (e._resize_h = a),
                this.util.changeTxt(
                  e.resizeDisplay,
                  this._w.Math.round(s) + " x " + this._w.Math.round(a)
                ),
                (e._isChange = !0);
            },
            cancel_controller_resize: function (e) {
              var t = this.context.resizing._rotateVertical;
              this.controllersOff(),
                (this.context.element.resizeBackground.style.display = "none");
              var i,
                n = this._w.Math.round(
                  t
                    ? this.context.resizing._resize_h
                    : this.context.resizing._resize_w
                ),
                l = this._w.Math.round(
                  t
                    ? this.context.resizing._resize_w
                    : this.context.resizing._resize_h
                );
              t ||
                /%$/.test(n) ||
                ((i = this.context.element.wysiwygFrame.clientWidth - 32 - 2),
                this.util.getNumber(n, 0) > i &&
                  ((l = this._w.Math.round((l / n) * i)), (n = i)));
              var o = this.context.resizing._resize_plugin;
              this.plugins[o].setSize.call(this, n, l, !1, e),
                this.selectComponent(this.context[o]._element, o);
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Modules ||
                Object.defineProperty(e, "KothingEditor_Modules", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Modules, "resizing", {
                enumerable: !0,
                writable: !1,
                configurable: !1,
                value: n,
              })),
            n
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Modules a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  "gjS+": function (e, t, i) {
    (function (e) {
      function t(e) {
        return (t =
          "function" == typeof Symbol && "symbol" == typeof Symbol.iterator
            ? function (e) {
                return typeof e;
              }
            : function (e) {
                return e &&
                  "function" == typeof Symbol &&
                  e.constructor === Symbol &&
                  e !== Symbol.prototype
                  ? "symbol"
                  : typeof e;
              })(e);
      }
      var i, n;
      (i = "undefined" != typeof window ? window : this),
        (n = function (e, i) {
          var n = {
            name: "fileManager",
            _xmlHttp: null,
            upload: function (e, i, n, l, o) {
              this.showLoading();
              var s = this.plugins.fileManager,
                a = (s._xmlHttp = this.util.getXMLHttpRequest());
              if (
                ((a.onreadystatechange = s._callBackUpload.bind(this, a, l, o)),
                a.open("post", e, !0),
                null !== i &&
                  "object" === t(i) &&
                  0 < this._w.Object.keys(i).length)
              )
                for (var r in i) a.setRequestHeader(r, i[r]);
              a.send(n);
            },
            _callBackUpload: function (e, t, i) {
              if (4 === e.readyState)
                if (200 === e.status)
                  try {
                    t(e);
                  } catch (e) {
                    throw Error(
                      '[KothingEditor.fileManager.upload.callBack.fail] cause : "' +
                        e.message +
                        '"'
                    );
                  } finally {
                    this.closeLoading();
                  }
                else {
                  this.closeLoading();
                  var n = e.responseText ? JSON.parse(e.responseText) : e;
                  if ("function" != typeof i || i("", n, this)) {
                    var l =
                      "[KothingEditor.fileManager.upload.serverException] status: " +
                      e.status +
                      ", response: " +
                      (n.errorMessage || e.responseText);
                    throw (this.functions.noticeOpen(l), Error(l));
                  }
                }
            },
            checkInfo: function (e, t, i, n, l) {
              for (var o = [], s = 0, a = t.length; s < a; s++)
                o = o.concat(
                  [].slice.call(
                    this.context.element.wysiwyg.getElementsByTagName(t[s])
                  )
                );
              var r = this.context[e],
                c = r._infoList,
                d = this.plugins.fileManager.setInfo.bind(this);
              if (o.length === c.length) {
                if (this._componentsInfoReset) {
                  for (var u = 0, h = o.length; u < h; u++)
                    d(e, o[u], i, null, l);
                  return;
                }
                for (
                  var g, p = !1, m = 0, f = c.length;
                  m < f &&
                  "break" !==
                    (function (e, t) {
                      if (
                        ((e = c[t]),
                        0 ===
                          o.filter(function (t) {
                            return (
                              (g = e).src === t.src &&
                              e.index.toString() ===
                                t.getAttribute("data-index")
                            );
                          }).length)
                      )
                        return (p = !0), (g = e), "break";
                      g = e;
                    })(g, m);
                  m++
                );
                if (!p) return;
              }
              var v = l ? this.context.resizing._resize_plugin : "";
              l && (this.context.resizing._resize_plugin = e);
              for (var _ = [], b = [], y = 0, w = c.length; y < w; y++)
                b[y] = c[y].index;
              for (var C, k = 0, x = o.length; k < x; k++)
                (C = o[k]),
                  this.util.getParentElement(C, this.util.isMediaComponent) &&
                  /FIGURE/i.test(C.parentElement.nodeName)
                    ? !C.getAttribute("data-index") ||
                      b.indexOf(+C.getAttribute("data-index")) < 0
                      ? (_.push(r._infoIndex),
                        C.removeAttribute("data-index"),
                        d(e, C, i, null, l))
                      : _.push(+C.getAttribute("data-index"))
                    : (_.push(r._infoIndex), n(C));
              for (var E, S = 0; S < c.length; S++)
                (E = c[S].index),
                  -1 < _.indexOf(E) ||
                    (c.splice(S, 1),
                    "function" == typeof i &&
                      i(null, E, "delete", null, 0, this),
                    S--);
              l && (this.context.resizing._resize_plugin = v);
            },
            setInfo: function (e, t, i, n, l) {
              var o = l ? this.context.resizing._resize_plugin : "";
              l && (this.context.resizing._resize_plugin = e);
              var s,
                a,
                r,
                c,
                d,
                u = this.plugins[e],
                h = this.context[e],
                g = h._infoList,
                p = t.getAttribute("data-index"),
                m = null,
                f = "";
              if (
                ((n = n || {
                  name:
                    t.getAttribute("data-file-name") ||
                    ("string" == typeof t.src ? t.src.split("/").pop() : ""),
                  size: t.getAttribute("data-file-size") || 0,
                }),
                !p || this._componentsInfoInit)
              )
                (f = "create"),
                  (p = h._infoIndex++),
                  t.setAttribute("data-index", p),
                  t.setAttribute("data-file-name", n.name),
                  t.setAttribute("data-file-size", n.size),
                  (m = { src: t.src, index: +p, name: n.name, size: n.size }),
                  g.push(m);
              else {
                (f = "update"), (p *= 1);
                for (var v = 0, _ = g.length; v < _; v++)
                  if (p === g[v].index) {
                    m = g[v];
                    break;
                  }
                m || ((m = { index: (p = h._infoIndex++) }), g.push(m)),
                  (m.src = t.src),
                  (m.name = t.getAttribute("data-file-name")),
                  (m.size = +t.getAttribute("data-file-size"));
              }
              (m.element = t),
                (m.delete = u.destroy.bind(this, t)),
                (m.select = function (e) {
                  e.scrollIntoView(!0),
                    this._w.setTimeout(u.select.bind(this, e));
                }.bind(this, t)),
                l &&
                  (!t.getAttribute("origin-size") &&
                    t.naturalWidth &&
                    t.setAttribute(
                      "origin-size",
                      t.naturalWidth + "," + t.naturalHeight
                    ),
                  t.getAttribute("data-origin") ||
                    ((s = this.util.getParentElement(
                      t,
                      this.util.isMediaComponent
                    )),
                    (a = this.util.getParentElement(t, "FIGURE")),
                    (r = this.plugins.resizing._module_getSizeX.call(
                      this,
                      h,
                      t,
                      a,
                      s
                    )),
                    (c = this.plugins.resizing._module_getSizeY.call(
                      this,
                      h,
                      t,
                      a,
                      s
                    )),
                    t.setAttribute("data-origin", r + "," + c),
                    t.setAttribute("data-size", r + "," + c)),
                  t.style.width ||
                    ((d = (
                      t.getAttribute("data-size") ||
                      t.getAttribute("data-origin") ||
                      ""
                    ).split(",")),
                    u.onModifyMode.call(this, t, null),
                    u.applySize.call(this, d[0], d[1])),
                  (this.context.resizing._resize_plugin = o)),
                "function" == typeof i &&
                  i(
                    t,
                    p,
                    f,
                    m,
                    --h._uploadFileLength < 0 ? 0 : h._uploadFileLength,
                    this
                  );
            },
            deleteInfo: function (e, t, i) {
              if (0 <= t)
                for (
                  var n = this.context[e]._infoList, l = 0, o = n.length;
                  l < o;
                  l++
                )
                  if (t === n[l].index)
                    return (
                      n.splice(l, 1),
                      void (
                        "function" == typeof i &&
                        i(null, t, "delete", null, 0, this)
                      )
                    );
            },
            resetInfo: function (e, t) {
              var i = this.context[e];
              if ("function" == typeof t)
                for (var n = i._infoList, l = 0, o = n.length; l < o; l++)
                  t(null, n[l].index, "delete", null, 0, this);
              (i._infoList = []), (i._infoIndex = 0);
            },
          };
          return (
            "undefined" === t(i) &&
              (e.KothingEditor_Modules ||
                Object.defineProperty(e, "KothingEditor_Modules", {
                  enumerable: !0,
                  writable: !1,
                  configurable: !1,
                  value: {},
                }),
              Object.defineProperty(e.KothingEditor_Modules, "fileManager", {
                enumerable: !0,
                writable: !1,
                configurable: !1,
                value: n,
              })),
            n
          );
        }),
        "object" === t(e) && "object" === t(e.exports)
          ? (e.exports = i.document
              ? n(i, !0)
              : function (e) {
                  if (!e.document)
                    throw new Error(
                      "KothingEditor_Modules a window with a document"
                    );
                  return n(e);
                })
          : n(i);
    }.call(this, i("YuTi")(e)));
  },
  h474: function (e, t, i) {},
  tIrU: function (e, t, i) {},
});
